[{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7934","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7934/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7934/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7934/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7934","id":528896714,"node_id":"MDU6SXNzdWU1Mjg4OTY3MTQ=","number":7934,"title":"startsWith() with multiple values, or can substring be made to use the PK index?","user":{"login":"yamrzou","id":40591511,"node_id":"MDQ6VXNlcjQwNTkxNTEx","avatar_url":"https://avatars.githubusercontent.com/u/40591511?v=4","gravatar_id":"","url":"https://api.github.com/users/yamrzou","html_url":"https://github.com/yamrzou","followers_url":"https://api.github.com/users/yamrzou/followers","following_url":"https://api.github.com/users/yamrzou/following{/other_user}","gists_url":"https://api.github.com/users/yamrzou/gists{/gist_id}","starred_url":"https://api.github.com/users/yamrzou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yamrzou/subscriptions","organizations_url":"https://api.github.com/users/yamrzou/orgs","repos_url":"https://api.github.com/users/yamrzou/repos","events_url":"https://api.github.com/users/yamrzou/events{/privacy}","received_events_url":"https://api.github.com/users/yamrzou/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""},{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-11-26T18:21:35Z","updated_at":"2020-08-04T20:35:12Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I have a column `geohash` of length **12** used as a primary key index. I want to find all rows whose geohash is part of a small set of geohashes of length **7**.\r\n\r\n`startsWith()` uses the PK index but doesn't work for multiple values.\r\n\r\nAlternatively, I can do:\r\n```\r\nSELECT * FROM table WHERE substring(geohash, 1, 7) IN (...)\r\n```\r\nbut it doesn't use the PK index.\r\n\r\nAny alternative ?","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7934/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7906","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7906/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7906/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7906/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7906","id":528056389,"node_id":"MDU6SXNzdWU1MjgwNTYzODk=","number":7906,"title":"(RFC) Engine = DistributedSet / DistributedJoin.","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1507886722,"node_id":"MDU6TGFiZWwxNTA3ODg2NzIy","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-discussion","name":"st-discussion","color":"e5b890","default":false,"description":"The story requires discussion /research / expert help / design & decomposition before will be taken"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-11-25T12:31:43Z","updated_at":"2019-12-03T16:27:17Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"Ability to access sharded Engine=Set / Engine=Join.\r\n\r\nDistributed over Set / over Join? DHT? Other ideas?","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7906/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7905","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7905/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7905/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7905/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7905","id":528054179,"node_id":"MDU6SXNzdWU1MjgwNTQxNzk=","number":7905,"title":"ASOF for engine=Join","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1357578153,"node_id":"MDU6TGFiZWwxMzU3NTc4MTUz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-joins","name":"comp-joins","color":"b5bcff","default":false,"description":"JOINs"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-11-25T12:27:20Z","updated_at":"2020-10-16T18:10:46Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"main use case: initialize latest known value during filling fact table. \r\n\r\nSomething like:\r\n```sql\r\ncreate table exchange_rates_history ... engine=Join(ASOF,LEFT,'currency_code');\r\n\r\ncreate table events (\r\n...\r\nexchange_rate Decimal32(4) DEFAULT joinGet(... 'exchange_rates_history' ... )\r\n...\r\n);\r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7905/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7905/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7895","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7895/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7895/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7895/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7895","id":527220284,"node_id":"MDU6SXNzdWU1MjcyMjAyODQ=","number":7895,"title":"uniqExact and countDistinct use way more memory than expected","user":{"login":"George3d6","id":23587658,"node_id":"MDQ6VXNlcjIzNTg3NjU4","avatar_url":"https://avatars.githubusercontent.com/u/23587658?v=4","gravatar_id":"","url":"https://api.github.com/users/George3d6","html_url":"https://github.com/George3d6","followers_url":"https://api.github.com/users/George3d6/followers","following_url":"https://api.github.com/users/George3d6/following{/other_user}","gists_url":"https://api.github.com/users/George3d6/gists{/gist_id}","starred_url":"https://api.github.com/users/George3d6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/George3d6/subscriptions","organizations_url":"https://api.github.com/users/George3d6/orgs","repos_url":"https://api.github.com/users/George3d6/repos","events_url":"https://api.github.com/users/George3d6/events{/privacy}","received_events_url":"https://api.github.com/users/George3d6/received_events","type":"User","site_admin":false},"labels":[{"id":1507867504,"node_id":"MDU6TGFiZWwxNTA3ODY3NTA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-hold","name":"st-hold","color":"e5b890","default":false,"description":"We've paused the work on issue for some reason"},{"id":1532016596,"node_id":"MDU6TGFiZWwxNTMyMDE2NTk2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/memory","name":"memory","color":"e99695","default":false,"description":"When memory usage is higher than expected"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-11-22T14:13:22Z","updated_at":"2020-11-04T12:56:02Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I have a table of about 300 billion rows which is ordered by a column called `account_id` (type UInt64) and partitioned by a column called `start_date` (type Date).\r\n\r\nThere are ~300 partitions and ~9.5M (+/- 0.5M) distinct values for the `account_id` column per partition (and around 15M distinct values for it across all partitions).\r\n\r\nAttempting the follow query (either with uniqExact or with countDistinct) results in an OOM error when clickhouse tries to allocate over 350GiB (currently the memory limit):\r\n\r\n```\r\nSELECT start_date, uniqExact(account_id) FROM table GROUP BY start_date\r\n```\r\nI know `uniqExact` isn't as memory efficient as `uniq` and other approximation using derivatives, however, it seems very unintuitive that it should fail in this specific case.\r\n\r\nConsidering that clickhouse keeps 1 in memory table per partition as it executes this query that should be:\r\n\r\n8 bytes (UInt64) * 10M distinct values per parition => 80MiB per parition\r\nMultiply that by 300 paritions and I can see memory usage going up to 24GiB.\r\n\r\nGranted, I understand that this \"idealized\" version doesn't taking into account the overhead needed to unpack the data, the overhead needed for the hash map and whatever other sacrifices are made in order to make the code for the hash table more generic. But still, I wouldn't expect the amount of necessary memory to be +15x times as large compared to that number.\r\n\r\nTo back up this intuition I tried to execute the query using group-bys instead of uniq:\r\n\r\n```\r\nSELECT count(*), start_date FROM (SELECT account_id, start_date FROM table GROUP BY start_date, account_id) GROUP BY start_date\r\n```\r\n\r\nAnd while it does take a while to execute, it managed to stay under 50GiB of memory (not sure about exact usage, I set the limit to 50GiB for the purpose of testing this)\r\n\r\nMight there be something wrong with the implementation of uniqExact in this specific situation or in general ? Or do I just have a completely wrong understanding for how uniqExact works ? Is there another function I could be using here to get an exact result ?","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7895/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7882","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7882/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7882/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7882/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7882","id":526792020,"node_id":"MDU6SXNzdWU1MjY3OTIwMjA=","number":7882,"title":"INSERT INTO table with default value results in hard-to-understand error message","user":{"login":"Dlougach","id":2272137,"node_id":"MDQ6VXNlcjIyNzIxMzc=","avatar_url":"https://avatars.githubusercontent.com/u/2272137?v=4","gravatar_id":"","url":"https://api.github.com/users/Dlougach","html_url":"https://github.com/Dlougach","followers_url":"https://api.github.com/users/Dlougach/followers","following_url":"https://api.github.com/users/Dlougach/following{/other_user}","gists_url":"https://api.github.com/users/Dlougach/gists{/gist_id}","starred_url":"https://api.github.com/users/Dlougach/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dlougach/subscriptions","organizations_url":"https://api.github.com/users/Dlougach/orgs","repos_url":"https://api.github.com/users/Dlougach/repos","events_url":"https://api.github.com/users/Dlougach/events{/privacy}","received_events_url":"https://api.github.com/users/Dlougach/received_events","type":"User","site_admin":false},"labels":[{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-11-21T19:20:10Z","updated_at":"2022-01-16T03:49:31Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Using current clickhouse-server docker image (ClickHouse server version 19.17.2 revision 54428) and clickhouse-client docker image:\r\n\r\n```sql\r\nCREATE TABLE T (\r\n  k String, v Float32, d UInt64 DEFAULT 0\r\n) ENGINE = MergeTree()\r\nORDER BY k;\r\n\r\nINSERT INTO T VALUES ('A', 1.0), ('B', 2.0);\r\n```\r\n\r\nThis results in the following error message:\r\n```\r\nException on client:\r\nCode: 62. DB::Exception: Cannot parse expression of type Float32 here: 1.0), ('B', 2.0);\r\n```\r\n\r\nThe version with `INSERT INTO T(k, v) ...` still works, so this bug is about the diagnostics only.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7882/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7881","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7881/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7881/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7881/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7881","id":526788819,"node_id":"MDU6SXNzdWU1MjY3ODg4MTk=","number":7881,"title":"Live View to include operation(INSERT, UPDATE, DELETE)","user":{"login":"ramazanpolat","id":3527695,"node_id":"MDQ6VXNlcjM1Mjc2OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3527695?v=4","gravatar_id":"","url":"https://api.github.com/users/ramazanpolat","html_url":"https://github.com/ramazanpolat","followers_url":"https://api.github.com/users/ramazanpolat/followers","following_url":"https://api.github.com/users/ramazanpolat/following{/other_user}","gists_url":"https://api.github.com/users/ramazanpolat/gists{/gist_id}","starred_url":"https://api.github.com/users/ramazanpolat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramazanpolat/subscriptions","organizations_url":"https://api.github.com/users/ramazanpolat/orgs","repos_url":"https://api.github.com/users/ramazanpolat/repos","events_url":"https://api.github.com/users/ramazanpolat/events{/privacy}","received_events_url":"https://api.github.com/users/ramazanpolat/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-11-21T19:13:38Z","updated_at":"2019-11-21T19:13:38Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Just tried **Live Views** and it is great but it only works for INSERT although we can UPDATE and DELETE with table mutations. \r\n\r\n**Use case**\r\nSometimes, users may need to watch UPDATED or DELETED rows, not just INSERTED ones.\r\n\r\n**My suggestion**\r\nRight now, live view watch includes a new column named `_version` but we should also have another column named `_operation` which should include a number:\r\n-1 : deleted\r\n0: updated\r\n+1: inserted\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7881/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7826","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7826/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7826/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7826/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7826","id":524598750,"node_id":"MDU6SXNzdWU1MjQ1OTg3NTA=","number":7826,"title":"Support Array(LowCardinality(String)) for Bloom Filter","user":{"login":"volfco","id":433045,"node_id":"MDQ6VXNlcjQzMzA0NQ==","avatar_url":"https://avatars.githubusercontent.com/u/433045?v=4","gravatar_id":"","url":"https://api.github.com/users/volfco","html_url":"https://github.com/volfco","followers_url":"https://api.github.com/users/volfco/followers","following_url":"https://api.github.com/users/volfco/following{/other_user}","gists_url":"https://api.github.com/users/volfco/gists{/gist_id}","starred_url":"https://api.github.com/users/volfco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/volfco/subscriptions","organizations_url":"https://api.github.com/users/volfco/orgs","repos_url":"https://api.github.com/users/volfco/repos","events_url":"https://api.github.com/users/volfco/events{/privacy}","received_events_url":"https://api.github.com/users/volfco/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1357507723,"node_id":"MDU6TGFiZWwxMzU3NTA3NzIz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-skipidx","name":"comp-skipidx","color":"b5bcff","default":false,"description":"Data skipping indices"},{"id":1401233890,"node_id":"MDU6TGFiZWwxNDAxMjMzODkw","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-arrays","name":"comp-arrays","color":"b5bcff","default":false,"description":"Arrays / array joins / higher order"},{"id":1446368065,"node_id":"MDU6TGFiZWwxNDQ2MzY4MDY1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-lowcardinality","name":"comp-lowcardinality","color":"b5bcff","default":false,"description":"LowCardinality data type"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-11-18T20:22:11Z","updated_at":"2021-08-04T10:56:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Use case**\r\nTo save space I have a table with a large Array column (because I can't dynamically create columns when using the Kafka table engine) with a type of LowCardinality(String).\r\n\r\nAltering this table to use a bloom filter index results in the following error:\r\n`Unexpected type Array(LowCardinality(String)) of bloom filter index..`\r\n\r\n**Describe the solution you'd like**\r\nSupport for bloom filter indexes on columns with the Array(LowCardinality(String)) type","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7826/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7752","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7752/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7752/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7752/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7752","id":522133288,"node_id":"MDU6SXNzdWU1MjIxMzMyODg=","number":7752,"title":"About with expression and with fill expression","user":{"login":"zhang2014","id":8087042,"node_id":"MDQ6VXNlcjgwODcwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8087042?v=4","gravatar_id":"","url":"https://api.github.com/users/zhang2014","html_url":"https://github.com/zhang2014","followers_url":"https://api.github.com/users/zhang2014/followers","following_url":"https://api.github.com/users/zhang2014/following{/other_user}","gists_url":"https://api.github.com/users/zhang2014/gists{/gist_id}","starred_url":"https://api.github.com/users/zhang2014/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhang2014/subscriptions","organizations_url":"https://api.github.com/users/zhang2014/orgs","repos_url":"https://api.github.com/users/zhang2014/repos","events_url":"https://api.github.com/users/zhang2014/events{/privacy}","received_events_url":"https://api.github.com/users/zhang2014/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-11-13T11:08:26Z","updated_at":"2021-11-10T10:35:16Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"**Use case**\r\n``` sql\r\nWITH INTERVAL 1 hour AS granule, \r\ntoStartOfInterval(toDateTime('2019-01-01 00:00:00'), granule) AS begin_time, \r\ntoStartOfInterval(toDateTime('2019-07-01 00:00:00'), granule) AS end_time\r\nSELECT avg(value_int32) AS value, toStartOfInterval(action_time, granule) AS action_time\r\nFROM iot_device_data\r\nWHERE user_id = 'usr-kLVVBDqd' AND device_id = 'iotd-0572a3b9-7862-4ff4-ac82-1e388e7c25f9'\r\n  AND action_time > begin_time AND action_time < end_time\r\nGROUP BY action_time ORDER BY action_time WITH FILL FROM begin_time TO end_time STEP granule\r\n```\r\n\r\n**Additional context**\r\n- Support `DataTypeInterval` in `gaps fill step`\r\n- Support `with expression` and `gaps fill expression`\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7752/reactions","total_count":7,"+1":7,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7752/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7680","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7680/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7680/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7680/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7680","id":519632752,"node_id":"MDU6SXNzdWU1MTk2MzI3NTI=","number":7680,"title":"view-level permissions","user":{"login":"csnook","id":797360,"node_id":"MDQ6VXNlcjc5NzM2MA==","avatar_url":"https://avatars.githubusercontent.com/u/797360?v=4","gravatar_id":"","url":"https://api.github.com/users/csnook","html_url":"https://github.com/csnook","followers_url":"https://api.github.com/users/csnook/followers","following_url":"https://api.github.com/users/csnook/following{/other_user}","gists_url":"https://api.github.com/users/csnook/gists{/gist_id}","starred_url":"https://api.github.com/users/csnook/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csnook/subscriptions","organizations_url":"https://api.github.com/users/csnook/orgs","repos_url":"https://api.github.com/users/csnook/repos","events_url":"https://api.github.com/users/csnook/events{/privacy}","received_events_url":"https://api.github.com/users/csnook/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":{"login":"vitlibar","id":45142681,"node_id":"MDQ6VXNlcjQ1MTQyNjgx","avatar_url":"https://avatars.githubusercontent.com/u/45142681?v=4","gravatar_id":"","url":"https://api.github.com/users/vitlibar","html_url":"https://github.com/vitlibar","followers_url":"https://api.github.com/users/vitlibar/followers","following_url":"https://api.github.com/users/vitlibar/following{/other_user}","gists_url":"https://api.github.com/users/vitlibar/gists{/gist_id}","starred_url":"https://api.github.com/users/vitlibar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vitlibar/subscriptions","organizations_url":"https://api.github.com/users/vitlibar/orgs","repos_url":"https://api.github.com/users/vitlibar/repos","events_url":"https://api.github.com/users/vitlibar/events{/privacy}","received_events_url":"https://api.github.com/users/vitlibar/received_events","type":"User","site_admin":false},"assignees":[{"login":"vitlibar","id":45142681,"node_id":"MDQ6VXNlcjQ1MTQyNjgx","avatar_url":"https://avatars.githubusercontent.com/u/45142681?v=4","gravatar_id":"","url":"https://api.github.com/users/vitlibar","html_url":"https://github.com/vitlibar","followers_url":"https://api.github.com/users/vitlibar/followers","following_url":"https://api.github.com/users/vitlibar/following{/other_user}","gists_url":"https://api.github.com/users/vitlibar/gists{/gist_id}","starred_url":"https://api.github.com/users/vitlibar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vitlibar/subscriptions","organizations_url":"https://api.github.com/users/vitlibar/orgs","repos_url":"https://api.github.com/users/vitlibar/repos","events_url":"https://api.github.com/users/vitlibar/events{/privacy}","received_events_url":"https://api.github.com/users/vitlibar/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-11-08T03:09:41Z","updated_at":"2020-07-15T02:00:20Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Use case**\r\nWe'd like to expose different subsets of data to different audiences without having to create separate databases for each combination of permissions, and without having to bulk copy historical data when granting or changing that access. This is similar to https://github.com/ClickHouse/ClickHouse/issues/523, but we don't need it that fine grained. The filters we have in mind can be expressed as views, so permissions on views would be adequate.\r\n\r\n**Describe the solution you'd like**\r\nStandard SQL grants would be ideal, but a configuration file would be fine.\r\n\r\n**Describe alternatives you've considered**\r\nWe already have API services that populate pre-defined queries with user-supplied parameters after authorization checks, but it would be a lot less work if we could just express those as views and selectively grant access to those views, and would give us defense in depth for things that are sensitive enough to justify both.\r\n\r\n**Additional context**\r\nGrafana has a Clickhouse plugin, but access to datasources is all-or-nothing in Grafana, even with the Grafana Enterprise Datasource Permissions feature, so unprivileged users can issue arbitrary queries with the credentials configured in Grafana even if those queries aren't configured on any dashboard and they don't have Editor or Admin privileges. This makes it very dangerous to configure a Clickhouse datasource that contains any sensitive information.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7680/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7677","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7677/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7677/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7677/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7677","id":519391236,"node_id":"MDU6SXNzdWU1MTkzOTEyMzY=","number":7677,"title":"Can't create a materialized column on a nested column using syntax sugar","user":{"login":"MrBuddyCasino","id":3044875,"node_id":"MDQ6VXNlcjMwNDQ4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3044875?v=4","gravatar_id":"","url":"https://api.github.com/users/MrBuddyCasino","html_url":"https://github.com/MrBuddyCasino","followers_url":"https://api.github.com/users/MrBuddyCasino/followers","following_url":"https://api.github.com/users/MrBuddyCasino/following{/other_user}","gists_url":"https://api.github.com/users/MrBuddyCasino/gists{/gist_id}","starred_url":"https://api.github.com/users/MrBuddyCasino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrBuddyCasino/subscriptions","organizations_url":"https://api.github.com/users/MrBuddyCasino/orgs","repos_url":"https://api.github.com/users/MrBuddyCasino/repos","events_url":"https://api.github.com/users/MrBuddyCasino/events{/privacy}","received_events_url":"https://api.github.com/users/MrBuddyCasino/received_events","type":"User","site_admin":false},"labels":[{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-11-07T16:56:12Z","updated_at":"2019-11-08T10:52:23Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug or unexpected behaviour**\r\n\r\nCreating a materialized column on a nested column does not work with the `nested` syntatic sugar.\r\n\r\n**How to reproduce**\r\n\r\n```\r\nCREATE TABLE IF NOT EXISTS example (\r\n  date Date,\r\n  meta_tags Nested(key LowCardinality(String), value LowCardinality(String))\r\n) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/example', '{replica}')\r\n PARTITION BY toRelativeDayNum(date) ORDER BY (date) SETTINGS index_granularity=8192;\r\n\r\n// FAILS\r\nALTER TABLE example ADD COLUMN meta_tags_regular Nested(key String, value String) MATERIALIZED meta_tags;\r\n\r\n// WORKS\r\nALTER TABLE example ADD COLUMN meta_tags_regular.key String MATERIALIZED meta_tags.key;\r\nALTER TABLE example ADD COLUMN meta_tags_regular.value String MATERIALIZED meta_tags.value;\r\n```\r\n\r\n\r\n**Expected behavior**\r\nThe nested syntax `ALTER TABLE example ADD COLUMN meta_tags_regular Nested(key String, value String) MATERIALIZED meta_tags;` should work.\r\n\r\n**Error message and/or stacktrace**\r\n```\r\nReceived exception from server (version 19.9.4):\r\nCode: 47. DB::Exception: Received from localhost:9000, 127.0.0.1. DB::Exception: Missing columns: 'meta_tags' while processing query: 'CAST(meta_tags AS meta_tags_regular_tmp, 'Array(Tuple(key String, value String))') AS meta_tags_regular, meta_tags_regular_tmp', required columns: 'meta_tags', source columns: 'meta_tags_regular' 'meta_tags.value' 'date' 'meta_tags.key'.\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7677/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7644","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7644/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7644/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7644/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7644","id":518207921,"node_id":"MDU6SXNzdWU1MTgyMDc5MjE=","number":7644,"title":"Document system.asynchronous_metrics","user":{"login":"ofek","id":9677399,"node_id":"MDQ6VXNlcjk2NzczOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9677399?v=4","gravatar_id":"","url":"https://api.github.com/users/ofek","html_url":"https://github.com/ofek","followers_url":"https://api.github.com/users/ofek/followers","following_url":"https://api.github.com/users/ofek/following{/other_user}","gists_url":"https://api.github.com/users/ofek/gists{/gist_id}","starred_url":"https://api.github.com/users/ofek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofek/subscriptions","organizations_url":"https://api.github.com/users/ofek/orgs","repos_url":"https://api.github.com/users/ofek/repos","events_url":"https://api.github.com/users/ofek/events{/privacy}","received_events_url":"https://api.github.com/users/ofek/received_events","type":"User","site_admin":false},"labels":[{"id":785082162,"node_id":"MDU6TGFiZWw3ODUwODIxNjI=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-documentation","name":"comp-documentation","color":"b5bcff","default":false,"description":"Used to run automatic builds of the documentation"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-11-06T03:09:23Z","updated_at":"2021-05-25T18:15:47Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Defined in https://github.com/ClickHouse/ClickHouse/blob/master/dbms/src/Interpreters/AsynchronousMetrics.cpp\r\n\r\ncc @alexey-milovidov ðŸ˜„ ","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7644/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7554","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7554/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7554/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7554/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7554","id":515246639,"node_id":"MDU6SXNzdWU1MTUyNDY2Mzk=","number":7554,"title":"Supporting Apache Arrow Flight","user":{"login":"hamroune","id":795761,"node_id":"MDQ6VXNlcjc5NTc2MQ==","avatar_url":"https://avatars.githubusercontent.com/u/795761?v=4","gravatar_id":"","url":"https://api.github.com/users/hamroune","html_url":"https://github.com/hamroune","followers_url":"https://api.github.com/users/hamroune/followers","following_url":"https://api.github.com/users/hamroune/following{/other_user}","gists_url":"https://api.github.com/users/hamroune/gists{/gist_id}","starred_url":"https://api.github.com/users/hamroune/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hamroune/subscriptions","organizations_url":"https://api.github.com/users/hamroune/orgs","repos_url":"https://api.github.com/users/hamroune/repos","events_url":"https://api.github.com/users/hamroune/events{/privacy}","received_events_url":"https://api.github.com/users/hamroune/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-10-31T08:20:45Z","updated_at":"2021-04-01T05:05:28Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi everyone, is there any plan to support Apache Arrow Flight to serve data very fastly.\r\n\r\nAccording to dremio and IBM documentation they can 50x speed up over odbc, it could be really nice to see how it can outperform in clickhouse db","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7554/reactions","total_count":13,"+1":13,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7554/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7522","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7522/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7522/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7522/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7522","id":513800855,"node_id":"MDU6SXNzdWU1MTM4MDA4NTU=","number":7522,"title":"Supporting exactly once","user":{"login":"yingfeng","id":7248,"node_id":"MDQ6VXNlcjcyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7248?v=4","gravatar_id":"","url":"https://api.github.com/users/yingfeng","html_url":"https://github.com/yingfeng","followers_url":"https://api.github.com/users/yingfeng/followers","following_url":"https://api.github.com/users/yingfeng/following{/other_user}","gists_url":"https://api.github.com/users/yingfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/yingfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yingfeng/subscriptions","organizations_url":"https://api.github.com/users/yingfeng/orgs","repos_url":"https://api.github.com/users/yingfeng/repos","events_url":"https://api.github.com/users/yingfeng/events{/privacy}","received_events_url":"https://api.github.com/users/yingfeng/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-10-29T09:45:51Z","updated_at":"2019-11-22T02:52:15Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Currently, data updating is used through `ReplacingMergeTree` engine. However, the update operation happens asynchronously through background merging thread, there are many cases where business wants read after write semantic(or nearly) and it can only happen after `optimize final` is used right now, but it might causes the database to be blocked for a long time. On the other hand, when inserting data to ClickHouse, if the worker has corrupted and be restarted, duplication might happen unless `optimize final` is called.\r\n\r\nFor OLAP solution as `Apache Doris`, there's an important feature of exactly once, worked together with `Kafka`, it's the so called `Doris Stream Load`:\r\n\r\nFor each `Doris Stream Load` http request, it could be attached a Label http header, and `Apache Doris` could guarantee data under same Label to be loaded only once within 7 days(a configurable duration), and errors would be reported for duplicated insertions. As a result, if the Label for the load request for `Apache Doris` (dorisDb_dorisTable_sequence_id) could be strictly aligned with the offsets from Kafka, then duplicate insertion from Kafka could be avoided. \r\n\r\nIf this feature has also been implemented in ClickHouse,too, then the data inconsistency issue could be greatly relieved. \r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7522/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7520","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7520/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7520/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7520/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7520","id":513797943,"node_id":"MDU6SXNzdWU1MTM3OTc5NDM=","number":7520,"title":"GROUP BY using WITH columns alias don't work if we call the column using the column name on SELECT","user":{"login":"YiuRULE","id":4019437,"node_id":"MDQ6VXNlcjQwMTk0Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/4019437?v=4","gravatar_id":"","url":"https://api.github.com/users/YiuRULE","html_url":"https://github.com/YiuRULE","followers_url":"https://api.github.com/users/YiuRULE/followers","following_url":"https://api.github.com/users/YiuRULE/following{/other_user}","gists_url":"https://api.github.com/users/YiuRULE/gists{/gist_id}","starred_url":"https://api.github.com/users/YiuRULE/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YiuRULE/subscriptions","organizations_url":"https://api.github.com/users/YiuRULE/orgs","repos_url":"https://api.github.com/users/YiuRULE/repos","events_url":"https://api.github.com/users/YiuRULE/events{/privacy}","received_events_url":"https://api.github.com/users/YiuRULE/received_events","type":"User","site_admin":false},"labels":[{"id":386401505,"node_id":"MDU6TGFiZWwzODY0MDE1MDU=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/bug","name":"bug","color":"ee0701","default":true,"description":"Confirmed user-visible misbehaviour in official release"},{"id":1507867504,"node_id":"MDU6TGFiZWwxNTA3ODY3NTA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-hold","name":"st-hold","color":"e5b890","default":false,"description":"We've paused the work on issue for some reason"},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"},{"id":1842603313,"node_id":"MDU6TGFiZWwxODQyNjAzMzEz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-alias-columns","name":"comp-alias-columns","color":"b5bcff","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-29T09:40:11Z","updated_at":"2021-04-17T00:14:41Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the bug or unexpected behaviour**\r\n\r\nIf we do a `GROUP BY` using an alias column on the `WITH`, it consider the following column as not part of the `ORDER BY`\r\n\r\n**How to reproduce**\r\nClickhouse server v19.14.3\r\n```\r\nCREATE TABLE test (`a` UInt32, `b` UInt32) ENGINE = Memory;\r\n\r\nWITH\r\n    a as key\r\nSELECT\r\n    a as k1,\r\n    sum(b) as k2\r\nFROM\r\n    test\r\nGROUP BY\r\n    key\r\nORDER BY k1, k2;\r\n\r\nCode: 215. DB::Exception: Received from 127.0.0.1:10000. DB::Exception: Column a is not under aggregate function and not in GROUP BY.. \r\n```\r\n\r\n**Expected behavior**\r\nThis query should be executable as the alias `key` and the column `a` share the same expression.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7520/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7455","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7455/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7455/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7455/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7455","id":511348238,"node_id":"MDU6SXNzdWU1MTEzNDgyMzg=","number":7455,"title":"Uniform tracking for queries and background processes.","user":{"login":"akuzm","id":36882414,"node_id":"MDQ6VXNlcjM2ODgyNDE0","avatar_url":"https://avatars.githubusercontent.com/u/36882414?v=4","gravatar_id":"","url":"https://api.github.com/users/akuzm","html_url":"https://github.com/akuzm","followers_url":"https://api.github.com/users/akuzm/followers","following_url":"https://api.github.com/users/akuzm/following{/other_user}","gists_url":"https://api.github.com/users/akuzm/gists{/gist_id}","starred_url":"https://api.github.com/users/akuzm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akuzm/subscriptions","organizations_url":"https://api.github.com/users/akuzm/orgs","repos_url":"https://api.github.com/users/akuzm/repos","events_url":"https://api.github.com/users/akuzm/events{/privacy}","received_events_url":"https://api.github.com/users/akuzm/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-10-23T14:06:36Z","updated_at":"2020-05-06T10:14:37Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"(aka add merges to query_thread_log)\r\n\r\nWe want to be able to track sever metrics, such as IO or CPU utilization, in a uniform way across both queries and background processes such as merges. This may be helpful for example when debugging high IO utilization. Currently there are some rough metrics on merges in part_log, but no ProfileEvents like in query_thread_log.\r\n\r\nSolving this task would consist of:\r\n1. Logging more metrics (ProfileEvents-like) for background processes.\r\n2. Storing them in a uniform way with query thread metrics (by adding to query_thread_log or maybe some other table).","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7455/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7413","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7413/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7413/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7413/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7413","id":510286594,"node_id":"MDU6SXNzdWU1MTAyODY1OTQ=","number":7413,"title":"Memory limit exception on ORDER BY pk with LIMIT 1","user":{"login":"reflection","id":652093,"node_id":"MDQ6VXNlcjY1MjA5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/652093?v=4","gravatar_id":"","url":"https://api.github.com/users/reflection","html_url":"https://github.com/reflection","followers_url":"https://api.github.com/users/reflection/followers","following_url":"https://api.github.com/users/reflection/following{/other_user}","gists_url":"https://api.github.com/users/reflection/gists{/gist_id}","starred_url":"https://api.github.com/users/reflection/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reflection/subscriptions","organizations_url":"https://api.github.com/users/reflection/orgs","repos_url":"https://api.github.com/users/reflection/repos","events_url":"https://api.github.com/users/reflection/events{/privacy}","received_events_url":"https://api.github.com/users/reflection/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":{"login":"CurtizJ","id":20361854,"node_id":"MDQ6VXNlcjIwMzYxODU0","avatar_url":"https://avatars.githubusercontent.com/u/20361854?v=4","gravatar_id":"","url":"https://api.github.com/users/CurtizJ","html_url":"https://github.com/CurtizJ","followers_url":"https://api.github.com/users/CurtizJ/followers","following_url":"https://api.github.com/users/CurtizJ/following{/other_user}","gists_url":"https://api.github.com/users/CurtizJ/gists{/gist_id}","starred_url":"https://api.github.com/users/CurtizJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CurtizJ/subscriptions","organizations_url":"https://api.github.com/users/CurtizJ/orgs","repos_url":"https://api.github.com/users/CurtizJ/repos","events_url":"https://api.github.com/users/CurtizJ/events{/privacy}","received_events_url":"https://api.github.com/users/CurtizJ/received_events","type":"User","site_admin":false},"assignees":[{"login":"CurtizJ","id":20361854,"node_id":"MDQ6VXNlcjIwMzYxODU0","avatar_url":"https://avatars.githubusercontent.com/u/20361854?v=4","gravatar_id":"","url":"https://api.github.com/users/CurtizJ","html_url":"https://github.com/CurtizJ","followers_url":"https://api.github.com/users/CurtizJ/followers","following_url":"https://api.github.com/users/CurtizJ/following{/other_user}","gists_url":"https://api.github.com/users/CurtizJ/gists{/gist_id}","starred_url":"https://api.github.com/users/CurtizJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CurtizJ/subscriptions","organizations_url":"https://api.github.com/users/CurtizJ/orgs","repos_url":"https://api.github.com/users/CurtizJ/repos","events_url":"https://api.github.com/users/CurtizJ/events{/privacy}","received_events_url":"https://api.github.com/users/CurtizJ/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2019-10-21T20:53:38Z","updated_at":"2019-11-03T22:15:27Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"ClickHouse version: 19.15.1.1288\r\n\r\nWe have the memory limit set to 2GB, and this seemingly innocuous query is throwing a memory limit exception:\r\n\r\n```\r\nSELECT *\r\nFROM brain.brain_mb\r\nORDER BY timestamp DESC\r\nLIMIT 1\r\n\r\nReceived exception from server (version 19.15.1):\r\nCode: 241. DB::Exception: Received from localhost:9000. DB::Exception: Memory limit (for query) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4216168 bytes), maximum: 1.86 GiB.\r\n\r\n0 rows in set. Elapsed: 0.143 sec. Processed 34.20 thousand rows, 2.93 MB (239.10 thousand rows/s., 20.50 MB/s.)\r\n\r\nSELECT count(*)\r\nFROM brain.brain_mb\r\n\r\nâ”Œâ”€count()â”€â”\r\nâ”‚   49816 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nSELECT formatReadableSize(sum(bytes_on_disk))\r\nFROM system.parts\r\nWHERE (database = 'brain') AND (table = 'brain_mb')\r\n\r\nâ”Œâ”€formatReadableSize(sum(bytes_on_disk))â”€â”\r\nâ”‚ 1.14 MiB                               â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n#1344 may be related.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7413/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7341","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7341/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7341/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7341/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7341","id":507473463,"node_id":"MDU6SXNzdWU1MDc0NzM0NjM=","number":7341,"title":"upperUTF8 for some special cases gives wrong results","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":1546506700,"node_id":"MDU6TGFiZWwxNTQ2NTA2NzAw","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-functions","name":"comp-functions","color":"b5bcff","default":false,"description":"Relates to some SQL function"},{"id":1575085465,"node_id":"MDU6TGFiZWwxNTc1MDg1NDY1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/unexpected%20behaviour","name":"unexpected behaviour","color":"e088ca","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-15T20:45:41Z","updated_at":"2020-11-02T11:36:09Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"ClickHouse:\r\n```sql\r\nselect upperUTF8('ï¬€');\r\n\r\nâ”Œâ”€upperUTF8('ï¬€')â”€â”\r\nâ”‚ ï¬€              â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\nJavaScript:\r\n```js\r\n'ï¬€'.toUpperCase();\r\n\"FF\"\r\n```\r\n\r\nSee\r\nhttp://www.unicode.org/faq/casemap_charprop.html\r\nftp://ftp.unicode.org/Public/UCD/latest/ucd/SpecialCasing.txt","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7341/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7324","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7324/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7324/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7324/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7324","id":506773812,"node_id":"MDU6SXNzdWU1MDY3NzM4MTI=","number":7324,"title":"rand() function inconsistent with other databases","user":{"login":"drstrangelooker","id":10760721,"node_id":"MDQ6VXNlcjEwNzYwNzIx","avatar_url":"https://avatars.githubusercontent.com/u/10760721?v=4","gravatar_id":"","url":"https://api.github.com/users/drstrangelooker","html_url":"https://github.com/drstrangelooker","followers_url":"https://api.github.com/users/drstrangelooker/followers","following_url":"https://api.github.com/users/drstrangelooker/following{/other_user}","gists_url":"https://api.github.com/users/drstrangelooker/gists{/gist_id}","starred_url":"https://api.github.com/users/drstrangelooker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drstrangelooker/subscriptions","organizations_url":"https://api.github.com/users/drstrangelooker/orgs","repos_url":"https://api.github.com/users/drstrangelooker/repos","events_url":"https://api.github.com/users/drstrangelooker/events{/privacy}","received_events_url":"https://api.github.com/users/drstrangelooker/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":628291301,"node_id":"MDU6TGFiZWw2MjgyOTEzMDE=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/sql-compatibility","name":"sql-compatibility","color":"006b75","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-10-14T17:07:42Z","updated_at":"2019-10-15T05:51:48Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The rand() function in most databases yields a floating point value between 0 and 1. ClickHouse's rand() yields a value between 0 and 2^32-1. This is an unexpected result to most experienced database users.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7324/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7321","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7321/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7321/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7321/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7321","id":506765713,"node_id":"MDU6SXNzdWU1MDY3NjU3MTM=","number":7321,"title":"LIKE and MATCH donâ€™t support column values or certain complex expressions","user":{"login":"drstrangelooker","id":10760721,"node_id":"MDQ6VXNlcjEwNzYwNzIx","avatar_url":"https://avatars.githubusercontent.com/u/10760721?v=4","gravatar_id":"","url":"https://api.github.com/users/drstrangelooker","html_url":"https://github.com/drstrangelooker","followers_url":"https://api.github.com/users/drstrangelooker/followers","following_url":"https://api.github.com/users/drstrangelooker/following{/other_user}","gists_url":"https://api.github.com/users/drstrangelooker/gists{/gist_id}","starred_url":"https://api.github.com/users/drstrangelooker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drstrangelooker/subscriptions","organizations_url":"https://api.github.com/users/drstrangelooker/orgs","repos_url":"https://api.github.com/users/drstrangelooker/repos","events_url":"https://api.github.com/users/drstrangelooker/events{/privacy}","received_events_url":"https://api.github.com/users/drstrangelooker/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-10-14T16:49:22Z","updated_at":"2020-07-20T01:08:20Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Expressions where the right side can be reduced to a constant work fine.\r\n`user.name LIKE  '%John%'`\r\n\r\nBut if the right side can't be reduced to a constant, the search does not work.\r\n`user.name LIKE  CONCAT('%', orders.sales_rep, '%')`","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7321/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7320","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7320/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7320/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7320/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7320","id":506763974,"node_id":"MDU6SXNzdWU1MDY3NjM5NzQ=","number":7320,"title":"ClickHouse lacks an LPAD function","user":{"login":"drstrangelooker","id":10760721,"node_id":"MDQ6VXNlcjEwNzYwNzIx","avatar_url":"https://avatars.githubusercontent.com/u/10760721?v=4","gravatar_id":"","url":"https://api.github.com/users/drstrangelooker","html_url":"https://github.com/drstrangelooker","followers_url":"https://api.github.com/users/drstrangelooker/followers","following_url":"https://api.github.com/users/drstrangelooker/following{/other_user}","gists_url":"https://api.github.com/users/drstrangelooker/gists{/gist_id}","starred_url":"https://api.github.com/users/drstrangelooker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drstrangelooker/subscriptions","organizations_url":"https://api.github.com/users/drstrangelooker/orgs","repos_url":"https://api.github.com/users/drstrangelooker/repos","events_url":"https://api.github.com/users/drstrangelooker/events{/privacy}","received_events_url":"https://api.github.com/users/drstrangelooker/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":628291301,"node_id":"MDU6TGFiZWw2MjgyOTEzMDE=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/sql-compatibility","name":"sql-compatibility","color":"006b75","default":false,"description":""},{"id":1546506700,"node_id":"MDU6TGFiZWwxNTQ2NTA2NzAw","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-functions","name":"comp-functions","color":"b5bcff","default":false,"description":"Relates to some SQL function"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-14T16:45:29Z","updated_at":"2020-09-23T02:22:39Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"ClickHouse needs an LPAD function in order to map the functionality found in other databases.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7320/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7320/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7319","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7319/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7319/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7319/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7319","id":506763086,"node_id":"MDU6SXNzdWU1MDY3NjMwODY=","number":7319,"title":"No function to parse a Date or DateTime based on a pattern","user":{"login":"drstrangelooker","id":10760721,"node_id":"MDQ6VXNlcjEwNzYwNzIx","avatar_url":"https://avatars.githubusercontent.com/u/10760721?v=4","gravatar_id":"","url":"https://api.github.com/users/drstrangelooker","html_url":"https://github.com/drstrangelooker","followers_url":"https://api.github.com/users/drstrangelooker/followers","following_url":"https://api.github.com/users/drstrangelooker/following{/other_user}","gists_url":"https://api.github.com/users/drstrangelooker/gists{/gist_id}","starred_url":"https://api.github.com/users/drstrangelooker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drstrangelooker/subscriptions","organizations_url":"https://api.github.com/users/drstrangelooker/orgs","repos_url":"https://api.github.com/users/drstrangelooker/repos","events_url":"https://api.github.com/users/drstrangelooker/events{/privacy}","received_events_url":"https://api.github.com/users/drstrangelooker/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-10-14T16:43:39Z","updated_at":"2019-10-14T18:18:06Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"ClickHouse needs a counterpart to formatDateTime(). A counterpart for toYYYYMMDD() would also be useful.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7319/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7317","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7317/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7317/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7317/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7317","id":506751058,"node_id":"MDU6SXNzdWU1MDY3NTEwNTg=","number":7317,"title":"Date functions fail silently when values are out of range or arguments are null","user":{"login":"drstrangelooker","id":10760721,"node_id":"MDQ6VXNlcjEwNzYwNzIx","avatar_url":"https://avatars.githubusercontent.com/u/10760721?v=4","gravatar_id":"","url":"https://api.github.com/users/drstrangelooker","html_url":"https://github.com/drstrangelooker","followers_url":"https://api.github.com/users/drstrangelooker/followers","following_url":"https://api.github.com/users/drstrangelooker/following{/other_user}","gists_url":"https://api.github.com/users/drstrangelooker/gists{/gist_id}","starred_url":"https://api.github.com/users/drstrangelooker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drstrangelooker/subscriptions","organizations_url":"https://api.github.com/users/drstrangelooker/orgs","repos_url":"https://api.github.com/users/drstrangelooker/repos","events_url":"https://api.github.com/users/drstrangelooker/events{/privacy}","received_events_url":"https://api.github.com/users/drstrangelooker/received_events","type":"User","site_admin":false},"labels":[{"id":386401509,"node_id":"MDU6TGFiZWwzODY0MDE1MDk=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/invalid","name":"invalid","color":"e6e6e6","default":true,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-14T16:17:02Z","updated_at":"2020-07-14T18:50:01Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I consider values out of range to be an error condition, but I can understand a counter argument that the following is ok.\r\n`toDate('1969-12-31')` yields null.\r\n`toDateTime('1969-12-31 23:59:59')` yields null.\r\n\r\nThis behavior is definitely wrong.\r\n`toYear(toDate('1965-03-15'))` yields 1970.\r\n`toYear(NULL)` yields 1970.\r\nWith very few exceptions (for example the coalesce function and aggregate functions) a function with a null argument should **ALWAYS** produce a null result.\r\n\r\nThis allows an error to propagate with no obvious impact.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7317/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7317/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7275","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7275/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7275/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7275/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7275","id":505716234,"node_id":"MDU6SXNzdWU1MDU3MTYyMzQ=","number":7275,"title":"readonly settings constraint from default profile can't be changed in other profiles","user":{"login":"PhantomPhreak","id":8307692,"node_id":"MDQ6VXNlcjgzMDc2OTI=","avatar_url":"https://avatars.githubusercontent.com/u/8307692?v=4","gravatar_id":"","url":"https://api.github.com/users/PhantomPhreak","html_url":"https://github.com/PhantomPhreak","followers_url":"https://api.github.com/users/PhantomPhreak/followers","following_url":"https://api.github.com/users/PhantomPhreak/following{/other_user}","gists_url":"https://api.github.com/users/PhantomPhreak/gists{/gist_id}","starred_url":"https://api.github.com/users/PhantomPhreak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PhantomPhreak/subscriptions","organizations_url":"https://api.github.com/users/PhantomPhreak/orgs","repos_url":"https://api.github.com/users/PhantomPhreak/repos","events_url":"https://api.github.com/users/PhantomPhreak/events{/privacy}","received_events_url":"https://api.github.com/users/PhantomPhreak/received_events","type":"User","site_admin":false},"labels":[{"id":386401505,"node_id":"MDU6TGFiZWwzODY0MDE1MDU=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/bug","name":"bug","color":"ee0701","default":true,"description":"Confirmed user-visible misbehaviour in official release"},{"id":2011606513,"node_id":"MDU6TGFiZWwyMDExNjA2NTEz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-rbac","name":"comp-rbac","color":"b5bcff","default":false,"description":"Access control related"}],"state":"open","locked":false,"assignee":{"login":"vitlibar","id":45142681,"node_id":"MDQ6VXNlcjQ1MTQyNjgx","avatar_url":"https://avatars.githubusercontent.com/u/45142681?v=4","gravatar_id":"","url":"https://api.github.com/users/vitlibar","html_url":"https://github.com/vitlibar","followers_url":"https://api.github.com/users/vitlibar/followers","following_url":"https://api.github.com/users/vitlibar/following{/other_user}","gists_url":"https://api.github.com/users/vitlibar/gists{/gist_id}","starred_url":"https://api.github.com/users/vitlibar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vitlibar/subscriptions","organizations_url":"https://api.github.com/users/vitlibar/orgs","repos_url":"https://api.github.com/users/vitlibar/repos","events_url":"https://api.github.com/users/vitlibar/events{/privacy}","received_events_url":"https://api.github.com/users/vitlibar/received_events","type":"User","site_admin":false},"assignees":[{"login":"vitlibar","id":45142681,"node_id":"MDQ6VXNlcjQ1MTQyNjgx","avatar_url":"https://avatars.githubusercontent.com/u/45142681?v=4","gravatar_id":"","url":"https://api.github.com/users/vitlibar","html_url":"https://github.com/vitlibar","followers_url":"https://api.github.com/users/vitlibar/followers","following_url":"https://api.github.com/users/vitlibar/following{/other_user}","gists_url":"https://api.github.com/users/vitlibar/gists{/gist_id}","starred_url":"https://api.github.com/users/vitlibar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vitlibar/subscriptions","organizations_url":"https://api.github.com/users/vitlibar/orgs","repos_url":"https://api.github.com/users/vitlibar/repos","events_url":"https://api.github.com/users/vitlibar/events{/privacy}","received_events_url":"https://api.github.com/users/vitlibar/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-10-11T08:36:50Z","updated_at":"2020-04-24T14:00:25Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"As described in a [documentation](https://clickhouse.yandex/docs/en/single/#constraints-on-settings):\r\n\r\n> Note: the default profile has a special handling: all the constraints defined for the default profile become the default constraints, so they restrict all the users until they're overriden explicitly for these users.\r\n\r\nSo, i expect that i can set a `readonly` constraint for some setting for a `default` profile, then override it for some user by his profile.\r\n\r\nExample config:\r\n```\r\n<yandex>\r\n    <profiles>\r\n\r\n        <default>\r\n            <readonly>0</readonly>\r\n            <max_memory_usage>10000000000</max_memory_usage>\r\n            <constraints>\r\n                <max_memory_usage>\r\n                    <readonly/>\r\n                </max_memory_usage>\r\n            </constraints>\r\n        </default>\r\n\r\n        <developer>\r\n            <readonly>2</readonly>\r\n            <max_memory_usage>10000</max_memory_usage>\r\n            <constraints>\r\n                <max_memory_usage>\r\n                    <max>9999999999999999</max>\r\n                </max_memory_usage>\r\n            </constraints>\r\n        </developer>\r\n\r\n    </profiles>\r\n...\r\n</yandex>\r\n```\r\nWith this config i expect that i'll be able to change `max_memory_usage` for user with a profile `developer` up to `9999999999999999`, but when i try to do this, i receive following error:\r\n\r\n```\r\nmy_awesome_ch :) select * from system.settings where name='readonly'\r\n\r\nSELECT *\r\nFROM system.settings\r\nWHERE name = 'readonly'\r\n\r\nâ”Œâ”€nameâ”€â”€â”€â”€â”€â”¬â”€valueâ”€â”¬â”€changedâ”€â”¬â”€descriptionâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ readonly â”‚ 2     â”‚       1 â”‚ \"0 - everything is allowed. 1 - only read requests. 2 - only read requests, as well as changing settings, except for the 'readonly' setting.\" â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n1 rows in set. Elapsed: 0.004 sec. \r\n\r\nmy_awesome_ch :) set max_memory_usage=99999999;\r\n\r\nSET max_memory_usage = 99999999\r\n\r\nReceived exception from server (version 19.13.4):\r\nCode: 452. DB::Exception: Received from localhost:9000. DB::Exception: Setting max_memory_usage should not be changed. \r\n\r\n0 rows in set. Elapsed: 0.001 sec. \r\n\r\nmy_awesome_ch :) \r\n```\r\n\r\nI'm running ClickHouse  v19.13.4.32\r\nIs it a bug or inaccuracy in the documentation?\r\n\r\nThanks!","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7275/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7255","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7255/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7255/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7255/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7255","id":505220601,"node_id":"MDU6SXNzdWU1MDUyMjA2MDE=","number":7255,"title":"Match columns by positions vs by names when MV is created","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1350221495,"node_id":"MDU6TGFiZWwxMzUwMjIxNDk1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-matview","name":"comp-matview","color":"b5bcff","default":false,"description":"Materialized views"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-10-10T11:54:15Z","updated_at":"2022-01-05T17:19:50Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"```\r\ncreate table x1 ( a UInt8 ) Engine=MergeTree ORDER BY tuple();\r\ncreate table x2 ( a UInt8 ) Engine=MergeTree ORDER BY tuple();\r\ncreate materialized view x1_to_x2 to x2 as select a+1 FROM x1;\r\ninsert into x1 values (1);\r\n```\r\nResult:\r\n```\r\nReceived exception from server (version 19.15.2):\r\nCode: 8. DB::Exception: Received from localhost:9000. DB::Exception: Cannot find column `a` in source stream: while pushing to view default.x1_to_x2. \r\n```\r\n\r\nReason - now it expects that column names in source and target streams will match.\r\nSo that workaround solves the problem.\r\n```\r\ncreate materialized view x1_to_x2 to x2 as select a+1 as a FROM x1;\r\n```\r\nThat works.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7255/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7237","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7237/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7237/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7237/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7237","id":504319661,"node_id":"MDU6SXNzdWU1MDQzMTk2NjE=","number":7237,"title":"CASE  unexpected behaviour","user":{"login":"den-crane","id":19737682,"node_id":"MDQ6VXNlcjE5NzM3Njgy","avatar_url":"https://avatars.githubusercontent.com/u/19737682?v=4","gravatar_id":"","url":"https://api.github.com/users/den-crane","html_url":"https://github.com/den-crane","followers_url":"https://api.github.com/users/den-crane/followers","following_url":"https://api.github.com/users/den-crane/following{/other_user}","gists_url":"https://api.github.com/users/den-crane/gists{/gist_id}","starred_url":"https://api.github.com/users/den-crane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/den-crane/subscriptions","organizations_url":"https://api.github.com/users/den-crane/orgs","repos_url":"https://api.github.com/users/den-crane/repos","events_url":"https://api.github.com/users/den-crane/events{/privacy}","received_events_url":"https://api.github.com/users/den-crane/received_events","type":"User","site_admin":false},"labels":[{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"},{"id":1575085465,"node_id":"MDU6TGFiZWwxNTc1MDg1NDY1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/unexpected%20behaviour","name":"unexpected behaviour","color":"e088ca","default":false,"description":""},{"id":3086255531,"node_id":"MDU6TGFiZWwzMDg2MjU1NTMx","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/warmup%20task","name":"warmup task","color":"FBCA04","default":false,"description":"The task for new ClickHouse team members. Low risk, moderate complexity, no urgency."}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-10-08T22:54:43Z","updated_at":"2021-06-14T17:52:37Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"```\r\nSELECT id,  \r\n    CASE id \r\n         WHEN 1 THEN 'Z'  \r\n    END x \r\nFROM  (SELECT 1 as id)\r\n\r\nâ”Œâ”€idâ”€â”¬â”€xâ”€â”€â”€â”€â”\r\nâ”‚  1 â”‚ á´ºáµá´¸á´¸ â”‚\r\nâ””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nSELECT id,  \r\n       CASE id \r\n            WHEN 1 THEN 'Z' \r\n            ELSE 'X' \r\n     END x \r\nFROM  (SELECT 1 as id)\r\n\r\nâ”Œâ”€idâ”€â”¬â”€xâ”€â”\r\nâ”‚  1 â”‚ Z â”‚\r\nâ””â”€â”€â”€â”€â”´â”€â”€â”€â”˜\r\n18.14.18, 19.16.1.1414 \r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7237/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7230","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7230/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7230/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7230/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7230","id":504050378,"node_id":"MDU6SXNzdWU1MDQwNTAzNzg=","number":7230,"title":"we need a function named zipWithIndex or arrayJoinWithIndex","user":{"login":"Tasselmi","id":12438278,"node_id":"MDQ6VXNlcjEyNDM4Mjc4","avatar_url":"https://avatars.githubusercontent.com/u/12438278?v=4","gravatar_id":"","url":"https://api.github.com/users/Tasselmi","html_url":"https://github.com/Tasselmi","followers_url":"https://api.github.com/users/Tasselmi/followers","following_url":"https://api.github.com/users/Tasselmi/following{/other_user}","gists_url":"https://api.github.com/users/Tasselmi/gists{/gist_id}","starred_url":"https://api.github.com/users/Tasselmi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tasselmi/subscriptions","organizations_url":"https://api.github.com/users/Tasselmi/orgs","repos_url":"https://api.github.com/users/Tasselmi/repos","events_url":"https://api.github.com/users/Tasselmi/events{/privacy}","received_events_url":"https://api.github.com/users/Tasselmi/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-10-08T13:39:01Z","updated_at":"2019-10-09T02:20:53Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"the implementation below is a little complex(zipWithIndex)ï¼š\r\n\r\n```\r\nSELECT arrayMap((x, y) -> (x, y), range(length(['a', 'b', 'c'])), ['a', 'b', 'c'])\r\n\r\nâ”Œâ”€arrayMap(lambda(tuple(x, y), tuple(x, y)), range(length(['a', 'b', 'c'])), ['a', 'b', 'c'])â”€â”\r\nâ”‚ [(0,'a'),(1,'b'),(2,'c')]                                                                   â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\nI am doing a program computing user-behavior-path.\r\nI have to use function like `posexplode` in spark. \r\nIn clickhouse, I use `arrayMap` and `arrayJoin` to solve this problem, but\r\n I found it a little complex(arrayJoinWithIndex) :\r\n```\r\nSELECT\r\n    arrayJoin(arr) AS event_with_idx,\r\n    event_with_idx.1 AS idx,\r\n    event_with_idx.2 AS event\r\nFROM\r\n(\r\n    SELECT arrayMap((x, y) -> (x, y), range(length(['a', 'b', 'c'])), ['a', 'b', 'c']) AS arr\r\n) AS m\r\n\r\nâ”Œâ”€event_with_idxâ”€â”¬â”€idxâ”€â”¬â”€eventâ”€â”\r\nâ”‚ (0,'a')        â”‚   0 â”‚ a     â”‚\r\nâ”‚ (1,'b')        â”‚   1 â”‚ b     â”‚\r\nâ”‚ (2,'c')        â”‚   2 â”‚ c     â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7230/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7225","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7225/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7225/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7225/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7225","id":503952295,"node_id":"MDU6SXNzdWU1MDM5NTIyOTU=","number":7225,"title":"Use of array from WITH section in where IN statement","user":{"login":"alanrigele","id":48205008,"node_id":"MDQ6VXNlcjQ4MjA1MDA4","avatar_url":"https://avatars.githubusercontent.com/u/48205008?v=4","gravatar_id":"","url":"https://api.github.com/users/alanrigele","html_url":"https://github.com/alanrigele","followers_url":"https://api.github.com/users/alanrigele/followers","following_url":"https://api.github.com/users/alanrigele/following{/other_user}","gists_url":"https://api.github.com/users/alanrigele/gists{/gist_id}","starred_url":"https://api.github.com/users/alanrigele/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alanrigele/subscriptions","organizations_url":"https://api.github.com/users/alanrigele/orgs","repos_url":"https://api.github.com/users/alanrigele/repos","events_url":"https://api.github.com/users/alanrigele/events{/privacy}","received_events_url":"https://api.github.com/users/alanrigele/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-10-08T10:08:49Z","updated_at":"2020-07-01T18:09:15Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I have searched the interwebs for a possible reason or work around to my requirement. \r\n\r\nI am building a performance monitoring tool which will has a web based front end interface to define and build kpi calculations from various counters. The selection of counters and the formula in the WITH section are fine, but does not get applied in the WHERE counterName IN \r\n\r\nbelow is a sample \r\n\r\nwith (select ['67183489','67183490']) as arr, (avg_cnt2/avg_cnt1) as formula, arrayJoin(arr) as dst\r\nSELECT toStartOfHour(startDateTime) as dt, ID, \r\nsplitByChar(',',splitByString('=',ID)[2])[1] as CellLabel,\r\nsplitByChar('/',splitByString('=',ID)[3])[1] as CellId,\r\nsplitByChar('/',splitByString('DEST Cell ID:',ID)[2])[1] as DestCellId,\r\nsumIf(toFloat64(counterValue),counterName=arr[0]) as avg_cnt1,\r\nsumIf(toFloat64(counterValue),counterName=arr[1]) as avg_cnt2,\r\nformula*100 as HandOverRate\r\nfrom RAN.RawCounters\r\nwhere  counterName IN (arr)\r\n--counterName IN (dst) and \r\ntoDate(startDateTime) = '2019-10-02'\r\ngroup by dt,ID,CellLabel,CellId,DestCellId\r\n\r\n\r\nthe filter counterName IN ('67183489','67183490') functions 100% correctly. \r\nI have tried using the array, arrayJoin(arr) and a few other options. \r\n\r\nUsing counterName IN (arr) creates the following exception\r\nClickHouse exception, code: 53, host: 172.28.247.16, port: 8123; Code: 53, e.displayText() = DB::Exception: Types of column 1 in section IN don't match: Array(String) on the right, String on the left. (version 19.15.2.2)\r\n\r\nUsing the arrayJoin(arr) from the WITH section or in the IN filter provides\r\nClickHouse exception, code: 36, host: 172.28.247.16, port: 8123; Code: 36, e.displayText() = DB::Exception: Element of set in IN, VALUES or LIMIT is not a constant expression: dst (version 19.15.2.2)\r\n\r\n\r\nIf there is a way to do this, it would be greatly appreciated and would be a good example of the flexibility and power of clickhouse. \r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7225/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7206","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7206/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7206/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7206/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7206","id":503490451,"node_id":"MDU6SXNzdWU1MDM0OTA0NTE=","number":7206,"title":"Return modified rows","user":{"login":"ramazanpolat","id":3527695,"node_id":"MDQ6VXNlcjM1Mjc2OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3527695?v=4","gravatar_id":"","url":"https://api.github.com/users/ramazanpolat","html_url":"https://github.com/ramazanpolat","followers_url":"https://api.github.com/users/ramazanpolat/followers","following_url":"https://api.github.com/users/ramazanpolat/following{/other_user}","gists_url":"https://api.github.com/users/ramazanpolat/gists{/gist_id}","starred_url":"https://api.github.com/users/ramazanpolat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramazanpolat/subscriptions","organizations_url":"https://api.github.com/users/ramazanpolat/orgs","repos_url":"https://api.github.com/users/ramazanpolat/repos","events_url":"https://api.github.com/users/ramazanpolat/events{/privacy}","received_events_url":"https://api.github.com/users/ramazanpolat/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-10-07T14:30:39Z","updated_at":"2020-02-09T02:11:48Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"In some cases, we need to get the inserted/deleted/updated row(s). PostgreSQL [has a nice notation](https://www.postgresql.org/docs/9.5/dml-returning.html) for this:\r\n```sql\r\n    INSERT INTO users (firstname, lastname) \r\n        VALUES ('Joe', 'Cool') \r\n        RETURNING id;\r\n\r\n    UPDATE products SET price = price * 1.10\r\n        WHERE price <= 99.99\r\n        RETURNING name, price AS new_price;\r\n\r\n    DELETE FROM products\r\n        WHERE obsoletion_date = 'today'\r\n        RETURNING *;\r\n```\r\n\r\nAny chance having this in Clickhouse?\r\n\r\n**Use case 1**:  Get `default` or `materialized` columns since both are computed by CH.\r\n\r\nAssume table:\r\n\r\n```sql\r\nCREATE TABLE events (\r\n    entity String,\r\n    dt DateTime DEFAULT now(),\r\n    ts UInt64 MATERIALIZED  toUnixTimestamp(dt)\r\n    key String,\r\n    value Float32\r\n) ENGINE = ...\r\n\r\nINSERT INTO events (entity, key, value)\r\nVALUES ('cpu', 'temp', 81.2)\r\nRETURNING dt, ts\r\n```\r\n\r\n\r\n**Use case 2**: Archiving data.\r\nCurrently, users can utilize partitioning to archive old data. The problem about partitioning is that whole partition gets attached to detached which forces users to have yet another mind-boggling decision for table design, especially if the archiving is independent of a `DateTime` column. For example, customer X has billions of data and they stop using our service, so deleting their data would save us server resources but keeping their data is a lawful obligation so we should move their data to a cold storage. Besides there is always a chance that the customer X gets back to use our service hence needs their old data. Only solution is to archive their data, so we can access it if it is needed. With partitioning, this seems not so intuitive because customers can stop using our service anytime. If `RETURNING` expression would be possible, we could insert deleted data to a remote database which is served on a cold storage and used for archive.\r\n\r\n```sql\r\nINSERT INTO remote('archive_server', 'default', 'customer')\r\n   DELETE FROM customer\r\n   WHERE cust_id = 123\r\n   RETURNING *;\r\n```\r\n\r\nI know table mutations are not instant so implementing `RETURNING`  expression for INSERT and UPDATE/DELETE will be different but this would be a nice feature since it is only an SQL and it doesn't need to SSH into server to move detached partitions manually.\r\n\r\n**Use case 3**: Trigger*ish* behaviour.\r\nCombining with [URL table engine](https://clickhouse.yandex/docs/en/operations/table_engines/url/), `RETURNING` expression can be used to send modified data to an URL. So an application running on the target URL can act as body of an INSERT/DELETE/UPDATE trigger.\r\n\r\n```sql\r\nCREATE TABLE customer_delete_trigger (cust_id UInt64)\r\n    ENGINE=URL('http://127.0.0.1:12345/customer/delete', CSV)\r\n\r\nINSERT INTO customer_delete_trigger\r\n    DELETE FROM customer WHERE cust_id = 123\r\n    RETURNING cust_id\r\n```\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7206/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7195","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7195/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7195/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7195/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7195","id":502559789,"node_id":"MDU6SXNzdWU1MDI1NTk3ODk=","number":7195,"title":"Data not insert to MATERIALIZED created from another MATERIALIZED VIEW ","user":{"login":"Kiennh","id":6395999,"node_id":"MDQ6VXNlcjYzOTU5OTk=","avatar_url":"https://avatars.githubusercontent.com/u/6395999?v=4","gravatar_id":"","url":"https://api.github.com/users/Kiennh","html_url":"https://github.com/Kiennh","followers_url":"https://api.github.com/users/Kiennh/followers","following_url":"https://api.github.com/users/Kiennh/following{/other_user}","gists_url":"https://api.github.com/users/Kiennh/gists{/gist_id}","starred_url":"https://api.github.com/users/Kiennh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kiennh/subscriptions","organizations_url":"https://api.github.com/users/Kiennh/orgs","repos_url":"https://api.github.com/users/Kiennh/repos","events_url":"https://api.github.com/users/Kiennh/events{/privacy}","received_events_url":"https://api.github.com/users/Kiennh/received_events","type":"User","site_admin":false},"labels":[{"id":785082162,"node_id":"MDU6TGFiZWw3ODUwODIxNjI=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-documentation","name":"comp-documentation","color":"b5bcff","default":false,"description":"Used to run automatic builds of the documentation"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-10-04T10:32:58Z","updated_at":"2021-03-02T02:18:24Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug or unexpected behaviour**\r\nWhen I create MATERIALIZED view from another MATERIALIZED view, data not auto insert from the first view to the second view.\r\n\r\n**How to reproduce**\r\nCreate table and the views:\r\n```\r\nCREATE TABLE a1(label String) ENGINE=Log ;   \r\nCREATE MATERIALIZED VIEW a2 engine=Log as select * from a1; \r\nCREATE MATERIALIZED VIEW a3 engine=Log as select * from a2;\r\nCREATE MATERIALIZED VIEW a4 engine=Log as select * from a3;\r\n```\r\n\r\nInsert data into the table a1:\r\n```\r\nINSERT INTO a1 values('1');   \r\n```\r\n\r\nTest the result\r\n```\r\nSELECT *\r\nFROM a2\r\n\r\nâ”Œâ”€labelâ”€â”\r\nâ”‚ 1     â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n1 rows in set. Elapsed: 0.002 sec. \r\n```\r\n```\r\nSELECT *\r\nFROM a4\r\n\r\nOk.\r\n```\r\nThe select query to a3, a4 have 0 rows return, expect 1 rows with label '1'\r\n\r\n* Which ClickHouse server version to use\r\nThis error coming from some version of clickhouse such as:\r\nclickhouse-server: 19.13.5.44\r\nclickhouse-server: 19.15.2.2\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7195/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7195/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7187","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7187/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7187/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7187/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7187","id":502337637,"node_id":"MDU6SXNzdWU1MDIzMzc2Mzc=","number":7187,"title":"Massive slowdown when simply including a (large) column in the result","user":{"login":"lorenz","id":5228892,"node_id":"MDQ6VXNlcjUyMjg4OTI=","avatar_url":"https://avatars.githubusercontent.com/u/5228892?v=4","gravatar_id":"","url":"https://api.github.com/users/lorenz","html_url":"https://github.com/lorenz","followers_url":"https://api.github.com/users/lorenz/followers","following_url":"https://api.github.com/users/lorenz/following{/other_user}","gists_url":"https://api.github.com/users/lorenz/gists{/gist_id}","starred_url":"https://api.github.com/users/lorenz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorenz/subscriptions","organizations_url":"https://api.github.com/users/lorenz/orgs","repos_url":"https://api.github.com/users/lorenz/repos","events_url":"https://api.github.com/users/lorenz/events{/privacy}","received_events_url":"https://api.github.com/users/lorenz/received_events","type":"User","site_admin":false},"labels":[{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1507867504,"node_id":"MDU6TGFiZWwxNTA3ODY3NTA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-hold","name":"st-hold","color":"e5b890","default":false,"description":"We've paused the work on issue for some reason"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":18,"created_at":"2019-10-03T22:52:32Z","updated_at":"2021-06-03T10:57:13Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the situation**\r\nSimply adding a column in the result (even if only used for a final lookup) slows the whole query down massively since it get read completely as far as I can tell.\r\n\r\nPlease note that I'm just evaluating ClickHouse and I might be doing something dumb when specifying the table layout or writing queries.\r\n\r\n**How to reproduce**\r\nRunning on a single host with NVMe (read bandwith ~2GiB/s) with ClickHouse 19.15.2.2\r\n\r\nDataset is publicly available: https://blob.dolansoft.org/datasets/boyter-10m-repos/clickhouse-columns.tar (:warning: ~50GiB / 3.5B+ rows)\r\n```\r\nATTACH TABLE repositories\r\n(\r\n    `id` UInt32 CODEC(DoubleDelta), \r\n    `source` LowCardinality(String) CODEC(LZ4), \r\n    `user` String CODEC(LZ4), \r\n    `name` String CODEC(LZ4)\r\n)\r\nENGINE = MergeTree\r\nORDER BY id\r\nSETTINGS index_granularity = 8192\r\n\r\nATTACH TABLE files\r\n(\r\n    `repository_id` UInt32 CODEC(DoubleDelta), \r\n    `location` String CODEC(ZSTD(1)), \r\n    `language` LowCardinality(String), \r\n    `possible_languages` Array(LowCardinality(String)), \r\n    `bytes` UInt32 CODEC(T64, LZ4), \r\n    `lines` UInt32 CODEC(T64, LZ4), \r\n    `code` UInt32 CODEC(T64, LZ4), \r\n    `comment` UInt32 CODEC(T64, LZ4), \r\n    `blank` UInt32 CODEC(T64, LZ4), \r\n    `complexity` UInt32 CODEC(T64, LZ4), \r\n    `weighted_complexity` UInt32 CODEC(T64, LZ4)\r\n)\r\nENGINE = MergeTree\r\nORDER BY repository_id\r\nSETTINGS index_granularity = 8192\r\n```\r\n\r\nQuery A (fast):\r\n```\r\nSELECT \r\n    repository_id, \r\n    lines\r\nFROM files\r\nWHERE language = 'Plain Text'\r\nORDER BY lines DESC\r\nLIMIT 1\r\n\r\nâ”Œâ”€repository_idâ”€â”¬â”€â”€â”€â”€â”€linesâ”€â”\r\nâ”‚       3919430 â”‚ 347671811 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n1 rows in set. Elapsed: 3.587 sec. Processed 3.53 billion rows, 4.82 GB (983.87 million rows/s., 1.34 GB/s.) \r\n```\r\n\r\nQuery B (slow):\r\n```\r\nSELECT \r\n    repository_id, \r\n    location, \r\n    lines\r\nFROM files\r\nWHERE language = 'Plain Text'\r\nORDER BY lines DESC\r\nLIMIT 1\r\n\r\nâ”Œâ”€repository_idâ”€â”¬â”€locationâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€linesâ”€â”\r\nâ”‚       3919430 â”‚ data/1366100696temp.txt â”‚ 347671811 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n1 rows in set. Elapsed: 25.234 sec. Processed 3.53 billion rows, 13.53 GB (139.87 million rows/s., 536.21 MB/s.) \r\n```\r\n\r\n\r\n**Expected performance**\r\nI would expect both of these queries to take approximately the same time since ClickHouse can ignore the location column until it has found the single match and then just read that chunk from the (much heavier) location column. Instead it looks like it tries to read the whole location column and slows down the query around 8 times. I've also tried with argMax() instead of `order by x limit 1` but it seems to suffer from the same issue.\r\n\r\nOriginally I also had a join to `repositories` in there, but that did not change the performance of either query so I've removed it in the interest of a more minimal reproducer.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7187/reactions","total_count":4,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":3,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7187/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7102","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7102/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7102/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7102/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7102","id":498574006,"node_id":"MDU6SXNzdWU0OTg1NzQwMDY=","number":7102,"title":"optimize_read_in_order does not recognize that prefix is already sorted","user":{"login":"den-crane","id":19737682,"node_id":"MDQ6VXNlcjE5NzM3Njgy","avatar_url":"https://avatars.githubusercontent.com/u/19737682?v=4","gravatar_id":"","url":"https://api.github.com/users/den-crane","html_url":"https://github.com/den-crane","followers_url":"https://api.github.com/users/den-crane/followers","following_url":"https://api.github.com/users/den-crane/following{/other_user}","gists_url":"https://api.github.com/users/den-crane/gists{/gist_id}","starred_url":"https://api.github.com/users/den-crane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/den-crane/subscriptions","organizations_url":"https://api.github.com/users/den-crane/orgs","repos_url":"https://api.github.com/users/den-crane/repos","events_url":"https://api.github.com/users/den-crane/events{/privacy}","received_events_url":"https://api.github.com/users/den-crane/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":{"login":"CurtizJ","id":20361854,"node_id":"MDQ6VXNlcjIwMzYxODU0","avatar_url":"https://avatars.githubusercontent.com/u/20361854?v=4","gravatar_id":"","url":"https://api.github.com/users/CurtizJ","html_url":"https://github.com/CurtizJ","followers_url":"https://api.github.com/users/CurtizJ/followers","following_url":"https://api.github.com/users/CurtizJ/following{/other_user}","gists_url":"https://api.github.com/users/CurtizJ/gists{/gist_id}","starred_url":"https://api.github.com/users/CurtizJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CurtizJ/subscriptions","organizations_url":"https://api.github.com/users/CurtizJ/orgs","repos_url":"https://api.github.com/users/CurtizJ/repos","events_url":"https://api.github.com/users/CurtizJ/events{/privacy}","received_events_url":"https://api.github.com/users/CurtizJ/received_events","type":"User","site_admin":false},"assignees":[{"login":"CurtizJ","id":20361854,"node_id":"MDQ6VXNlcjIwMzYxODU0","avatar_url":"https://avatars.githubusercontent.com/u/20361854?v=4","gravatar_id":"","url":"https://api.github.com/users/CurtizJ","html_url":"https://github.com/CurtizJ","followers_url":"https://api.github.com/users/CurtizJ/followers","following_url":"https://api.github.com/users/CurtizJ/following{/other_user}","gists_url":"https://api.github.com/users/CurtizJ/gists{/gist_id}","starred_url":"https://api.github.com/users/CurtizJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CurtizJ/subscriptions","organizations_url":"https://api.github.com/users/CurtizJ/orgs","repos_url":"https://api.github.com/users/CurtizJ/repos","events_url":"https://api.github.com/users/CurtizJ/events{/privacy}","received_events_url":"https://api.github.com/users/CurtizJ/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-09-25T23:36:32Z","updated_at":"2021-12-10T14:00:42Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"create table ORX( A Int64, B Int64, V Int64) Engine=MergeTree order by (A,B)\r\ninsert into ORX select 111, number, number from numbers(10000000)\r\n\r\nselect * from ORX where **A = 111 order by B** limit 3;\r\n3 rows in set. Elapsed: 0.232 sec. **Processed 10.00 million rows**\r\n\r\n\r\nselect * from ORX where **A = 111 order by A,B** limit 3;\r\n3 rows in set. Elapsed: 0.019 sec. **Processed 245.76 thousand rows,**","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7102/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7094","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7094/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7094/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7094/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7094","id":498232850,"node_id":"MDU6SXNzdWU0OTgyMzI4NTA=","number":7094,"title":"Negation for sequenceMatch/sequenceCount","user":{"login":"killwort","id":4142887,"node_id":"MDQ6VXNlcjQxNDI4ODc=","avatar_url":"https://avatars.githubusercontent.com/u/4142887?v=4","gravatar_id":"","url":"https://api.github.com/users/killwort","html_url":"https://github.com/killwort","followers_url":"https://api.github.com/users/killwort/followers","following_url":"https://api.github.com/users/killwort/following{/other_user}","gists_url":"https://api.github.com/users/killwort/gists{/gist_id}","starred_url":"https://api.github.com/users/killwort/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/killwort/subscriptions","organizations_url":"https://api.github.com/users/killwort/orgs","repos_url":"https://api.github.com/users/killwort/repos","events_url":"https://api.github.com/users/killwort/events{/privacy}","received_events_url":"https://api.github.com/users/killwort/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-09-25T11:47:20Z","updated_at":"2020-12-16T07:23:20Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"ÐŸÐ¾ Ñ€ÑƒÑÑÐºÐ¸ Ð² Ð¿ÐµÑ€Ð²Ð¾Ð¼ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸, Ð° Ñ‚Ð¾ Ð²Ð´Ñ€ÑƒÐ³ Ñ Ð½Ðµ Ð¾Ñ‡ÐµÐ½ÑŒ Ð¸Ð·Ð»Ð°Ð³Ð°ÑŽ in english.\r\n\r\n**Use case**\r\nWhen analysing chains of events it would be great to have negation operator so one can select event chains where some event has never happened. \r\nImagine the log-style table with person 'deeds' with the following row structure `(person_id String, deed String, timestamp DateTime)`.\r\nThis table may be filled with some deed-per-person-records like `('person1','born','2000-01-01 00:00:00')`, `('person1','graduatedSchool','2001-01-01 00:00:00')`, etc.\r\n\r\nAnd now we want to select all persons who graduated from school in 2001 and have never graduated institute afterwards.\r\n\r\nIt could be represented with series of `arrayExists` calls in having section\r\n`select\r\n       persion_id,\r\n       groupArray(tuple(deed, timestamp)) data\r\nfrom facts\r\ngroup by person_id\r\nhaving\r\n    not arrayExists(x->x.1='graduatedInstitute',data)\r\n    and arrayExists(x->x.1='graduatedSchool' and x.2 between '2001-01-01 00:00:00' and '2002-01-01 00:00:00',data);`\r\n\r\nYet this syntax is awkward and does not enforce order of events. It would be much more clear with `sequenceMatch` call however it lacks negation support.\r\n\r\n**Possible solution**\r\nAdd to `sequesceMatch`'s pattern grammar negation operator. Like `(!?N)`. Using that one could enforce absence of some event (condition) in the chain of events.\r\nMaybe there should be alternate version with `(!?N)` positioned outside of match pattern to express condition \"this event never happened in given event chain regardless of other events\".\r\n\r\n**Alternatives**\r\nUsing `arrayExists`. Or combine both approaches. Really ugly and there's no clear way to enforce event order.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7094/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7088","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7088/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7088/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7088/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7088","id":497806568,"node_id":"MDU6SXNzdWU0OTc4MDY1Njg=","number":7088,"title":"Use `Join` as layout for dictionaries and for function `transform`","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1351463315,"node_id":"MDU6TGFiZWwxMzUxNDYzMzE1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-dictionary","name":"comp-dictionary","color":"b5bcff","default":false,"description":"Dictionaries"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-09-24T16:50:13Z","updated_at":"2021-12-23T08:58:33Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"**Use case**\r\nIt can be used to add support for all available types.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7088/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7088/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7081","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7081/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7081/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7081/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7081","id":497675276,"node_id":"MDU6SXNzdWU0OTc2NzUyNzY=","number":7081,"title":"Usability improvements for secondary indices.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""},{"id":1357507723,"node_id":"MDU6TGFiZWwxMzU3NTA3NzIz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-skipidx","name":"comp-skipidx","color":"b5bcff","default":false,"description":"Data skipping indices"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-09-24T13:03:50Z","updated_at":"2020-06-29T15:57:22Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"**Use case**\r\nPeople usually create indices of type `set` with unlimited size. It will lead to troubles.\r\nOther common mistake is to specify high GRANULARITY of secondary index.\r\n\r\n**Describe the solution you'd like**\r\n1. `set(0)` should be default value from merge-tree setting (for example, 100).\r\n2. If `GRANULARITY` of secondary index is greater than some merge-tree setting (for example, 1000), throw an exception.\r\n\r\nAlways allow to ATTACH table.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7081/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7081/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7071","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7071/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7071/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7071/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7071","id":497290547,"node_id":"MDU6SXNzdWU0OTcyOTA1NDc=","number":7071,"title":"Do not trigger the limit on number of rows to read if it's a trivial query with LIMIT.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-09-23T19:43:30Z","updated_at":"2019-09-23T19:47:05Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"```\r\nmilovidov-Pro-P30 :) SET max_rows_to_read = 1000000\r\n\r\nSET max_rows_to_read = 1000000\r\n\r\nOk.\r\n\r\n0 rows in set. Elapsed: 0.007 sec. \r\n\r\nmilovidov-Pro-P30 :) SELECT number FROM numbers(1000000000) LIMIT 1\r\n\r\nSELECT number\r\nFROM numbers(1000000000)\r\nLIMIT 1\r\n\r\nâ†’ Progress: 0.00 rows, 0.00 B (0.00 rows/s., 0.00 B/s.) Received exception from server (version 19.15.1):\r\nCode: 158. DB::Exception: Received from localhost:9000. DB::Exception: Limit for rows to read exceeded: 1000000000 rows read (or to read), maximum: 1000000.\r\n``` \r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7071/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7071/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7052","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7052/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7052/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7052/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7052","id":496942570,"node_id":"MDU6SXNzdWU0OTY5NDI1NzA=","number":7052,"title":"PR: apply new order by expression to new parts","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-09-23T07:48:18Z","updated_at":"2019-09-25T16:37:03Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Currently, clickhouse can't modify order by expression with existing columns from (a,b,c) to (b,a,c), as documented at https://clickhouse.yandex/docs/en/query_language/alter/#manipulations-with-key-expressions.\r\n\r\nCan new order by expression be applied to new parts? like said in this comment https://github.com/yandex/ClickHouse/issues/147#issuecomment-255632036\r\n\r\nIMO, a user who has little knowledge of clickhouse can't choose the best order by expression at the beginning and want to modify this expression and apply the new expression to new partitions.\r\nI know current it can workaround by creating a new table and copying old data to new table and rename the new table to the old name, but it is slow and complicated.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7052/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7018","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7018/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7018/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7018/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/7018","id":496345820,"node_id":"MDU6SXNzdWU0OTYzNDU4MjA=","number":7018,"title":"Support composite keys in Join Engine","user":{"login":"AntonSaykovsky","id":36437414,"node_id":"MDQ6VXNlcjM2NDM3NDE0","avatar_url":"https://avatars.githubusercontent.com/u/36437414?v=4","gravatar_id":"","url":"https://api.github.com/users/AntonSaykovsky","html_url":"https://github.com/AntonSaykovsky","followers_url":"https://api.github.com/users/AntonSaykovsky/followers","following_url":"https://api.github.com/users/AntonSaykovsky/following{/other_user}","gists_url":"https://api.github.com/users/AntonSaykovsky/gists{/gist_id}","starred_url":"https://api.github.com/users/AntonSaykovsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AntonSaykovsky/subscriptions","organizations_url":"https://api.github.com/users/AntonSaykovsky/orgs","repos_url":"https://api.github.com/users/AntonSaykovsky/repos","events_url":"https://api.github.com/users/AntonSaykovsky/events{/privacy}","received_events_url":"https://api.github.com/users/AntonSaykovsky/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2019-09-20T13:13:44Z","updated_at":"2019-10-10T23:38:59Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Ð”Ð¾Ð±Ñ€Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ.\r\n\r\nÐŸÑ€Ð¾Ð±ÑƒÑŽ Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÐºÐ¾Ð´:\r\n\r\n```\r\nCREATE TABLE IF NOT EXISTS test (\r\n    event_date DEFAULT toDate('2019-09-20'),\r\n    id UInt64 DEFAULT 0,\r\n    ver UInt8 DEFAULT 0\r\n) ENGINE = MergeTree()\r\nPARTITION BY toYYYYMM(event_date)\r\nORDER BY (id);\r\n            \r\nINSERT INTO test (id,ver) VALUES (1,0)(1,0)(1,0)(1,1)(1,2)(2,0)(2,0)(2,1)(2,2);\r\n\r\nSELECT * FROM test;\r\n            \r\nCREATE TABLE IF NOT EXISTS max_versions_test\r\nENGINE = Join(ANY, INNER, id, ver)\r\nAS SELECT \r\n    id,\r\n    MAX(ver) AS ver\r\nFROM test\r\nGROUP BY id;\r\n                \r\nSELECT *\r\nFROM test\r\nANY JOIN max_versions_test\r\nUSING (id, ver) \r\nSETTINGS any_join_distinct_right_table_keys=1;\r\n```\r\n\r\nÐŸÐ¾Ð»ÑƒÑ‡Ð°ÑŽ Ð¾ÑˆÐ¸Ð±ÐºÑƒ:\r\n\r\nCode: 121. DB::Exception: Unsupported JOIN keys in StorageJoin. Type: 8.\r\n\r\nÐ¡ SET any_join_distinct_right_table_keys=0; Ð²Ñ‹Ð´Ð°ÐµÑ‚ÑÑ Ð¿Ñ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ.\r\n\r\nÐšÐ°Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»? Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾.\r\n\r\nÐ’ÐµÑ€ÑÐ¸Ñ 19.14.3","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7018/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/7018/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6948","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6948/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6948/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6948/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6948","id":493989533,"node_id":"MDU6SXNzdWU0OTM5ODk1MzM=","number":6948,"title":"Support for non-constant timezone argument for DateTime functions","user":{"login":"imiskolee","id":4303880,"node_id":"MDQ6VXNlcjQzMDM4ODA=","avatar_url":"https://avatars.githubusercontent.com/u/4303880?v=4","gravatar_id":"","url":"https://api.github.com/users/imiskolee","html_url":"https://github.com/imiskolee","followers_url":"https://api.github.com/users/imiskolee/followers","following_url":"https://api.github.com/users/imiskolee/following{/other_user}","gists_url":"https://api.github.com/users/imiskolee/gists{/gist_id}","starred_url":"https://api.github.com/users/imiskolee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imiskolee/subscriptions","organizations_url":"https://api.github.com/users/imiskolee/orgs","repos_url":"https://api.github.com/users/imiskolee/repos","events_url":"https://api.github.com/users/imiskolee/events{/privacy}","received_events_url":"https://api.github.com/users/imiskolee/received_events","type":"User","site_admin":false},"labels":[{"id":386401507,"node_id":"MDU6TGFiZWwzODY0MDE1MDc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1481221764,"node_id":"MDU6TGFiZWwxNDgxMjIxNzY0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-datetime","name":"comp-datetime","color":"b5bcff","default":false,"description":"date & time & timezone related"},{"id":1507867504,"node_id":"MDU6TGFiZWwxNTA3ODY3NTA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-hold","name":"st-hold","color":"e5b890","default":false,"description":"We've paused the work on issue for some reason"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-09-16T11:21:58Z","updated_at":"2019-09-25T15:43:22Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"(you don't have to strictly follow this form)\r\n\r\n**Describe the bug or unexpected behaviour**\r\nA clear and concise description of what works not as it is supposed to.\r\n\r\n**How to reproduce**\r\n* Which ClickHouse server version to use\r\n\t19.13.3.26\r\n* Which interface to use, if matters\r\n* Non-default settings, if any\r\n* `CREATE TABLE` statements for all tables involved\r\n* Sample data for all these tables, use [clickhouse-obfuscator](https://github.com/yandex/ClickHouse/blob/master/dbms/programs/obfuscator/Obfuscator.cpp#L42-L80) if necessary\r\n* Queries to run that lead to unexpected result\r\n\r\n```sql\r\nSELECT\r\n    created_at,\r\n    time_zone,\r\n    toTimeZone(created_at, time_zone)\r\nFROM stores\r\nWHERE id = 22693\r\nLIMIT 1\r\n```\r\n```sh\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€created_atâ”€â”¬â”€time_zoneâ”€â”€â”€â”€â”€â”€â”¬â”€toTimeZone(created_at, time_zone)â”€â”\r\nâ”‚ 2017-08-09 10:15:01 â”‚ Asia/Hong_Kong â”‚               2017-08-09 10:15:01 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Error message and/or stacktrace**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6948/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6948/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6935","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6935/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6935/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6935/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6935","id":493279517,"node_id":"MDU6SXNzdWU0OTMyNzk1MTc=","number":6935,"title":"Slow inserts into Array(lowcardinality(...)) ","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1446368065,"node_id":"MDU6TGFiZWwxNDQ2MzY4MDY1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-lowcardinality","name":"comp-lowcardinality","color":"b5bcff","default":false,"description":"LowCardinality data type"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-09-13T11:40:26Z","updated_at":"2021-06-27T12:32:33Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"Direct insert into table with lot of `Array(LowCardinality(String))` columns:\r\n```\r\ncat data_arrays.tsv | time -p clickhouse-client -q 'INSERT INTO test_arrays_lc FORMAT TSV' --log_queries=1 --query_id=insert_into_test_arrays_lc --max_insert_block_size=50000 \r\nreal 32.04\r\nuser 30.25\r\nsys 0.61\r\n```\r\n\r\nInsert into table with `Array(String)` columns + copy data to the table with lot of `Array(LowCardinality(String))` columns:\r\n```\r\ncat data_arrays.tsv | time -p clickhouse-client -q 'INSERT INTO test_arrays FORMAT TSV' --log_queries=1 --query_id=insert_into_test_arrays --max_insert_block_size=50000 \r\nreal 13.91\r\nuser 8.64\r\nsys 1.15\r\n\r\ntime -p clickhouse-client -q 'INSERT INTO test_arrays_lc SELECT * FROM test_arrays' --log_queries=1 \r\nreal 8,89\r\nuser 0,01\r\nsys 0,02\r\n```\r\n\r\n8.89 + 13.91 = 22.8  is much better than 32.04\r\n\r\nDetails of the test: https://gist.github.com/filimonov/8f47f575bee742fe8997b5a9366ff541","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6935/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6935/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6913","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6913/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6913/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6913/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6913","id":492344530,"node_id":"MDU6SXNzdWU0OTIzNDQ1MzA=","number":6913,"title":"CLEAR COLUMN query should be allowed for the last columns of primary key.","user":{"login":"CurtizJ","id":20361854,"node_id":"MDQ6VXNlcjIwMzYxODU0","avatar_url":"https://avatars.githubusercontent.com/u/20361854?v=4","gravatar_id":"","url":"https://api.github.com/users/CurtizJ","html_url":"https://github.com/CurtizJ","followers_url":"https://api.github.com/users/CurtizJ/followers","following_url":"https://api.github.com/users/CurtizJ/following{/other_user}","gists_url":"https://api.github.com/users/CurtizJ/gists{/gist_id}","starred_url":"https://api.github.com/users/CurtizJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CurtizJ/subscriptions","organizations_url":"https://api.github.com/users/CurtizJ/orgs","repos_url":"https://api.github.com/users/CurtizJ/repos","events_url":"https://api.github.com/users/CurtizJ/events{/privacy}","received_events_url":"https://api.github.com/users/CurtizJ/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1507867504,"node_id":"MDU6TGFiZWwxNTA3ODY3NTA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-hold","name":"st-hold","color":"e5b890","default":false,"description":"We've paused the work on issue for some reason"}],"state":"open","locked":false,"assignee":{"login":"alesapin","id":3684697,"node_id":"MDQ6VXNlcjM2ODQ2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/3684697?v=4","gravatar_id":"","url":"https://api.github.com/users/alesapin","html_url":"https://github.com/alesapin","followers_url":"https://api.github.com/users/alesapin/followers","following_url":"https://api.github.com/users/alesapin/following{/other_user}","gists_url":"https://api.github.com/users/alesapin/gists{/gist_id}","starred_url":"https://api.github.com/users/alesapin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alesapin/subscriptions","organizations_url":"https://api.github.com/users/alesapin/orgs","repos_url":"https://api.github.com/users/alesapin/repos","events_url":"https://api.github.com/users/alesapin/events{/privacy}","received_events_url":"https://api.github.com/users/alesapin/received_events","type":"User","site_admin":false},"assignees":[{"login":"alesapin","id":3684697,"node_id":"MDQ6VXNlcjM2ODQ2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/3684697?v=4","gravatar_id":"","url":"https://api.github.com/users/alesapin","html_url":"https://github.com/alesapin","followers_url":"https://api.github.com/users/alesapin/followers","following_url":"https://api.github.com/users/alesapin/following{/other_user}","gists_url":"https://api.github.com/users/alesapin/gists{/gist_id}","starred_url":"https://api.github.com/users/alesapin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alesapin/subscriptions","organizations_url":"https://api.github.com/users/alesapin/orgs","repos_url":"https://api.github.com/users/alesapin/repos","events_url":"https://api.github.com/users/alesapin/events{/privacy}","received_events_url":"https://api.github.com/users/alesapin/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2019-09-11T16:33:57Z","updated_at":"2020-12-21T16:29:34Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"**Describe the bug or unexpected behaviour**\r\nNow you can delete primary key column using query `ALTER TABLE ... CLEAR COLUMN ... IN PARTITION ...`  and get wrong result in some queries, because of broken index. Even more you can delete all columns in partition and break all `SELECT`'s.\r\n\r\n**How to reproduce**\r\n```show create table test_clear\r\n\r\nSHOW CREATE TABLE test_clear\r\n\r\nâ”Œâ”€statementâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ CREATE TABLE default.test_clear (`d` Date, `s` String) ENGINE = MergeTree ORDER BY d SETTINGS index_granularity = 8192 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n```\r\nalter table test_clear clear column d in partition tuple()\r\n\r\nOk.\r\n```\r\n```\r\nalter table test_clear clear column s in partition tuple()\r\n\r\nOk.\r\n```\r\n```\r\nselect * from test_clear\r\n\r\nSELECT *\r\nFROM test_clear\r\n\r\nReceived exception from server (version 19.15.1):\r\nCode: 49. DB::Exception: Received from localhost:9000. DB::Exception: Could not find a column of minimum size in MergeTree, part ./data/default/test_clear/all_1_1_0/.\r\n```\r\n**Expected behavior**\r\nThrow exception in this case.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6913/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6879","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6879/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6879/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6879/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6879","id":491376674,"node_id":"MDU6SXNzdWU0OTEzNzY2NzQ=","number":6879,"title":"Implement Rate Limiting on OPTIMIZE operation","user":{"login":"volfco","id":433045,"node_id":"MDQ6VXNlcjQzMzA0NQ==","avatar_url":"https://avatars.githubusercontent.com/u/433045?v=4","gravatar_id":"","url":"https://api.github.com/users/volfco","html_url":"https://github.com/volfco","followers_url":"https://api.github.com/users/volfco/followers","following_url":"https://api.github.com/users/volfco/following{/other_user}","gists_url":"https://api.github.com/users/volfco/gists{/gist_id}","starred_url":"https://api.github.com/users/volfco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/volfco/subscriptions","organizations_url":"https://api.github.com/users/volfco/orgs","repos_url":"https://api.github.com/users/volfco/repos","events_url":"https://api.github.com/users/volfco/events{/privacy}","received_events_url":"https://api.github.com/users/volfco/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":22,"created_at":"2019-09-09T23:40:57Z","updated_at":"2020-07-06T15:09:36Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Running an OPTIMIZE on the modified table will use every resource on every node until the operation completes degrading cluster performance.\r\n\r\n![image](https://user-images.githubusercontent.com/433045/64573512-677a6700-d320-11e9-89aa-97258ebb894f.png)\r\n![image](https://user-images.githubusercontent.com/433045/64573598-b922f180-d320-11e9-9ab9-76108e7a7283.png)\r\n\r\nMy request is to either have a setting that limits these operations to a single core, or some way to have these operations run in the background with minimal impact.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6879/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6827","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6827/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6827/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6827/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6827","id":489598210,"node_id":"MDU6SXNzdWU0ODk1OTgyMTA=","number":6827,"title":"Please add array version for cutURLParameter to cut multiple parameters at a time","user":{"login":"cameronbraid","id":672405,"node_id":"MDQ6VXNlcjY3MjQwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/672405?v=4","gravatar_id":"","url":"https://api.github.com/users/cameronbraid","html_url":"https://github.com/cameronbraid","followers_url":"https://api.github.com/users/cameronbraid/followers","following_url":"https://api.github.com/users/cameronbraid/following{/other_user}","gists_url":"https://api.github.com/users/cameronbraid/gists{/gist_id}","starred_url":"https://api.github.com/users/cameronbraid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cameronbraid/subscriptions","organizations_url":"https://api.github.com/users/cameronbraid/orgs","repos_url":"https://api.github.com/users/cameronbraid/repos","events_url":"https://api.github.com/users/cameronbraid/events{/privacy}","received_events_url":"https://api.github.com/users/cameronbraid/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-09-05T08:15:44Z","updated_at":"2019-09-05T13:49:35Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Please add a version of cutURLParameter that takes a string[] \r\n\r\nCurrently you have to write the following :\r\n\r\n```\r\nselect\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n        cutURLParameter(\r\n            cutFragment(uri),\r\n        'variation'), \r\n        'reference'), \r\n        'gclid'), \r\n        'affiliate'), \r\n        'utm_source'), \r\n        'utm_content'), \r\n        'utm_term'), \r\n        'utm_medium'), \r\n        'utm_campaign')\r\n...\r\n```\r\n\r\nwould be nice to simplify it to \r\n\r\n```\r\nselect\r\n        cutURLParameters(\r\n            cutFragment(uri),\r\n        ['variation', \r\n        'reference', \r\n        'gclid', \r\n        'affiliate', \r\n        'utm_source', \r\n        'utm_content', \r\n        'utm_term', \r\n        'utm_medium', \r\n        'utm_campaign'])\r\n...\r\n```\r\n\r\nor even\r\n\r\n```\r\nwith ['variation', 'reference', 'gclid', 'affiliate', 'utm_source', 'utm_content', 'utm_term', 'utm_medium', 'utm_campaign'] as stripParams\r\n\r\nselect cutURLParameters(cutFragment(url), stripParams)\r\n...\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6827/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6813","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6813/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6813/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6813/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6813","id":489063908,"node_id":"MDU6SXNzdWU0ODkwNjM5MDg=","number":6813,"title":"Empty result with row level security and Distributed engine","user":{"login":"bgranvea","id":1116217,"node_id":"MDQ6VXNlcjExMTYyMTc=","avatar_url":"https://avatars.githubusercontent.com/u/1116217?v=4","gravatar_id":"","url":"https://api.github.com/users/bgranvea","html_url":"https://github.com/bgranvea","followers_url":"https://api.github.com/users/bgranvea/followers","following_url":"https://api.github.com/users/bgranvea/following{/other_user}","gists_url":"https://api.github.com/users/bgranvea/gists{/gist_id}","starred_url":"https://api.github.com/users/bgranvea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgranvea/subscriptions","organizations_url":"https://api.github.com/users/bgranvea/orgs","repos_url":"https://api.github.com/users/bgranvea/repos","events_url":"https://api.github.com/users/bgranvea/events{/privacy}","received_events_url":"https://api.github.com/users/bgranvea/received_events","type":"User","site_admin":false},"labels":[{"id":386401505,"node_id":"MDU6TGFiZWwzODY0MDE1MDU=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/bug","name":"bug","color":"ee0701","default":true,"description":"Confirmed user-visible misbehaviour in official release"},{"id":1493351059,"node_id":"MDU6TGFiZWwxNDkzMzUxMDU5","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/v19.13","name":"v19.13","color":"55007a","default":false,"description":"Issue affects version 19.13.* or PR was manually backported to related stable branch"},{"id":1634829961,"node_id":"MDU6TGFiZWwxNjM0ODI5OTYx","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-distributed","name":"comp-distributed","color":"b5bcff","default":false,"description":"Distributed tables"},{"id":2011606513,"node_id":"MDU6TGFiZWwyMDExNjA2NTEz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-rbac","name":"comp-rbac","color":"b5bcff","default":false,"description":"Access control related"}],"state":"open","locked":false,"assignee":{"login":"vitlibar","id":45142681,"node_id":"MDQ6VXNlcjQ1MTQyNjgx","avatar_url":"https://avatars.githubusercontent.com/u/45142681?v=4","gravatar_id":"","url":"https://api.github.com/users/vitlibar","html_url":"https://github.com/vitlibar","followers_url":"https://api.github.com/users/vitlibar/followers","following_url":"https://api.github.com/users/vitlibar/following{/other_user}","gists_url":"https://api.github.com/users/vitlibar/gists{/gist_id}","starred_url":"https://api.github.com/users/vitlibar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vitlibar/subscriptions","organizations_url":"https://api.github.com/users/vitlibar/orgs","repos_url":"https://api.github.com/users/vitlibar/repos","events_url":"https://api.github.com/users/vitlibar/events{/privacy}","received_events_url":"https://api.github.com/users/vitlibar/received_events","type":"User","site_admin":false},"assignees":[{"login":"vitlibar","id":45142681,"node_id":"MDQ6VXNlcjQ1MTQyNjgx","avatar_url":"https://avatars.githubusercontent.com/u/45142681?v=4","gravatar_id":"","url":"https://api.github.com/users/vitlibar","html_url":"https://github.com/vitlibar","followers_url":"https://api.github.com/users/vitlibar/followers","following_url":"https://api.github.com/users/vitlibar/following{/other_user}","gists_url":"https://api.github.com/users/vitlibar/gists{/gist_id}","starred_url":"https://api.github.com/users/vitlibar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vitlibar/subscriptions","organizations_url":"https://api.github.com/users/vitlibar/orgs","repos_url":"https://api.github.com/users/vitlibar/repos","events_url":"https://api.github.com/users/vitlibar/events{/privacy}","received_events_url":"https://api.github.com/users/vitlibar/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-09-04T10:03:01Z","updated_at":"2020-07-14T18:53:25Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"A subrequest on a Distributed table with a row level security filter gives an empty result.\r\n\r\nTested with 19.13.3.26 (Docker)\r\n\r\n```\r\ncat <<EOF > /etc/clickhouse-server/users.d/test.xml\r\n<?xml version=\"1.0\"?>\r\n<yandex>\r\n    <users>\r\n        <d1>\r\n            <password></password>\r\n\r\n            <networks replace=\"replace\">\r\n                <ip>::/0</ip>\r\n            </networks>\r\n\r\n            <profile>default</profile>\r\n            <quota>default</quota>\r\n\r\n            <allow_databases>\r\n                <database>default</database>\r\n            </allow_databases>\r\n\r\n            <databases>\r\n                <default>\r\n                    <test>\r\n                        <filter>domain = 'd1'</filter>\r\n                    </test>\r\n                    <test2>\r\n                        <filter>domain = 'd1'</filter>\r\n                    </test2>\r\n                    <test_distrib>\r\n                        <filter>domain = 'd1'</filter>\r\n                    </test_distrib>\r\n                    <test2_distrib>\r\n                        <filter>domain = 'd1'</filter>\r\n                    </test2_distrib>\r\n                </default>\r\n            </databases>\r\n        </d1>\r\n    </users>\r\n</yandex>\r\nEOF\r\n\r\ncreate table test(domain String, date_time DateTime, `str` String) ENGINE=MergeTree partition by toStartOfDay(date_time) order by (domain,date_time);\r\ncreate table test2(domain String, date_time DateTime, `str` String) ENGINE=MergeTree partition by toStartOfDay(date_time) order by (domain,date_time);\r\n\r\ncreate table test_distrib ENGINE=Distributed('test_shard_localhost','default','test') as select * from test limit 0;\r\ncreate table test2_distrib ENGINE=Distributed('test_shard_localhost','default','test2') as select * from test2 limit 0;\r\n\r\ninsert into test values('d1',now(),'str1'),('d2',now(),'str2');\r\ninsert into test2 values('d1',now(),'str1'),('d2',now(),'str2');\r\n```\r\n\r\nWith user 'default':\r\n```\r\nselect * from test where str in (select str from test2);\r\nâ”Œâ”€domainâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€date_timeâ”€â”¬â”€strâ”€â”€â”\r\nâ”‚ d1     â”‚ 2019-09-04 09:59:54 â”‚ str1 â”‚\r\nâ”‚ d2     â”‚ 2019-09-04 09:59:54 â”‚ str2 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nselect * from test_distrib where str in (select str from test2_distrib);\r\nâ”Œâ”€domainâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€date_timeâ”€â”¬â”€strâ”€â”€â”\r\nâ”‚ d1     â”‚ 2019-09-04 09:59:54 â”‚ str1 â”‚\r\nâ”‚ d2     â”‚ 2019-09-04 09:59:54 â”‚ str2 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\nWith user 'd1':\r\n```\r\nselect * from test where str in (select str from test2);\r\nâ”Œâ”€domainâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€date_timeâ”€â”¬â”€strâ”€â”€â”\r\nâ”‚ d1     â”‚ 2019-09-04 09:59:54 â”‚ str1 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nselect * from test_distrib where str in (select str from test2_distrib);\r\n0 rows in set. \r\n\r\nselect str from test_distrib\r\nâ”Œâ”€strâ”€â”€â”\r\nâ”‚ str1 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nselect str from test2_distrib\r\nâ”Œâ”€strâ”€â”€â”\r\nâ”‚ str1 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6813/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6808","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6808/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6808/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6808/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6808","id":488845580,"node_id":"MDU6SXNzdWU0ODg4NDU1ODA=","number":6808,"title":"Add function to check if an IPv4/6 is in a list of subnets","user":{"login":"champtar","id":3536755,"node_id":"MDQ6VXNlcjM1MzY3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/3536755?v=4","gravatar_id":"","url":"https://api.github.com/users/champtar","html_url":"https://github.com/champtar","followers_url":"https://api.github.com/users/champtar/followers","following_url":"https://api.github.com/users/champtar/following{/other_user}","gists_url":"https://api.github.com/users/champtar/gists{/gist_id}","starred_url":"https://api.github.com/users/champtar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/champtar/subscriptions","organizations_url":"https://api.github.com/users/champtar/orgs","repos_url":"https://api.github.com/users/champtar/repos","events_url":"https://api.github.com/users/champtar/events{/privacy}","received_events_url":"https://api.github.com/users/champtar/received_events","type":"User","site_admin":false},"labels":[{"id":386401508,"node_id":"MDU6TGFiZWwzODY0MDE1MDg=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/help%20wanted","name":"help wanted","color":"128A0C","default":true,"description":null},{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":{"login":"kitaisreal","id":22458333,"node_id":"MDQ6VXNlcjIyNDU4MzMz","avatar_url":"https://avatars.githubusercontent.com/u/22458333?v=4","gravatar_id":"","url":"https://api.github.com/users/kitaisreal","html_url":"https://github.com/kitaisreal","followers_url":"https://api.github.com/users/kitaisreal/followers","following_url":"https://api.github.com/users/kitaisreal/following{/other_user}","gists_url":"https://api.github.com/users/kitaisreal/gists{/gist_id}","starred_url":"https://api.github.com/users/kitaisreal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kitaisreal/subscriptions","organizations_url":"https://api.github.com/users/kitaisreal/orgs","repos_url":"https://api.github.com/users/kitaisreal/repos","events_url":"https://api.github.com/users/kitaisreal/events{/privacy}","received_events_url":"https://api.github.com/users/kitaisreal/received_events","type":"User","site_admin":false},"assignees":[{"login":"kitaisreal","id":22458333,"node_id":"MDQ6VXNlcjIyNDU4MzMz","avatar_url":"https://avatars.githubusercontent.com/u/22458333?v=4","gravatar_id":"","url":"https://api.github.com/users/kitaisreal","html_url":"https://github.com/kitaisreal","followers_url":"https://api.github.com/users/kitaisreal/followers","following_url":"https://api.github.com/users/kitaisreal/following{/other_user}","gists_url":"https://api.github.com/users/kitaisreal/gists{/gist_id}","starred_url":"https://api.github.com/users/kitaisreal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kitaisreal/subscriptions","organizations_url":"https://api.github.com/users/kitaisreal/orgs","repos_url":"https://api.github.com/users/kitaisreal/repos","events_url":"https://api.github.com/users/kitaisreal/events{/privacy}","received_events_url":"https://api.github.com/users/kitaisreal/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-09-03T22:02:28Z","updated_at":"2022-01-19T14:34:38Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Use case**\r\nUsing ip_trie, I can check if an IP is in any X subnets\r\nI have no easy way to do a quick CLI query to match ~ 5 subnets without creating a dict\r\n\r\n**Describe the solution you'd like**\r\nSomething like\r\n`IPmatchNet(ip, [subnet1, subnet2])`\r\nip being `IPv4` or `IPv6` or `UInt32` or `FixedString(16)`\r\nsubnet1 is an IPv6 or IPv4 subnet as string (`192.168.0.0/21`), same as what is accepted by ip_trie\r\n\r\n`IPmatchNet` should return the matched subnet so we can use it in `GROUP BY`\r\nAlso `IPmatchNet` should handle IPv4 mapped IPv6 (#6806)\r\n\r\n**Additional context**\r\nI'm bad at naming, IPmatchNet is just an exemple\r\nRight now `cutIPv6` cuts bytes and not bits, so I can only use it for /24 /16 /8 (for IPv4)\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6808/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6808/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6800","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6800/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6800/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6800/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6800","id":488629865,"node_id":"MDU6SXNzdWU0ODg2Mjk4NjU=","number":6800,"title":"Row level security performance problems","user":{"login":"bgranvea","id":1116217,"node_id":"MDQ6VXNlcjExMTYyMTc=","avatar_url":"https://avatars.githubusercontent.com/u/1116217?v=4","gravatar_id":"","url":"https://api.github.com/users/bgranvea","html_url":"https://github.com/bgranvea","followers_url":"https://api.github.com/users/bgranvea/followers","following_url":"https://api.github.com/users/bgranvea/following{/other_user}","gists_url":"https://api.github.com/users/bgranvea/gists{/gist_id}","starred_url":"https://api.github.com/users/bgranvea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgranvea/subscriptions","organizations_url":"https://api.github.com/users/bgranvea/orgs","repos_url":"https://api.github.com/users/bgranvea/repos","events_url":"https://api.github.com/users/bgranvea/events{/privacy}","received_events_url":"https://api.github.com/users/bgranvea/received_events","type":"User","site_admin":false},"labels":[{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-09-03T14:10:16Z","updated_at":"2019-09-03T18:29:54Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"In some cases, requests on tables with user row level security filters can be very slow. It is a known limitation of current implementation (see https://github.com/yandex/ClickHouse/pull/4792) but this can be a showstopper for production.\r\n\r\nhow to reproduce (tested with Docker image 19.11.8.46):\r\n\r\n```\r\ncat <<EOF > /etc/clickhouse-server/users.d/user.xml\r\n<?xml version=\"1.0\"?>\r\n<yandex>\r\n    <users>\r\n        <d1>\r\n            <password></password>\r\n\r\n            <networks replace=\"replace\">\r\n                <ip>::/0</ip>\r\n            </networks>\r\n\r\n            <profile>default</profile>\r\n            <quota>default</quota>\r\n\r\n            <allow_databases>\r\n                <database>default</database>\r\n            </allow_databases>\r\n\r\n            <databases>\r\n                <default>\r\n                    <test>\r\n                        <filter>domain = 'd1'</filter>\r\n                    </test>\r\n                </default>\r\n            </databases>\r\n        </d1>\r\n    </users>\r\n</yandex>\r\nEOF\r\n```\r\n\r\n```\r\ndrop table test;\r\ncreate table test(domain String, date_time DateTime, `c1` String, `c2` String, `c3` String, `c4` String, `c5` String, `c6` String, `c7` String, `c8` String, `c9` String, `c10` String, `c11` String, `c12` String, `c13` String, `c14` String, `c15` String) ENGINE=MergeTree partition by toStartOfDay(date_time) order by (domain,date_time);\r\n\r\ninsert into test select 'd1',toDateTime('2019-01-01 00:00:00'),generateUUIDv4() s,s,s,s,s,s,s,s,s,s,s,s,s,s,s;\r\ninsert into test select 'd2',toDateTime('2019-01-01 00:00:00') + number,generateUUIDv4() s,s,s,s,s,s,s,s,s,s,s,s,s,s,s from system.numbers limit 1000000;\r\n```\r\n\r\n```\r\nselect * from test limit 2 (executed with user 'd1'):\r\n1 rows in set. Elapsed: 18.793 sec. Processed 1.00 million rows, 690.00 MB (53.21 thousand rows/s., 36.72 MB/s.)\r\n\r\nselect * from test where domain='d1' limit 2 (executed with user 'default'):\r\n1 rows in set. Elapsed: 0.024 sec. Processed 8.19 thousand rows, 5.65 MB (346.32 thousand rows/s., 238.96 MB/s.)\r\n\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6800/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6794","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6794/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6794/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6794/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6794","id":488512787,"node_id":"MDU6SXNzdWU0ODg1MTI3ODc=","number":6794,"title":"affected_rows in system.mutations ","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""},{"id":1351290474,"node_id":"MDU6TGFiZWwxMzUxMjkwNDc0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-mutations","name":"comp-mutations","color":"b5bcff","default":false,"description":"ALTER UPDATE/DELETE"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-09-03T10:07:54Z","updated_at":"2021-12-05T20:41:27Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"I didn't check the code, but probably should be doable, and definitely would be useful.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6794/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6772","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6772/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6772/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6772/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6772","id":488031874,"node_id":"MDU6SXNzdWU0ODgwMzE4NzQ=","number":6772,"title":"cloud-friendy distributed tables with better scaling","user":{"login":"zhangxu19830126","id":2995754,"node_id":"MDQ6VXNlcjI5OTU3NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/2995754?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangxu19830126","html_url":"https://github.com/zhangxu19830126","followers_url":"https://api.github.com/users/zhangxu19830126/followers","following_url":"https://api.github.com/users/zhangxu19830126/following{/other_user}","gists_url":"https://api.github.com/users/zhangxu19830126/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangxu19830126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangxu19830126/subscriptions","organizations_url":"https://api.github.com/users/zhangxu19830126/orgs","repos_url":"https://api.github.com/users/zhangxu19830126/repos","events_url":"https://api.github.com/users/zhangxu19830126/events{/privacy}","received_events_url":"https://api.github.com/users/zhangxu19830126/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1634829961,"node_id":"MDU6TGFiZWwxNjM0ODI5OTYx","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-distributed","name":"comp-distributed","color":"b5bcff","default":false,"description":"Distributed tables"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-09-02T07:04:00Z","updated_at":"2020-10-20T04:24:09Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Use case**\r\nAt present, the distributed tables of Clickhouse could not saitisfy our requirements in terms of scalability, auto-rebalance, and performance. Therefore, we propose to implement Converthouse, to help Clickhouse manage distributed tables better, such that Clickhouse could be more cloud-native friendly.\r\n\r\n**Describe the solution you'd like**\r\n[Converthouse](https://github.com/deepfabric/converthouse/blob/master/docs/design.md)\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6772/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6743","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6743/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6743/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6743/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6743","id":487415958,"node_id":"MDU6SXNzdWU0ODc0MTU5NTg=","number":6743,"title":"verbose mode partition commands with wrong partition identifier","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":386401508,"node_id":"MDU6TGFiZWwzODY0MDE1MDg=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/help%20wanted","name":"help wanted","color":"128A0C","default":true,"description":null},{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"},{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""},{"id":1006992822,"node_id":"MDU6TGFiZWwxMDA2OTkyODIy","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/operations","name":"operations","color":"7fe8ba","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-08-30T10:40:30Z","updated_at":"2021-12-23T08:42:25Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"Quite often when some partition manipulation is needed user not sure how to reference the partition - like '2019-01-01' or 20190101 or '2019-01-01 00:00:00' etc. \r\n\r\nSome feedback is desired when bad partition reference is used. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6743/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6741","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6741/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6741/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6741/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6741","id":487394584,"node_id":"MDU6SXNzdWU0ODczOTQ1ODQ=","number":6741,"title":"Resample aggregation functions give inconsistent results for floting point data","user":{"login":"chbuescher","id":16101913,"node_id":"MDQ6VXNlcjE2MTAxOTEz","avatar_url":"https://avatars.githubusercontent.com/u/16101913?v=4","gravatar_id":"","url":"https://api.github.com/users/chbuescher","html_url":"https://github.com/chbuescher","followers_url":"https://api.github.com/users/chbuescher/followers","following_url":"https://api.github.com/users/chbuescher/following{/other_user}","gists_url":"https://api.github.com/users/chbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/chbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chbuescher/subscriptions","organizations_url":"https://api.github.com/users/chbuescher/orgs","repos_url":"https://api.github.com/users/chbuescher/repos","events_url":"https://api.github.com/users/chbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/chbuescher/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-08-30T09:50:45Z","updated_at":"2020-07-01T18:13:15Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I'm trying to use the resampling aggregation functions avgResample, anyResample .. for downscaling time series metric data. When there is no data in the interval for downsampling, the resample results depend on the used aggregation function.\r\nFor example `avgResample` gives `nan` values but `minResamples` gives `0` \r\n```\r\nselect avgResample(10,20,2)(value, number) from (select number, rand()/4294967296 as value from numbers(10))\r\n\r\navgResample(10, 20, 2)(value, number)\r\n[nan,nan,nan,nan,nan]\r\n\r\nminResample(10, 20, 2)(value, number)\r\n[0,0,0,0,0]                           â”‚\r\n```\r\n\r\nIMHO when downsampling floating point data the resample function should return nan values in this case.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6741/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6739","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6739/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6739/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6739/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6739","id":487324565,"node_id":"MDU6SXNzdWU0ODczMjQ1NjU=","number":6739,"title":"DDSketch Quantiles","user":{"login":"MrBuddyCasino","id":3044875,"node_id":"MDQ6VXNlcjMwNDQ4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3044875?v=4","gravatar_id":"","url":"https://api.github.com/users/MrBuddyCasino","html_url":"https://github.com/MrBuddyCasino","followers_url":"https://api.github.com/users/MrBuddyCasino/followers","following_url":"https://api.github.com/users/MrBuddyCasino/following{/other_user}","gists_url":"https://api.github.com/users/MrBuddyCasino/gists{/gist_id}","starred_url":"https://api.github.com/users/MrBuddyCasino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrBuddyCasino/subscriptions","organizations_url":"https://api.github.com/users/MrBuddyCasino/orgs","repos_url":"https://api.github.com/users/MrBuddyCasino/repos","events_url":"https://api.github.com/users/MrBuddyCasino/events{/privacy}","received_events_url":"https://api.github.com/users/MrBuddyCasino/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-30T07:08:27Z","updated_at":"2021-05-21T21:55:04Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"(you don't have to strictly follow this form)\r\n\r\n**Use case**\r\nWe are currently using two `QuantilesTimingWeighted` columns, one for values up to 30sec and one scaled by 100 for larger values. We'd like to be able to use just one column to gain speed, but t-digest is slower overall. \r\n\r\n**Describe the solution you'd like**\r\nDDSketch has just been released, but it is described as being very fast. Our hope is that we can use DDSketch with a single `QuantilesTiming` column with decent precision and gain speed.\r\n\r\n**Additional context**\r\nHN thread: https://news.ycombinator.com/item?id=20829404","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6739/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6707","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6707/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6707/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6707/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6707","id":486498269,"node_id":"MDU6SXNzdWU0ODY0OTgyNjk=","number":6707,"title":"Multiquery support via HTTP","user":{"login":"jcdang","id":721579,"node_id":"MDQ6VXNlcjcyMTU3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/721579?v=4","gravatar_id":"","url":"https://api.github.com/users/jcdang","html_url":"https://github.com/jcdang","followers_url":"https://api.github.com/users/jcdang/followers","following_url":"https://api.github.com/users/jcdang/following{/other_user}","gists_url":"https://api.github.com/users/jcdang/gists{/gist_id}","starred_url":"https://api.github.com/users/jcdang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jcdang/subscriptions","organizations_url":"https://api.github.com/users/jcdang/orgs","repos_url":"https://api.github.com/users/jcdang/repos","events_url":"https://api.github.com/users/jcdang/events{/privacy}","received_events_url":"https://api.github.com/users/jcdang/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1481327553,"node_id":"MDU6TGFiZWwxNDgxMzI3NTUz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-http","name":"comp-http","color":"b5bcff","default":false,"description":"http protocol related"},{"id":1507886722,"node_id":"MDU6TGFiZWwxNTA3ODg2NzIy","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-discussion","name":"st-discussion","color":"e5b890","default":false,"description":"The story requires discussion /research / expert help / design & decomposition before will be taken"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":27,"created_at":"2019-08-28T16:56:55Z","updated_at":"2020-07-01T18:13:27Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Use case**\r\nCurrently the clickhouse-client supports multiquery.  The same uses would be beneficial if they were available via the HTTP interface.\r\n\r\n**Describe the solution you'd like**\r\nI have a bunch of queries I want to run sequentially on ClickHouse.  I would like to submit them in one HTTP request because of network latency.\r\n\r\n**Describe alternatives you've considered**\r\nSubmitting queries in separate requests works, but it would be faster to make one request especially when you don't care about the output of the query.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6707/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6707/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6698","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6698/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6698/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6698/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6698","id":486226857,"node_id":"MDU6SXNzdWU0ODYyMjY4NTc=","number":6698,"title":"Clickhouse client uses only first resolved ip from localhost","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":993003747,"node_id":"MDU6TGFiZWw5OTMwMDM3NDc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-cli","name":"comp-cli","color":"b5bcff","default":false,"description":"Console & command line"},{"id":1401253328,"node_id":"MDU6TGFiZWwxNDAxMjUzMzI4","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-net","name":"comp-net","color":"b5bcff","default":false,"description":"Network related"},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-08-28T08:17:46Z","updated_at":"2021-05-31T20:01:01Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"```\r\n# clickhouse-client -h localhost\r\nCode: 210. DB::NetException: Connection refused (localhost:9000)\r\n\r\n# clickhouse-client -h ::1\r\nCode: 210. DB::NetException: Connection refused (::1:9000)\r\n\r\n# clickhouse-client -h 127.0.0.1\r\nConnected to ClickHouse server version 19.11.3 revision 54423.\r\n\r\n# getent ahosts localhost \r\n::1             STREAM localhost\r\n::1             DGRAM  \r\n::1             RAW    \r\n127.0.0.1       STREAM \r\n127.0.0.1       DGRAM  \r\n127.0.0.1       RAW    \r\n\r\n# getent hosts localhost \r\n::1             localhost localhost.localdomain localhost6 localhost6.localdoman6\r\n\r\n\r\n# ping localhost\r\nPING localhost (127.0.0.1) 56(84) bytes of data.\r\n64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.024 ms\r\n```\r\n\r\nProbably same issue is possible for other connection types (for example intercluster server 2  server). ","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6698/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6697","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6697/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6697/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6697/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6697","id":486195020,"node_id":"MDU6SXNzdWU0ODYxOTUwMjA=","number":6697,"title":"Correlated subqueries","user":{"login":"samz406","id":3055810,"node_id":"MDQ6VXNlcjMwNTU4MTA=","avatar_url":"https://avatars.githubusercontent.com/u/3055810?v=4","gravatar_id":"","url":"https://api.github.com/users/samz406","html_url":"https://github.com/samz406","followers_url":"https://api.github.com/users/samz406/followers","following_url":"https://api.github.com/users/samz406/following{/other_user}","gists_url":"https://api.github.com/users/samz406/gists{/gist_id}","starred_url":"https://api.github.com/users/samz406/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samz406/subscriptions","organizations_url":"https://api.github.com/users/samz406/orgs","repos_url":"https://api.github.com/users/samz406/repos","events_url":"https://api.github.com/users/samz406/events{/privacy}","received_events_url":"https://api.github.com/users/samz406/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":628291301,"node_id":"MDU6TGFiZWw2MjgyOTEzMDE=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/sql-compatibility","name":"sql-compatibility","color":"006b75","default":false,"description":""},{"id":1507867504,"node_id":"MDU6TGFiZWwxNTA3ODY3NTA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-hold","name":"st-hold","color":"e5b890","default":false,"description":"We've paused the work on issue for some reason"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-08-28T07:00:19Z","updated_at":"2021-12-26T19:09:39Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I want use the follow sql query,it's not work, I use msyql execute it's ok. can ck is support?\r\n\r\n```\r\nSELECT \r\n(SELECT A1.QTY_SOLD  FROM V_LB_DC_ITEM_CUST_MONTH A1 WHERE A1.CUST_ID=A.CUST_ID LIMIT 1) AS TQ_QTY_SOLD,\r\nA.QTY_SOLD\r\nFROM V_LB_DC_ITEM_CUST_MONTH A\r\n\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/3055810/63832906-589cc780-c9a4-11e9-9c89-d354c1435b3c.png)\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6697/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6697/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6614","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6614/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6614/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6614/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6614","id":484143241,"node_id":"MDU6SXNzdWU0ODQxNDMyNDE=","number":6614,"title":"Provide a system table to show the status of ON CLUSTER queries.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1365579236,"node_id":"MDU6TGFiZWwxMzY1NTc5MjM2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/minor","name":"minor","color":"FFF8F8","default":false,"description":"Priority: minor"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-22T18:22:11Z","updated_at":"2021-11-11T20:22:38Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6614/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6613","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6613/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6613/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6613/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6613","id":484140958,"node_id":"MDU6SXNzdWU0ODQxNDA5NTg=","number":6613,"title":"Allow to provide exact value instead of \"rows_before_limit_at_least\"","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"},{"id":1365579236,"node_id":"MDU6TGFiZWwxMzY1NTc5MjM2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/minor","name":"minor","color":"FFF8F8","default":false,"description":"Priority: minor"}],"state":"open","locked":false,"assignee":{"login":"MaxWk","id":16871244,"node_id":"MDQ6VXNlcjE2ODcxMjQ0","avatar_url":"https://avatars.githubusercontent.com/u/16871244?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxWk","html_url":"https://github.com/MaxWk","followers_url":"https://api.github.com/users/MaxWk/followers","following_url":"https://api.github.com/users/MaxWk/following{/other_user}","gists_url":"https://api.github.com/users/MaxWk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxWk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxWk/subscriptions","organizations_url":"https://api.github.com/users/MaxWk/orgs","repos_url":"https://api.github.com/users/MaxWk/repos","events_url":"https://api.github.com/users/MaxWk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxWk/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaxWk","id":16871244,"node_id":"MDQ6VXNlcjE2ODcxMjQ0","avatar_url":"https://avatars.githubusercontent.com/u/16871244?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxWk","html_url":"https://github.com/MaxWk","followers_url":"https://api.github.com/users/MaxWk/followers","following_url":"https://api.github.com/users/MaxWk/following{/other_user}","gists_url":"https://api.github.com/users/MaxWk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxWk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxWk/subscriptions","organizations_url":"https://api.github.com/users/MaxWk/orgs","repos_url":"https://api.github.com/users/MaxWk/repos","events_url":"https://api.github.com/users/MaxWk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxWk/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2019-08-22T18:16:51Z","updated_at":"2021-06-16T02:55:28Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"**Describe the solution you'd like**\r\nA setting `exact_rows_before_limit` = 0|1. When enabled, `LimitBlockInputStream` will `always_read_till_end_` (we already have this feature in code) and the field `rows_before_limit_at_least` will have precise value.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6613/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6613/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6601","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6601/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6601/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6601/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6601","id":483734842,"node_id":"MDU6SXNzdWU0ODM3MzQ4NDI=","number":6601,"title":"'set' data skipping index is not used for filters like 'x in (subquery)'","user":{"login":"SaltTan","id":20357526,"node_id":"MDQ6VXNlcjIwMzU3NTI2","avatar_url":"https://avatars.githubusercontent.com/u/20357526?v=4","gravatar_id":"","url":"https://api.github.com/users/SaltTan","html_url":"https://github.com/SaltTan","followers_url":"https://api.github.com/users/SaltTan/followers","following_url":"https://api.github.com/users/SaltTan/following{/other_user}","gists_url":"https://api.github.com/users/SaltTan/gists{/gist_id}","starred_url":"https://api.github.com/users/SaltTan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SaltTan/subscriptions","organizations_url":"https://api.github.com/users/SaltTan/orgs","repos_url":"https://api.github.com/users/SaltTan/repos","events_url":"https://api.github.com/users/SaltTan/events{/privacy}","received_events_url":"https://api.github.com/users/SaltTan/received_events","type":"User","site_admin":false},"labels":[{"id":1357507723,"node_id":"MDU6TGFiZWwxMzU3NTA3NzIz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-skipidx","name":"comp-skipidx","color":"b5bcff","default":false,"description":"Data skipping indices"},{"id":1397894054,"node_id":"MDU6TGFiZWwxMzk3ODk0MDU0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/unfinished%20code","name":"unfinished code","color":"ff8800","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-22T02:23:54Z","updated_at":"2020-12-01T04:13:01Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"19.13.2.19\r\n\r\n\r\n```\r\nSET allow_experimental_data_skipping_indices = 1;\r\ndrop table skip_set;\r\nCREATE TABLE skip_set \r\n( x UInt64, \r\n  INDEX x_idx x TYPE set (0) GRANULARITY 2\r\n) \r\nENGINE = MergeTree () order BY tuple() \r\nSETTINGS index_granularity = 8192;\r\n\r\ninsert into skip_set (x) select number from numbers(100000);\r\n```\r\n\r\nHere the index has dropped 6 granules:\r\n```\r\nselect count() from skip_set where x in (1,2,3);\r\n\r\n[ 44 ] <Debug> executeQuery: (from [::1]:52066) SELECT count() FROM skip_set WHERE x IN (1, 2, 3)\r\n[ 44 ] <Debug> test.skip_set (SelectExecutor): Key condition: unknown\r\n[ 44 ] <Debug> test.skip_set (SelectExecutor): Index `x_idx` has dropped 6 granules.\r\n[ 44 ] <Debug> test.skip_set (SelectExecutor): Selected 1 parts by date, 1 parts by key, 2 marks to read from 1 ranges\r\n```\r\n\r\nHere there is no mention of the index:\r\n```\r\nselect count() from skip_set where x in (select toUInt64(1));\r\n\r\n[ 44 ] <Debug> executeQuery: (from [::1]:52066) SELECT count() FROM skip_set WHERE x IN (SELECT toUInt64(1))\r\n[ 44 ] <Debug> test.skip_set (SelectExecutor): Key condition: unknown\r\n[ 44 ] <Debug> test.skip_set (SelectExecutor): Selected 1 parts by date, 1 parts by key, 14 marks to read from 1 ranges\r\n\r\nselect count() from skip_set where x in (select number from numbers(3))\r\n\r\n[ 44 ] <Debug> executeQuery: (from [::1]:52066) SELECT count() FROM skip_set WHERE x IN (SELECT number FROM numbers(3))\r\n[ 44 ] <Debug> test.skip_set (SelectExecutor): Key condition: unknown\r\n[ 44 ] <Debug> test.skip_set (SelectExecutor): Selected 1 parts by date, 1 parts by key, 14 marks to read from 1 ranges\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6601/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6589","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6589/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6589/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6589/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6589","id":483308998,"node_id":"MDU6SXNzdWU0ODMzMDg5OTg=","number":6589,"title":"Join of 2 Distributed tables","user":{"login":"Crazylearner30","id":45940564,"node_id":"MDQ6VXNlcjQ1OTQwNTY0","avatar_url":"https://avatars.githubusercontent.com/u/45940564?v=4","gravatar_id":"","url":"https://api.github.com/users/Crazylearner30","html_url":"https://github.com/Crazylearner30","followers_url":"https://api.github.com/users/Crazylearner30/followers","following_url":"https://api.github.com/users/Crazylearner30/following{/other_user}","gists_url":"https://api.github.com/users/Crazylearner30/gists{/gist_id}","starred_url":"https://api.github.com/users/Crazylearner30/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crazylearner30/subscriptions","organizations_url":"https://api.github.com/users/Crazylearner30/orgs","repos_url":"https://api.github.com/users/Crazylearner30/repos","events_url":"https://api.github.com/users/Crazylearner30/events{/privacy}","received_events_url":"https://api.github.com/users/Crazylearner30/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-08-21T09:34:30Z","updated_at":"2020-07-01T18:21:51Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"We have 2 shards and one distributed table table1. '\r\nData is distributed properly between shards for table1. \r\nWe have another table table2 which need to JOIN with the table1.\r\nWe need all records in the table2 duplicated across both shards. \r\n\r\nIs there a way to achieve this? ","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6589/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6589/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6571","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6571/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6571/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6571/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6571","id":482873178,"node_id":"MDU6SXNzdWU0ODI4NzMxNzg=","number":6571,"title":"Join between distributed (locally defined) and sharded table (not locally defined)","user":{"login":"maqroll","id":415742,"node_id":"MDQ6VXNlcjQxNTc0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/415742?v=4","gravatar_id":"","url":"https://api.github.com/users/maqroll","html_url":"https://github.com/maqroll","followers_url":"https://api.github.com/users/maqroll/followers","following_url":"https://api.github.com/users/maqroll/following{/other_user}","gists_url":"https://api.github.com/users/maqroll/gists{/gist_id}","starred_url":"https://api.github.com/users/maqroll/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maqroll/subscriptions","organizations_url":"https://api.github.com/users/maqroll/orgs","repos_url":"https://api.github.com/users/maqroll/repos","events_url":"https://api.github.com/users/maqroll/events{/privacy}","received_events_url":"https://api.github.com/users/maqroll/received_events","type":"User","site_admin":false},"labels":[{"id":386401505,"node_id":"MDU6TGFiZWwzODY0MDE1MDU=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/bug","name":"bug","color":"ee0701","default":true,"description":"Confirmed user-visible misbehaviour in official release"},{"id":1357578153,"node_id":"MDU6TGFiZWwxMzU3NTc4MTUz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-joins","name":"comp-joins","color":"b5bcff","default":false,"description":"JOINs"},{"id":1507867504,"node_id":"MDU6TGFiZWwxNTA3ODY3NTA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-hold","name":"st-hold","color":"e5b890","default":false,"description":"We've paused the work on issue for some reason"},{"id":1634829961,"node_id":"MDU6TGFiZWwxNjM0ODI5OTYx","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-distributed","name":"comp-distributed","color":"b5bcff","default":false,"description":"Distributed tables"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-08-20T13:49:39Z","updated_at":"2021-06-21T21:30:33Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"ORDERS is a distributed table defined over many ORDERS_shard tables.\r\nLINEITEM is a distributed table defined over many LINEITEM_shard tables.\r\n\r\nThis query\r\n\r\n```\r\nselect \r\n\tO_ORDERPRIORITY,\r\n\tcount(*) as order_count\r\nfrom ORDERS  JOIN (\r\n\tselect L_ORDERKEY\r\n\tfrom\r\n\tLINEITEM_shard\r\n\tgroup by L_ORDERKEY\r\n\thaving any(L_COMMITDATE < L_RECEIPTDATE)\r\n) on O_ORDERKEY=L_ORDERKEY\r\ngroup by O_ORDERPRIORITY\r\norder by O_ORDERPRIORITY\r\nlimit 1;\r\n```\r\n\r\nworks by performing local joins between ORDERS_shard and LINEITEM_shard but **requires LINEITEM_shard to be defined in the node that receives the initial query (just for validating the query)**. \r\nIf not we get: \r\n\r\n```\r\nCode: 60. DB::Exception: Received from ...:9000, .... DB::Exception: Table LINEITEM_shard doesn't exist.. \r\n\r\n0. /usr/bin/clickhouse-server(StackTrace::StackTrace()+0x16) [0x72865f6]\r\n1. /usr/bin/clickhouse-server(DB::Exception::Exception(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)+0x22) [0x39a90f2]\r\n2. /usr/bin/clickhouse-server(DB::Context::getTableImpl(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, DB::Exception*) const+0x382) [0x668b0e2]\r\n3. /usr/bin/clickhouse-server(DB::Context::getTable(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) const+0x73) [0x668b2d3]\r\n4. /usr/bin/clickhouse-server(DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, DB::Context const&, std::shared_ptr<DB::IBlockInputStream> const&, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)+0x10b0) [0x66e4c50]\r\n5. /usr/bin/clickhouse-server(DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, DB::Context const&, DB::SelectQueryOptions const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)+0x4a) [0x66e4e9a]\r\n6. /usr/bin/clickhouse-server(DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, DB::Context const&, DB::SelectQueryOptions const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)+0x76f) [0x66f1e9f]\r\n7. /usr/bin/clickhouse-server(DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::shared_ptr<DB::IAST> const&, DB::Context const&)+0x149) [0x66f2f79]\r\n8. /usr/bin/clickhouse-server(DB::getNamesAndTypeListFromTableExpression(DB::ASTTableExpression const&, DB::Context const&)+0x74) [0x6c8c934]\r\n9. /usr/bin/clickhouse-server(DB::SyntaxAnalyzer::analyze(std::shared_ptr<DB::IAST>&, DB::NamesAndTypesList const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&, std::shared_ptr<DB::IStorage>) const+0x952) [0x67ad5a2]\r\n10. /usr/bin/clickhouse-server(DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, DB::Context const&, std::shared_ptr<DB::IBlockInputStream> const&, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)+0x49e) [0x66e403e]\r\n11. /usr/bin/clickhouse-server(DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, DB::Context const&, DB::SelectQueryOptions const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)+0x4a) [0x66e4e9a]12. /usr/bin/clickhouse-server(DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, DB::Context const&, DB::SelectQueryOptions const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)+0x76f) [0x66f1e9f]\r\n13. /usr/bin/clickhouse-server(DB::InterpreterFactory::get(std::shared_ptr<DB::IAST>&, DB::Context&, DB::QueryProcessingStage::Enum)+0x164) [0x66c9464]\r\n14. /usr/bin/clickhouse-server() [0x67e2bc9]\r\n15. /usr/bin/clickhouse-server(DB::executeQuery(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, DB::Context&, bool, DB::QueryProcessingStage::Enum, bool)+0x74) [0x67e2e44]\r\n16. /usr/bin/clickhouse-server(DB::TCPHandler::runImpl()+0x730) [0x39b49f0]\r\n17. /usr/bin/clickhouse-server(DB::TCPHandler::run()+0x2b) [0x39b503b]\r\n18. /usr/bin/clickhouse-server(Poco::Net::TCPServerConnection::start()+0xf) [0x73956bf]\r\n19. /usr/bin/clickhouse-server(Poco::Net::TCPServerDispatcher::run()+0xe9) [0x7395df9]\r\n20. /usr/bin/clickhouse-server(Poco::PooledThread::run()+0x81) [0x7446a71]\r\n21. /usr/bin/clickhouse-server(Poco::ThreadImpl::runnableEntry(void*)+0x38) [0x7442e78]\r\n22. /usr/bin/clickhouse-server() [0xb1a35df]\r\n23. /lib64/libpthread.so.0(+0x7dd5) [0x7f18a79eedd5]\r\n24. /lib64/libc.so.6(clone+0x6d) [0x7f18a7009ead]\r\n```\r\n\r\nIf the nodes that process the query don't store data (ORDERS is a Distributed query defined over a remote cluster) we need to setup an empty (don't use the data, just the definition) LINEITEM_shard to be able to execute the query.\r\n\r\n**I'd expect that validation to be done on the remote cluster.**\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6571/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6567","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6567/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6567/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6567/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6567","id":482837952,"node_id":"MDU6SXNzdWU0ODI4Mzc5NTI=","number":6567,"title":"Unclear which timeout is exceeded","user":{"login":"MrBuddyCasino","id":3044875,"node_id":"MDQ6VXNlcjMwNDQ4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3044875?v=4","gravatar_id":"","url":"https://api.github.com/users/MrBuddyCasino","html_url":"https://github.com/MrBuddyCasino","followers_url":"https://api.github.com/users/MrBuddyCasino/followers","following_url":"https://api.github.com/users/MrBuddyCasino/following{/other_user}","gists_url":"https://api.github.com/users/MrBuddyCasino/gists{/gist_id}","starred_url":"https://api.github.com/users/MrBuddyCasino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrBuddyCasino/subscriptions","organizations_url":"https://api.github.com/users/MrBuddyCasino/orgs","repos_url":"https://api.github.com/users/MrBuddyCasino/repos","events_url":"https://api.github.com/users/MrBuddyCasino/events{/privacy}","received_events_url":"https://api.github.com/users/MrBuddyCasino/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""},{"id":1507888214,"node_id":"MDU6TGFiZWwxNTA3ODg4MjE0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-accepted","name":"st-accepted","color":"e5b890","default":false,"description":"The issue is in our backlog, ready to take"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-08-20T12:43:37Z","updated_at":"2019-08-20T12:54:05Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"When using the CLI to execute a query like this `clickhouse-client --query=\"SELECT * FROM table\"` > table.dump, you're likely to receive a timeout:\r\n\r\n```Received exception from server (version 19.9.4):\r\nCode: 159. DB::Exception: Received from localhost:9000, 127.0.0.1. DB::Exception: Timeout exceeded: elapsed 100.055088602 seconds, maximum: 100:\r\n```\r\n\r\nTo the user, it is not at all clear which timeout it is that is being exceeded, and which command line option should be adjusted to fix it. It would be helpful to be more verbose here.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6567/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6567/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6557","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6557/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6557/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6557/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6557","id":482549725,"node_id":"MDU6SXNzdWU0ODI1NDk3MjU=","number":6557,"title":"Type mismatch in IN or VALUES section â€“ provide column names","user":{"login":"simPod","id":327717,"node_id":"MDQ6VXNlcjMyNzcxNw==","avatar_url":"https://avatars.githubusercontent.com/u/327717?v=4","gravatar_id":"","url":"https://api.github.com/users/simPod","html_url":"https://github.com/simPod","followers_url":"https://api.github.com/users/simPod/followers","following_url":"https://api.github.com/users/simPod/following{/other_user}","gists_url":"https://api.github.com/users/simPod/gists{/gist_id}","starred_url":"https://api.github.com/users/simPod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simPod/subscriptions","organizations_url":"https://api.github.com/users/simPod/orgs","repos_url":"https://api.github.com/users/simPod/repos","events_url":"https://api.github.com/users/simPod/events{/privacy}","received_events_url":"https://api.github.com/users/simPod/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-08-19T22:03:37Z","updated_at":"2020-07-01T18:14:36Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"From time to time I encounter this message \r\n\r\nhttps://github.com/yandex/ClickHouse/blob/187311add0acfc3eef122aac538eda5d9a42bf6d/dbms/src/Interpreters/convertFieldToType.cpp#L70\r\n\r\nIt would be UX valuable to me to know which columns cause the issue.\r\n\r\nI tried to help by opening a PR but I'm not skilled in C++ and failed (must study that a bit :/). I was looking for some `getName()` fcn in `Field` which would enhance the error message.\r\n\r\nIs it doable or not possible?","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6557/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6557/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6551","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6551/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6551/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6551/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6551","id":482449497,"node_id":"MDU6SXNzdWU0ODI0NDk0OTc=","number":6551,"title":"Relax \"Too many parts\" threshold.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-19T18:00:43Z","updated_at":"2021-12-23T08:22:33Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"If the server has huge disk shelves, the number of data parts can be large, because the maximum size of single data part is just 150 GB. Example: a server has 150 TB of storage and there are 1000 data parts in a single partition of 150 GB each.\r\n\r\nProposal: delay inserts or throw and exception only if there are too many parts and their average size is less than specified threshold (e.g. max_part_size / 10).","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6551/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6537","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6537/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6537/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6537/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6537","id":482070921,"node_id":"MDU6SXNzdWU0ODIwNzA5MjE=","number":6537,"title":"Additional array functions for signal processing","user":{"login":"zombiemonkey","id":1689537,"node_id":"MDQ6VXNlcjE2ODk1Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1689537?v=4","gravatar_id":"","url":"https://api.github.com/users/zombiemonkey","html_url":"https://github.com/zombiemonkey","followers_url":"https://api.github.com/users/zombiemonkey/followers","following_url":"https://api.github.com/users/zombiemonkey/following{/other_user}","gists_url":"https://api.github.com/users/zombiemonkey/gists{/gist_id}","starred_url":"https://api.github.com/users/zombiemonkey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zombiemonkey/subscriptions","organizations_url":"https://api.github.com/users/zombiemonkey/orgs","repos_url":"https://api.github.com/users/zombiemonkey/repos","events_url":"https://api.github.com/users/zombiemonkey/events{/privacy}","received_events_url":"https://api.github.com/users/zombiemonkey/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1401233890,"node_id":"MDU6TGFiZWwxNDAxMjMzODkw","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-arrays","name":"comp-arrays","color":"b5bcff","default":false,"description":"Arrays / array joins / higher order"},{"id":2082312777,"node_id":"MDU6TGFiZWwyMDgyMzEyNzc3","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-almost-fixed","name":"st-almost-fixed","color":"e5b890","default":false,"description":"Some fixes were applied but some still considered"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-08-19T02:02:19Z","updated_at":"2021-12-23T08:40:53Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I've been pondering three additional functions that make sense in signal processing and stock/trading applications:\r\n\r\n#### arrayCoalesce(array, array, [default])\r\n\r\nApply coalesce to each corresponding element in an array. For instance:\r\n```sql\r\nwith\r\n    [([0,NULL], [NULL,0]), ([NULL,1], [NULL,NULL]), ([NULL,NULL], [1,0])] AS v\r\nselect\r\n    arrayMap(x -> (coalesce((x.1)[1], (x.2)[1])), v) AS v1,\r\n    arrayMap(x -> (coalesce((x.1)[2], (x.2)[2])), v) AS v2;\r\n```\r\nArrays could be any length obviously.\r\n\r\n#### arrayFill(array, [user defined value])\r\n\r\nReplace NULL values in a given array by the previous non-NULL value.\r\n\r\nCurrent workaround/example. Note doesn't scale very well in both time/memory.\r\n```sql\r\nselect \r\n    arrayMap(\r\n        k-> \r\n            if(v[k] is null, \r\n                arrayFilter(x -> x is not Null, arrayReverse(arraySlice(v,1,k)))[1],\r\n                v[k]),\r\n            arrayEnumerate([1,2,3,NULL,NULL,5] AS v)) as k1;\r\n```\r\n\r\n#### arrayFillReverse()\r\n\r\nReverse of the above. Fill the previous NULL element with the next non-NULL value.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6537/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6533","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6533/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6533/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6533/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6533","id":482023739,"node_id":"MDU6SXNzdWU0ODIwMjM3Mzk=","number":6533,"title":"system stop/start consume kafka {kafka_engine_table}","user":{"login":"den-crane","id":19737682,"node_id":"MDQ6VXNlcjE5NzM3Njgy","avatar_url":"https://avatars.githubusercontent.com/u/19737682?v=4","gravatar_id":"","url":"https://api.github.com/users/den-crane","html_url":"https://github.com/den-crane","followers_url":"https://api.github.com/users/den-crane/followers","following_url":"https://api.github.com/users/den-crane/following{/other_user}","gists_url":"https://api.github.com/users/den-crane/gists{/gist_id}","starred_url":"https://api.github.com/users/den-crane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/den-crane/subscriptions","organizations_url":"https://api.github.com/users/den-crane/orgs","repos_url":"https://api.github.com/users/den-crane/repos","events_url":"https://api.github.com/users/den-crane/events{/privacy}","received_events_url":"https://api.github.com/users/den-crane/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1334071168,"node_id":"MDU6TGFiZWwxMzM0MDcxMTY4","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-kafka","name":"comp-kafka","color":"b5bcff","default":false,"description":"Kafka Engine"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-08-18T18:35:45Z","updated_at":"2020-11-06T17:34:24Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"detach/attach MV does not solve a problem of not missing/loosing messages in case of multiple MV.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6533/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6533/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6504","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6504/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6504/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6504/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6504","id":480979492,"node_id":"MDU6SXNzdWU0ODA5Nzk0OTI=","number":6504,"title":"HDFS file use parquet format,when I query clickhouse make error ","user":{"login":"jetliu1711","id":40588644,"node_id":"MDQ6VXNlcjQwNTg4NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/40588644?v=4","gravatar_id":"","url":"https://api.github.com/users/jetliu1711","html_url":"https://github.com/jetliu1711","followers_url":"https://api.github.com/users/jetliu1711/followers","following_url":"https://api.github.com/users/jetliu1711/following{/other_user}","gists_url":"https://api.github.com/users/jetliu1711/gists{/gist_id}","starred_url":"https://api.github.com/users/jetliu1711/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jetliu1711/subscriptions","organizations_url":"https://api.github.com/users/jetliu1711/orgs","repos_url":"https://api.github.com/users/jetliu1711/repos","events_url":"https://api.github.com/users/jetliu1711/events{/privacy}","received_events_url":"https://api.github.com/users/jetliu1711/received_events","type":"User","site_admin":false},"labels":[{"id":1365689344,"node_id":"MDU6TGFiZWwxMzY1Njg5MzQ0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-foreign-db","name":"comp-foreign-db","color":"b5bcff","default":false,"description":"Integrations with other databases"},{"id":1397894054,"node_id":"MDU6TGFiZWwxMzk3ODk0MDU0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/unfinished%20code","name":"unfinished code","color":"ff8800","default":false,"description":""},{"id":2192299304,"node_id":"MDU6TGFiZWwyMTkyMjk5MzA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-hdfs","name":"comp-hdfs","color":"b5bcff","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-08-15T03:35:37Z","updated_at":"2022-01-26T07:05:20Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"my hive table stored as parquet format.clickhouse table like this:\r\nCREATE  TABLE IF NOT EXISTS test(\r\n pay_time String ,\r\n cust_id String \r\n )ENGINE=HDFS('hdfs://10.5.120.12:9000/user/hive/warehouse/dw_tmp.db/test/trans_date=2019-08-01/000000_0', 'Parquet');\r\n\r\nbut I exxcute this sql \"select * from test limit 10;\" have a error:\r\nReceived exception from server (version 19.13.1):\r\nCode: 210. DB::Exception: Received from bi.dt.27:9000. DB::Exception: Fail to read HDFS file: hdfs://master:9000/user/hive/warehouse/dw_tmp.db/test/trans_date=2019-08-01/000000_0 HdfsIOException: InputStreamImpl: cannot read file: /user/hive/warehouse/dw_tmp.db/test/trans_date=2019-08-01/000000_0, from position 0, size: 1048576.   Caused by: HdfsIOException: InputStreamImpl: all nodes have been tried and no valid replica can be read for Block: [block pool ID: BP-1966204390-10.10.6.227-1469108237793 block ID 3469728620_2406979839].         Caused by: HdfsIOException: RemoteBlockReader does not support CRC32 checksum, Block: [block pool ID: BP-1966204390-10.10.6.227-1469108237793 block ID 3469728620_2406979839], from Datanode: h30151(10.10.6.227). \r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6504/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6498","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6498/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6498/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6498/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6498","id":480844347,"node_id":"MDU6SXNzdWU0ODA4NDQzNDc=","number":6498,"title":"Add `removeGarbageParametersFromURL` function","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1365579236,"node_id":"MDU6TGFiZWwxMzY1NTc5MjM2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/minor","name":"minor","color":"FFF8F8","default":false,"description":"Priority: minor"},{"id":3086255531,"node_id":"MDU6TGFiZWwzMDg2MjU1NTMx","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/warmup%20task","name":"warmup task","color":"FBCA04","default":false,"description":"The task for new ClickHouse team members. Low risk, moderate complexity, no urgency."}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-08-14T19:16:13Z","updated_at":"2021-07-03T20:42:23Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"**Use case**\r\nRemove long base64 and hex encoded paramters that look random. Example:\r\n\r\n`http://yandex.ru/clck/jsredir?from=yandex.ru;search%2F;web;;&text=&etext=1004&cst=AiuY0DBWFJ5Hyx_fyvalFPA3abBqdnSOApSiLPWwVkIeiz46AroRCQXrfJ8M5oYTWorWEWccK4Kw_QEhSDD6X4nGMT4OabEk0xnry4NtnOEzWFPU4iTzunSVVjkuY7CYolnD7hb04cMRv7iMnaO8LjNm0hxqvwN9sXCzUYeXp_muLsdY4W99_U5MJKGmz7IAmR5-ceoAoaBB2XGYAS9BTYKbbvlmneBpbf_SwAd_6OOACXtLmRXqXad3AQbcArYE8LCO0zmE9vpha3yoT0jl8pd9CUmbGZR5nA3sf5TcDFTpr5nYaOdxjmHep2cZeW3QHvPtKA2xWXW6qzGrQeZ1SEOPcJ1afJqmAHisup90hhNYyl2hxl8xn_DtCRbJqYHb88JtuQ3591EGW42wPZhSbxBFdU0KIZN3c_VZOmk6avzKzqG_kJpjPObWXbh9qs0S23WxDGCcPUrIzi3ESSLv1qgaRhqkfjBc57BFVA4RxlljpKQdeVeTbklJgqptznf1aHZQ2wYARBzC_jvv994MCTZIus_NctCMWoSaU74OaMmo0h5ScYLI2CWy6nj5PbhCrgeLsaEBVOQT9xoLSoCRfJ78xI_T1ruuD3QBJmHY6YW8f5UM36LRbzhd5vmNTPRvrs2wcCFhF_w&l10n=ru&cts=1458904227333&mc=1.584962500721156`\r\n\r\nNote: these parameters are usually not \"garbage\" but they are impossible to decrypt and they will waste space on disk. We are already removing these parameters from Yandex, Google, etc. before inserting into ClickHouse.\r\n\r\n**Implementation**\r\nFor parameters of some minimal length, quickly calculate some statistics like:\r\n- does not contain symbols that are not in base64 or base64-for-URL;\r\n- distribution looks uniform.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6498/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6492","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6492/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6492/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6492/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6492","id":480725192,"node_id":"MDU6SXNzdWU0ODA3MjUxOTI=","number":6492,"title":"generate-documentation tool","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":521113272,"node_id":"MDU6TGFiZWw1MjExMTMyNzI=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/build","name":"build","color":"800000","default":false,"description":""}],"state":"open","locked":false,"assignee":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"assignees":[{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},{"login":"FArthur-cmd","id":58165623,"node_id":"MDQ6VXNlcjU4MTY1NjIz","avatar_url":"https://avatars.githubusercontent.com/u/58165623?v=4","gravatar_id":"","url":"https://api.github.com/users/FArthur-cmd","html_url":"https://github.com/FArthur-cmd","followers_url":"https://api.github.com/users/FArthur-cmd/followers","following_url":"https://api.github.com/users/FArthur-cmd/following{/other_user}","gists_url":"https://api.github.com/users/FArthur-cmd/gists{/gist_id}","starred_url":"https://api.github.com/users/FArthur-cmd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FArthur-cmd/subscriptions","organizations_url":"https://api.github.com/users/FArthur-cmd/orgs","repos_url":"https://api.github.com/users/FArthur-cmd/repos","events_url":"https://api.github.com/users/FArthur-cmd/events{/privacy}","received_events_url":"https://api.github.com/users/FArthur-cmd/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2019-08-14T14:51:08Z","updated_at":"2021-07-20T09:02:16Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"Add `clickhouse-generate-documentation` tool that will export structured documentation (e.g. Settings, MergeTreeSettings, ProfileEvents, CurrentMetrics) as a `.md` file.\r\n\r\nEnglish documentation will be synchronized with code to be one-to-one identical.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6492/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6476","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6476/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6476/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6476/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6476","id":480320291,"node_id":"MDU6SXNzdWU0ODAzMjAyOTE=","number":6476,"title":"Detect UTF-16 BOM in CSV/TSV/JSONEachRow input and process it accordingly.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"},{"id":1365579236,"node_id":"MDU6TGFiZWwxMzY1NTc5MjM2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/minor","name":"minor","color":"FFF8F8","default":false,"description":"Priority: minor"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-08-13T19:10:49Z","updated_at":"2020-01-14T19:11:12Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6476/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6357","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6357/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6357/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6357/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6357","id":477207265,"node_id":"MDU6SXNzdWU0NzcyMDcyNjU=","number":6357,"title":"Any roadmaps for improving distributed infrastructure?","user":{"login":"yingfeng","id":7248,"node_id":"MDQ6VXNlcjcyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7248?v=4","gravatar_id":"","url":"https://api.github.com/users/yingfeng","html_url":"https://github.com/yingfeng","followers_url":"https://api.github.com/users/yingfeng/followers","following_url":"https://api.github.com/users/yingfeng/following{/other_user}","gists_url":"https://api.github.com/users/yingfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/yingfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yingfeng/subscriptions","organizations_url":"https://api.github.com/users/yingfeng/orgs","repos_url":"https://api.github.com/users/yingfeng/repos","events_url":"https://api.github.com/users/yingfeng/events{/privacy}","received_events_url":"https://api.github.com/users/yingfeng/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1634829961,"node_id":"MDU6TGFiZWwxNjM0ODI5OTYx","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-distributed","name":"comp-distributed","color":"b5bcff","default":false,"description":"Distributed tables"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-08-06T07:07:00Z","updated_at":"2020-07-01T18:15:51Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Compared with the excellent performance of Clickhouse on single machine, the distributed infrastructure could be improved as well due to these issues:\r\n\r\n### Availability\r\nAlthough ReplicationMergetree provides the mechanism for high availability, it has some shortcomings: The burden of Zookeeper is too heavy, and could become the bottleneck if the write throughput is high, because too much data is written through ZK. Could such mechanism as replication state machine be used for replica management?\r\n\r\n### Rebalance\r\nClickhouse does not support auto rebalance right now, which makes it inconvenient for cluster's scaling up or scaling down, or fault tolerance, this is not friendly to operations. A simple idea is to have data partition managed by a seperate component to be able to be transfered across nodes automatically, just like Apache Doris, EventQL, or some NewSQL database as TiDB, Cockcroach have done.\r\n\r\n### Transactions\r\nGuarantee ACID is unnecessary for OLAP, however, there exist many situations where data durability is required, such as the so called `exactly once computing`. For example, if we need exactly once semantic exist within the ETL job which sinks data to Clickhouse, the transactional API is very useful to `end-to-end exactly once`, working together with such components as Flink or Kafka Transactional API. Similar OLAP solutions as Apache Doris has already supported such issue in its `stream load` feature.\r\n\r\n### Resource Isolation\r\nCorresponding feature could be seen at [Doris' site](https://doris.apache.org/).\r\n\r\nIt seems that if the pros of both Clickhouse and Doris could be combined, then there would be a `perfect` OLAP solution. Does there exist any roadmap for such evolution? ","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6357/reactions","total_count":9,"+1":9,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6357/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6349","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6349/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6349/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6349/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6349","id":476999847,"node_id":"MDU6SXNzdWU0NzY5OTk4NDc=","number":6349,"title":"prefer_localhost_replica usability","user":{"login":"nvartolomei","id":543193,"node_id":"MDQ6VXNlcjU0MzE5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/543193?v=4","gravatar_id":"","url":"https://api.github.com/users/nvartolomei","html_url":"https://github.com/nvartolomei","followers_url":"https://api.github.com/users/nvartolomei/followers","following_url":"https://api.github.com/users/nvartolomei/following{/other_user}","gists_url":"https://api.github.com/users/nvartolomei/gists{/gist_id}","starred_url":"https://api.github.com/users/nvartolomei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nvartolomei/subscriptions","organizations_url":"https://api.github.com/users/nvartolomei/orgs","repos_url":"https://api.github.com/users/nvartolomei/repos","events_url":"https://api.github.com/users/nvartolomei/events{/privacy}","received_events_url":"https://api.github.com/users/nvartolomei/received_events","type":"User","site_admin":false},"labels":[{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-08-05T18:34:31Z","updated_at":"2021-02-18T20:31:45Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"`prefer_localhost_replica` has a bit of a weird behaviour which makes it's usability questionable.\r\n\r\n* it is ignored if default database is set (https://github.com/ClickHouse/ClickHouse/blob/468089a4cd0fc5006ab88ee0dd7964657da65b77/src/Interpreters/Cluster.cpp#L33-L46)\r\n* second query is not logged in query_log which causes 2 minor issues:\r\n  * metrics for both distributed query and local queries are reported together\r\n  * query is sent with initial user limits instead of a the custom user set in cluster config which might have different limits\r\n* there is no consistent way to check if query is reading from a distributed table or from a local table:\r\n  * `QueryProcessingStage::WithMergeableState` check doesn't work when `distributed_group_by_no_merge` is enabled\r\n  * `ClientInfo::QueryKind::SECONDARY_QUERY` doesn't work as ClientInfo::QueryKind is not updated for \"local\" query\r\n\r\nRelates to https://github.com/yandex/ClickHouse/issues/5732, where I want to set a different max_execution_speed_bytes setting for \"leaf query\".","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6349/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6335","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6335/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6335/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6335/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6335","id":476744517,"node_id":"MDU6SXNzdWU0NzY3NDQ1MTc=","number":6335,"title":"Error DDL task .. contains current host in cluster , but there are no such cluster here","user":{"login":"astudnev","id":1385046,"node_id":"MDQ6VXNlcjEzODUwNDY=","avatar_url":"https://avatars.githubusercontent.com/u/1385046?v=4","gravatar_id":"","url":"https://api.github.com/users/astudnev","html_url":"https://github.com/astudnev","followers_url":"https://api.github.com/users/astudnev/followers","following_url":"https://api.github.com/users/astudnev/following{/other_user}","gists_url":"https://api.github.com/users/astudnev/gists{/gist_id}","starred_url":"https://api.github.com/users/astudnev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astudnev/subscriptions","organizations_url":"https://api.github.com/users/astudnev/orgs","repos_url":"https://api.github.com/users/astudnev/repos","events_url":"https://api.github.com/users/astudnev/events{/privacy}","received_events_url":"https://api.github.com/users/astudnev/received_events","type":"User","site_admin":false},"labels":[{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""},{"id":1401254412,"node_id":"MDU6TGFiZWwxNDAxMjU0NDEy","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-dddl","name":"comp-dddl","color":"b5bcff","default":false,"description":"Distributed DDL feature"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2019-08-05T09:13:27Z","updated_at":"2021-06-23T08:15:37Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"ClickHouse version 19.9.2.4\r\n\r\nAny DDL request ON CLUSTER, like:\r\n```\r\nCREATE DATABASE text ON CLUSTER archive_servers\r\n```\r\nResult in the error:\r\n```\r\nAn error occured before execution: Code: 371, e.displayText() = DB::Exception: DDL task query-0000001383 contains current host ch1:9000 in cluster archive_servers, but there are no such cluster here. (version 19.9.2.4 (official build))\r\n```\r\nHowever cluster is properly configured and listed in system table:\r\n```\r\nSELECT * FROM system.clusters\r\n\r\nSELECT * FROM system.clusters WHERE cluster='archive_servers'\r\n\r\nSELECT *\r\nFROM system.clusters \r\nWHERE cluster = 'archive_servers'\r\n\r\nâ”Œâ”€clusterâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€shard_numâ”€â”¬â”€shard_weightâ”€â”¬â”€replica_numâ”€â”¬â”€host_nameâ”€â”¬â”€host_addressâ”€â”¬â”€portâ”€â”¬â”€is_localâ”€â”¬â”€userâ”€â”€â”€â”€â”¬â”€default_databaseâ”€â”\r\nâ”‚ archive_servers â”‚         1 â”‚            1 â”‚           1 â”‚ ch1       â”‚ 172.16.20.2  â”‚ 9000 â”‚        1 â”‚ default â”‚                  â”‚\r\nâ”‚ archive_servers â”‚         1 â”‚            1 â”‚           2 â”‚ ch2       â”‚ 172.16.21.2  â”‚ 9000 â”‚        1 â”‚ default â”‚                  â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n2 rows in set. Elapsed: 0.001 sec. \r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6335/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6318","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6318/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6318/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6318/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6318","id":476539463,"node_id":"MDU6SXNzdWU0NzY1Mzk0NjM=","number":6318,"title":"Support memory only mode for StorageJoin","user":{"login":"zombiemonkey","id":1689537,"node_id":"MDQ6VXNlcjE2ODk1Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1689537?v=4","gravatar_id":"","url":"https://api.github.com/users/zombiemonkey","html_url":"https://github.com/zombiemonkey","followers_url":"https://api.github.com/users/zombiemonkey/followers","following_url":"https://api.github.com/users/zombiemonkey/following{/other_user}","gists_url":"https://api.github.com/users/zombiemonkey/gists{/gist_id}","starred_url":"https://api.github.com/users/zombiemonkey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zombiemonkey/subscriptions","organizations_url":"https://api.github.com/users/zombiemonkey/orgs","repos_url":"https://api.github.com/users/zombiemonkey/repos","events_url":"https://api.github.com/users/zombiemonkey/events{/privacy}","received_events_url":"https://api.github.com/users/zombiemonkey/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-04T10:45:31Z","updated_at":"2019-12-09T23:28:17Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Is it possible to add a memory only mode or temporary table option for StorageJoin?\r\n\r\nBackground - I'm using StorageJoin in a soon to be released Open Source project and the performance is excellent for constructing matrices and vectors of identical length as arrays and use them as temporary inputs into real tables. If I can avoid the overhead of writing to disk for StorageJoin I could save some IO.\r\n\r\nThanks,\r\n\r\nZ","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6318/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6300","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6300/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6300/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6300/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6300","id":476277263,"node_id":"MDU6SXNzdWU0NzYyNzcyNjM=","number":6300,"title":"How to query data with incremental update?","user":{"login":"q0987","id":16629186,"node_id":"MDQ6VXNlcjE2NjI5MTg2","avatar_url":"https://avatars.githubusercontent.com/u/16629186?v=4","gravatar_id":"","url":"https://api.github.com/users/q0987","html_url":"https://github.com/q0987","followers_url":"https://api.github.com/users/q0987/followers","following_url":"https://api.github.com/users/q0987/following{/other_user}","gists_url":"https://api.github.com/users/q0987/gists{/gist_id}","starred_url":"https://api.github.com/users/q0987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/q0987/subscriptions","organizations_url":"https://api.github.com/users/q0987/orgs","repos_url":"https://api.github.com/users/q0987/repos","events_url":"https://api.github.com/users/q0987/events{/privacy}","received_events_url":"https://api.github.com/users/q0987/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-08-02T17:12:16Z","updated_at":"2020-07-01T18:21:14Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Assume that I insert row data into ClickHouseDB with an increasing timestamp.\r\n\r\nQuestion> Does ClickHouseDB offer a function so I can query the newly inserted rows?\r\n\r\nUse case:\r\n\r\n1> DB has 10 rows of data\r\n2> Client connects to DB, query the DB and get all 10 rows of data\r\n3> insert 5 more rows to DB\r\n4> Client was notified or Client makes another query, the DB ONLY returns the 5 newly inserted data.\r\n\r\nThank you","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6300/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6294","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6294/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6294/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6294/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6294","id":476138512,"node_id":"MDU6SXNzdWU0NzYxMzg1MTI=","number":6294,"title":"HTTP Server-Sent Events","user":{"login":"filimonov","id":1549571,"node_id":"MDQ6VXNlcjE1NDk1NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1549571?v=4","gravatar_id":"","url":"https://api.github.com/users/filimonov","html_url":"https://github.com/filimonov","followers_url":"https://api.github.com/users/filimonov/followers","following_url":"https://api.github.com/users/filimonov/following{/other_user}","gists_url":"https://api.github.com/users/filimonov/gists{/gist_id}","starred_url":"https://api.github.com/users/filimonov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/filimonov/subscriptions","organizations_url":"https://api.github.com/users/filimonov/orgs","repos_url":"https://api.github.com/users/filimonov/repos","events_url":"https://api.github.com/users/filimonov/events{/privacy}","received_events_url":"https://api.github.com/users/filimonov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1481327553,"node_id":"MDU6TGFiZWwxNDgxMzI3NTUz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-http","name":"comp-http","color":"b5bcff","default":false,"description":"http protocol related"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-08-02T11:42:19Z","updated_at":"2021-12-05T20:39:53Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"Currenly with HTTP you can't get a lot of ClickHouse-protocol features.\r\n1) Progress - is  avaliable but most of http clients doesn't support 'streaming' way of reading of http-header, after response is started you can't follow the progress anymore\r\n2) Final stats & proper error reporting require server-side caching\r\n3) server log - are not available\r\n\r\nIn general the problem is that HTTP protocol itself doesn't support multiplexing. I.e. if you need to send 2 stream - one with data, second with (let's say) logs - you can't mix them in one standard http response.\r\n\r\nBut there is a nice and easy to implement alternative, supported by [most of browsers](https://caniuse.com/#feat=eventsource), and which can be easily implemented by any client driver, it is called  HTTP Server-Sent Events.\r\n\r\nThe description:\r\nhttps://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events \r\n\r\nW3C standard:\r\nhttps://www.w3.org/TR/2015/REC-eventsource-20150203/\r\n\r\nHow the data looks like in  HTTP Server-Sent Events: \r\n```\r\nContent-Type: text/event-stream\r\n\r\nevent: summary\r\ndata: I plan to send\r\n\r\nevent: progress\r\ndata: 0\r\n\r\ndata: 0;0;0\r\n\r\nevent: progress\r\ndata: 1\r\n\r\ndata: 1;1;1\r\n\r\n...\r\n\r\nevent: progress\r\ndata: 10\r\n\r\ndata: 10;10;10\r\n\r\nevent: summary\r\ndata: 10 rows were send!\r\n```\r\nImplementation of something like that looks quite simple. \r\n\r\nIt has a huge advantage that it is a standard, overhead is quite small (at the beginning of data `data: ` prefix should appear, and also every newline in data should be replaced with `data: `). \r\n\r\nSimple POC in browser: https://desolate-fjord-49987.herokuapp.com/\r\n\r\nIt's much simpler than websockets and it looks like it will allow to build much more advanced and smart http clients. \r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6294/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6294/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6275","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6275/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6275/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6275/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6275","id":475765421,"node_id":"MDU6SXNzdWU0NzU3NjU0MjE=","number":6275,"title":"Materialized view use at least 5 times more memory than when i'm doing the aggregation manually ","user":{"login":"TH-HA","id":38243024,"node_id":"MDQ6VXNlcjM4MjQzMDI0","avatar_url":"https://avatars.githubusercontent.com/u/38243024?v=4","gravatar_id":"","url":"https://api.github.com/users/TH-HA","html_url":"https://github.com/TH-HA","followers_url":"https://api.github.com/users/TH-HA/followers","following_url":"https://api.github.com/users/TH-HA/following{/other_user}","gists_url":"https://api.github.com/users/TH-HA/gists{/gist_id}","starred_url":"https://api.github.com/users/TH-HA/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TH-HA/subscriptions","organizations_url":"https://api.github.com/users/TH-HA/orgs","repos_url":"https://api.github.com/users/TH-HA/repos","events_url":"https://api.github.com/users/TH-HA/events{/privacy}","received_events_url":"https://api.github.com/users/TH-HA/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""},{"id":1350221495,"node_id":"MDU6TGFiZWwxMzUwMjIxNDk1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-matview","name":"comp-matview","color":"b5bcff","default":false,"description":"Materialized views"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-08-01T16:00:59Z","updated_at":"2020-07-01T18:10:55Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hello clickhouse team\r\nI 'm trying to use a Materialized view with an aggregating mergetree to aggregate data automatically when they are inserted. \r\nThe chain is very simple \r\n  insertion table is either a mergetree or a null engine ( both lead to the same result ) \r\n  The aggregating merge tree is define idependantly \r\n  and a MV  is added on the top to feed the aggregating merge tree with the result of an aggregation.\r\n  \r\nbatch size are large ( 500 000 thousand rows ) , the result of the aggregation is very small: 280 rows. The table is pretty large ( 320 columns ).\r\nThe aggregation is also pretty simple mostly sum with a group by with access to a dictionary.\r\n\r\nMy issue is the following : \r\n   when i'm doing thing manually \r\n        insert into insertion table then do an insert into <aggregation table> select <aggregation request> \r\n         The queries use less than 1GB of memory.\r\n   When i'm using the materialized view to do the same thing \r\n          I'm reaching memory limit ( setup to 10GB / default value ) \r\n\t\r\nSo basically , what i'm seeing is a memory consumption at least 5 times higher when i'm using materialized view.\r\n\r\nIs there any parameters to reduce this memory usage ? \r\nHow can i troublehsoot this as clickhouse is hidding MV mechanism and we cannot see the split between initial insertion request , aggregating request and insertion in the aggregating merge tree.\r\n\r\nI'm using version 19.11.4.2 ( but the problem was also visibile in 19.5.X) with a single node. \r\n\r\n\r\nThanks in advance ","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6275/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6275/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6272","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6272/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6272/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6272/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6272","id":475698899,"node_id":"MDU6SXNzdWU0NzU2OTg4OTk=","number":6272,"title":"Return HTTP API errors in JSON format with \"Accept: application/json\" header","user":{"login":"a-rodin","id":1885277,"node_id":"MDQ6VXNlcjE4ODUyNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1885277?v=4","gravatar_id":"","url":"https://api.github.com/users/a-rodin","html_url":"https://github.com/a-rodin","followers_url":"https://api.github.com/users/a-rodin/followers","following_url":"https://api.github.com/users/a-rodin/following{/other_user}","gists_url":"https://api.github.com/users/a-rodin/gists{/gist_id}","starred_url":"https://api.github.com/users/a-rodin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a-rodin/subscriptions","organizations_url":"https://api.github.com/users/a-rodin/orgs","repos_url":"https://api.github.com/users/a-rodin/repos","events_url":"https://api.github.com/users/a-rodin/events{/privacy}","received_events_url":"https://api.github.com/users/a-rodin/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1481327553,"node_id":"MDU6TGFiZWwxNDgxMzI3NTUz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-http","name":"comp-http","color":"b5bcff","default":false,"description":"http protocol related"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-08-01T13:56:56Z","updated_at":"2020-07-01T18:16:25Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Currently HTTP API returns errors as plain text:\r\n\r\n```sh\r\n$ curl -i 'localhost:8123/?query=SELECT%20*%20FROM%20not_existing'\r\nHTTP/1.1 404 Not Found\r\nDate: Thu, 01 Aug 2019 13:48:40 GMT\r\nConnection: Keep-Alive\r\nContent-Type: text/plain; charset=UTF-8\r\nX-ClickHouse-Server-Display-Name: 6a1d1ae7d34a\r\nTransfer-Encoding: chunked\r\nKeep-Alive: timeout=3\r\nX-ClickHouse-Summary: {\"read_rows\":\"0\",\"read_bytes\":\"0\",\"written_rows\":\"0\",\"written_bytes\":\"0\",\"total_rows_to_read\":\"0\"}\r\n\r\nCode: 60, e.displayText() = DB::Exception: Table default.not_existing doesn't exist. (version 19.11.4.24 (official build))\r\n```\r\n\r\nThe format of the errors can't be changed neither by adding `Accept` header nor by using `FORMAT` clause in the query.\r\n\r\nIt would be nice to have an ability to get errors in a more machine-readable format, such as JSON, by sending `Accept: application/json` HTTP header.\r\n\r\nFor example,\r\n\r\n```sh\r\ncurl 'localhost:8123/?query=SELECT%20*%20FROM%20not_existing' -H 'Accept: application/json'\r\n```\r\n\r\ncould have returned\r\n\r\n```json\r\n{                       \r\n  \"error\": {                       \r\n    \"code\": 60,                       \r\n    \"text\": \"Table default.not_existing doesn't exist\",                       \r\n    \"version\": \"19.11.4.24 (official build)\"                       \r\n  }                       \r\n}                       \r\n```\r\n\r\nAn alternative would be to use `FORMAT` clause for specifying errors format too, but in that case it would not be possible to specify format for errors in `INSERT` queries.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6272/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6272/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6267","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6267/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6267/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6267/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6267","id":475632617,"node_id":"MDU6SXNzdWU0NzU2MzI2MTc=","number":6267,"title":"reduce zookeeper znode number by compacting znodes to less batch znodes","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1401894928,"node_id":"MDU6TGFiZWwxNDAxODk0OTI4","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-zookeeper","name":"comp-zookeeper","color":"b5bcff","default":false,"description":"Zookeeper"},{"id":1478073551,"node_id":"MDU6TGFiZWwxNDc4MDczNTUx","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-replication","name":"comp-replication","color":"b5bcff","default":false,"description":"Replicated tables"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-01T11:37:21Z","updated_at":"2020-06-19T08:00:40Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Use case**\r\nI'm going to store tables partitioned by yyyyMMdd in clickhouse, and when evaluating how is clickhouse using zookeeper, I found there can be too many znodes.\r\nthese zk paths are part related:\r\n/clickhouse/tables/01/ontime/blocks\r\n/clickhouse/tables/01/ontime/block_numbers\r\n/clickhouse/tables/01/ontime/replicas/01/parts\r\n\r\nWhen there are 300 tables(20 shards and 2 replicas) and the partition expression is yyyyMMdd type, each table ttl is 1 year, then we get 20 * 300 * 365 +  20 * 300 * 365 + 20 * 2 * 300 * 365  * 2 + = 13,140,000 znodes, 130million znodes when 200 shards!\r\n#2666 is about the same issue\r\n\r\n**Describe the solution you'd like**\r\nConsidering part/block is not that frequently added/updated/deleted, combine small part related znodes to a batched larger znode(compressed or uncompressed) with a list of part info inside like\r\nhttps://github.com/apache/incubator-druid/blob/f0ecdfee30853535e4bfbbfc4f769ccd12d0694a/server/src/main/java/org/apache/druid/server/coordination/BatchDataSegmentAnnouncer.java#L245 can significantly reduce znode number\r\n\r\nLong long time ago, druid was facing the same too many znodes issue and BatchDataSegmentAnnouncer was added to change 1 znode per segment to 1 znode many segments(1 or more than 1 segments, depends on the znode bytes size)\r\n\r\nI think the druid example is helpful to resolve this issue in clickhouse\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6267/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6216","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6216/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6216/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6216/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6216","id":474537804,"node_id":"MDU6SXNzdWU0NzQ1Mzc4MDQ=","number":6216,"title":"INTERVAL in milliseconds/float value for seconds","user":{"login":"BolshakovNO","id":8124213,"node_id":"MDQ6VXNlcjgxMjQyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/8124213?v=4","gravatar_id":"","url":"https://api.github.com/users/BolshakovNO","html_url":"https://github.com/BolshakovNO","followers_url":"https://api.github.com/users/BolshakovNO/followers","following_url":"https://api.github.com/users/BolshakovNO/following{/other_user}","gists_url":"https://api.github.com/users/BolshakovNO/gists{/gist_id}","starred_url":"https://api.github.com/users/BolshakovNO/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BolshakovNO/subscriptions","organizations_url":"https://api.github.com/users/BolshakovNO/orgs","repos_url":"https://api.github.com/users/BolshakovNO/repos","events_url":"https://api.github.com/users/BolshakovNO/events{/privacy}","received_events_url":"https://api.github.com/users/BolshakovNO/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-07-30T11:47:54Z","updated_at":"2020-07-01T18:16:36Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"For example, i need to do that\r\n```\r\nSELECT\r\n    toStartOfInterval(\r\n        arrayJoin(\r\n            timeSlots(\r\n                toDateTime(start),\r\n                toUInt32(range),\r\n                toFloat32(interval)\r\n            )\r\n        ),\r\n        INTERVAL toFloat32(interval) second\r\n    )\r\n```\r\nOf course i get `INTERVAL toFloat32(0.2) second` = `0`\r\nAnd minimum time unit is `second`\r\n\r\nIs it possible to add?\r\n* millisecond unit\r\n* (or) float value for second\r\n* And also available third argument of type Float32 for `timeSlots` function.\r\n\r\nThank you.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6216/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6184","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6184/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6184/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6184/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6184","id":473589789,"node_id":"MDU6SXNzdWU0NzM1ODk3ODk=","number":6184,"title":"sas7bdat format support to read SAS datasets","user":{"login":"alanpaulkwan","id":8321252,"node_id":"MDQ6VXNlcjgzMjEyNTI=","avatar_url":"https://avatars.githubusercontent.com/u/8321252?v=4","gravatar_id":"","url":"https://api.github.com/users/alanpaulkwan","html_url":"https://github.com/alanpaulkwan","followers_url":"https://api.github.com/users/alanpaulkwan/followers","following_url":"https://api.github.com/users/alanpaulkwan/following{/other_user}","gists_url":"https://api.github.com/users/alanpaulkwan/gists{/gist_id}","starred_url":"https://api.github.com/users/alanpaulkwan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alanpaulkwan/subscriptions","organizations_url":"https://api.github.com/users/alanpaulkwan/orgs","repos_url":"https://api.github.com/users/alanpaulkwan/repos","events_url":"https://api.github.com/users/alanpaulkwan/events{/privacy}","received_events_url":"https://api.github.com/users/alanpaulkwan/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1401255404,"node_id":"MDU6TGFiZWwxNDAxMjU1NDA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-formats","name":"comp-formats","color":"b5bcff","default":false,"description":"Input / output formats"}],"state":"open","locked":false,"assignee":{"login":"Avogar","id":48961922,"node_id":"MDQ6VXNlcjQ4OTYxOTIy","avatar_url":"https://avatars.githubusercontent.com/u/48961922?v=4","gravatar_id":"","url":"https://api.github.com/users/Avogar","html_url":"https://github.com/Avogar","followers_url":"https://api.github.com/users/Avogar/followers","following_url":"https://api.github.com/users/Avogar/following{/other_user}","gists_url":"https://api.github.com/users/Avogar/gists{/gist_id}","starred_url":"https://api.github.com/users/Avogar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Avogar/subscriptions","organizations_url":"https://api.github.com/users/Avogar/orgs","repos_url":"https://api.github.com/users/Avogar/repos","events_url":"https://api.github.com/users/Avogar/events{/privacy}","received_events_url":"https://api.github.com/users/Avogar/received_events","type":"User","site_admin":false},"assignees":[{"login":"Avogar","id":48961922,"node_id":"MDQ6VXNlcjQ4OTYxOTIy","avatar_url":"https://avatars.githubusercontent.com/u/48961922?v=4","gravatar_id":"","url":"https://api.github.com/users/Avogar","html_url":"https://github.com/Avogar","followers_url":"https://api.github.com/users/Avogar/followers","following_url":"https://api.github.com/users/Avogar/following{/other_user}","gists_url":"https://api.github.com/users/Avogar/gists{/gist_id}","starred_url":"https://api.github.com/users/Avogar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Avogar/subscriptions","organizations_url":"https://api.github.com/users/Avogar/orgs","repos_url":"https://api.github.com/users/Avogar/repos","events_url":"https://api.github.com/users/Avogar/events{/privacy}","received_events_url":"https://api.github.com/users/Avogar/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-07-27T02:36:40Z","updated_at":"2022-01-26T12:46:04Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi Clickhouse Team,\r\n\r\nIvan suggested I deposit this suggestion here. My suggestion is to implement sas7bdat support. Lots of enterprise and academic datasets are stored in SAS format. Enterprise customers looking to migrate would need to convert SAS directly.\r\n\r\n**Suggestion** Similar to Parquet support, SAS support would be nice. It would be nice to not have to specify the file format similar to importing a CSV - e.g. I think SAS files are self-describing from which Clickhouse could generate a schema. I think the Java Parso library could help you get started implementing this.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6184/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6159","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6159/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6159/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6159/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6159","id":472980091,"node_id":"MDU6SXNzdWU0NzI5ODAwOTE=","number":6159,"title":"Update and delete","user":{"login":"Sundarcj","id":29049117,"node_id":"MDQ6VXNlcjI5MDQ5MTE3","avatar_url":"https://avatars.githubusercontent.com/u/29049117?v=4","gravatar_id":"","url":"https://api.github.com/users/Sundarcj","html_url":"https://github.com/Sundarcj","followers_url":"https://api.github.com/users/Sundarcj/followers","following_url":"https://api.github.com/users/Sundarcj/following{/other_user}","gists_url":"https://api.github.com/users/Sundarcj/gists{/gist_id}","starred_url":"https://api.github.com/users/Sundarcj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sundarcj/subscriptions","organizations_url":"https://api.github.com/users/Sundarcj/orgs","repos_url":"https://api.github.com/users/Sundarcj/repos","events_url":"https://api.github.com/users/Sundarcj/events{/privacy}","received_events_url":"https://api.github.com/users/Sundarcj/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-07-25T17:18:26Z","updated_at":"2021-01-18T23:42:07Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n   I am having a use case of processing trillions of records. where I can't predict what type of data we are about to process .. kind of data cleaning tool.so can I go with the distributed engine to utilize the parallel query processing.? or with single node?. I have the update operation also, for that I created another table that have two columns ```Unique_Id``` and boolean ```modified state``` so for delete operation I just mark relative unique id to false.  assume I have a ```unique_id ``` for rows. do join querys for following fetch request. Is that idea okay?? ","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6159/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6154","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6154/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6154/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6154/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6154","id":472923077,"node_id":"MDU6SXNzdWU0NzI5MjMwNzc=","number":6154,"title":"No parser error on wrong CREATE TABLE ... AS table","user":{"login":"4ertus2","id":8061274,"node_id":"MDQ6VXNlcjgwNjEyNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/8061274?v=4","gravatar_id":"","url":"https://api.github.com/users/4ertus2","html_url":"https://github.com/4ertus2","followers_url":"https://api.github.com/users/4ertus2/followers","following_url":"https://api.github.com/users/4ertus2/following{/other_user}","gists_url":"https://api.github.com/users/4ertus2/gists{/gist_id}","starred_url":"https://api.github.com/users/4ertus2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/4ertus2/subscriptions","organizations_url":"https://api.github.com/users/4ertus2/orgs","repos_url":"https://api.github.com/users/4ertus2/repos","events_url":"https://api.github.com/users/4ertus2/events{/privacy}","received_events_url":"https://api.github.com/users/4ertus2/received_events","type":"User","site_admin":false},"labels":[{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""},{"id":1365579236,"node_id":"MDU6TGFiZWwxMzY1NTc5MjM2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/minor","name":"minor","color":"FFF8F8","default":false,"description":"Priority: minor"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-07-25T15:12:15Z","updated_at":"2020-10-29T19:30:15Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"CREATE TABLE should fail if ```AS table``` present in wrong position.\r\n\r\n```\r\nCREATE TABLE src (x UInt32) ENGINE = Memory;\r\nCREATE TABLE dst1 AS src ENGINE = Memory; -- OK\r\nCREATE TABLE dst2 ENGINE = Memory AS src; -- OK but should fails\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6154/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6093","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6093/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6093/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6093/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6093","id":470786755,"node_id":"MDU6SXNzdWU0NzA3ODY3NTU=","number":6093,"title":"Misleading 'Timeout exceeded' for OPTIMIZE TABLE","user":{"login":"4ertus2","id":8061274,"node_id":"MDQ6VXNlcjgwNjEyNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/8061274?v=4","gravatar_id":"","url":"https://api.github.com/users/4ertus2","html_url":"https://github.com/4ertus2","followers_url":"https://api.github.com/users/4ertus2/followers","following_url":"https://api.github.com/users/4ertus2/following{/other_user}","gists_url":"https://api.github.com/users/4ertus2/gists{/gist_id}","starred_url":"https://api.github.com/users/4ertus2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/4ertus2/subscriptions","organizations_url":"https://api.github.com/users/4ertus2/orgs","repos_url":"https://api.github.com/users/4ertus2/repos","events_url":"https://api.github.com/users/4ertus2/events{/privacy}","received_events_url":"https://api.github.com/users/4ertus2/received_events","type":"User","site_admin":false},"labels":[{"id":386401507,"node_id":"MDU6TGFiZWwzODY0MDE1MDc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":845247686,"node_id":"MDU6TGFiZWw4NDUyNDc2ODY=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/usability","name":"usability","color":"ebf28c","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2019-07-21T14:19:18Z","updated_at":"2021-10-22T16:07:12Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"It's not clear what really happened here.\r\n19.11.3.11\r\n\r\n```\r\nOPTIMIZE TABLE <some_big_table> PARTITION 201902 FINAL\r\n\r\nTimeout exceeded while receiving data from server. Waited for 300 seconds, timeout is 300 seconds.\r\nCancelling query.\r\nOk.\r\nQuery was cancelled.\r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6093/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6079","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6079/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6079/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6079/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/6079","id":470440091,"node_id":"MDU6SXNzdWU0NzA0NDAwOTE=","number":6079,"title":"Allow to CREATE another replica of ReplicatedMergeTree table without specifying its structure.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-07-19T17:08:57Z","updated_at":"2021-07-03T22:50:54Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"**Use case**\r\n`CREATE TABLE t ENGINE = ReplicatedMergeTree(...)`\r\ninstead of\r\n`CREATE TABLE t (structure) ENGINE = ReplicatedMergeTree(...)`\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/6079/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5985","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5985/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5985/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5985/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5985","id":467164852,"node_id":"MDU6SXNzdWU0NjcxNjQ4NTI=","number":5985,"title":"Alter of nullable columns to not nullable is not supported","user":{"login":"den-crane","id":19737682,"node_id":"MDQ6VXNlcjE5NzM3Njgy","avatar_url":"https://avatars.githubusercontent.com/u/19737682?v=4","gravatar_id":"","url":"https://api.github.com/users/den-crane","html_url":"https://github.com/den-crane","followers_url":"https://api.github.com/users/den-crane/followers","following_url":"https://api.github.com/users/den-crane/following{/other_user}","gists_url":"https://api.github.com/users/den-crane/gists{/gist_id}","starred_url":"https://api.github.com/users/den-crane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/den-crane/subscriptions","organizations_url":"https://api.github.com/users/den-crane/orgs","repos_url":"https://api.github.com/users/den-crane/repos","events_url":"https://api.github.com/users/den-crane/events{/privacy}","received_events_url":"https://api.github.com/users/den-crane/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1634867650,"node_id":"MDU6TGFiZWwxNjM0ODY3NjUw","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-nullable","name":"comp-nullable","color":"b5bcff","default":false,"description":"Nulls related"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-07-12T00:31:19Z","updated_at":"2020-04-23T13:42:08Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"```\r\ncreate table XXX (x Nullable(String), y String) engine=MergeTree order by tuple();\r\ninsert into XXX (y) values ('a');\r\nselect * from XXX\r\nâ”Œâ”€xâ”€â”€â”€â”€â”¬â”€yâ”€â”\r\nâ”‚ á´ºáµá´¸á´¸ â”‚ a â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜\r\n\r\nALTER TABLE XXX MODIFY COLUMN x String;\r\nDB::Exception: Cannot convert NULL value to non-Nullable type.\r\n\r\nALTER TABLE XXX MODIFY COLUMN x String DEFAULT 'xxx';\r\nDB::Exception: Cannot convert NULL value to non-Nullable type.\r\n\r\nalter table XXX update x ='xxx' where 1;\r\nselect * from XXX\r\nâ”Œâ”€xâ”€â”€â”€â”¬â”€yâ”€â”\r\nâ”‚ xxx â”‚ a â”‚\r\nâ””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜\r\n\r\nALTER TABLE XXX MODIFY COLUMN x String;\r\nDB::Exception: Cannot convert NULL value to non-Nullable type\r\n\r\nThough,\r\n\r\ndrop table XXX;\r\ncreate table XXX (x Nullable(String), y String) engine=MergeTree order by tuple();\r\nALTER TABLE XXX MODIFY COLUMN x String DEFAULT 'xxx';\r\nOk.\r\nDESCRIBE TABLE XXX\r\n\r\nâ”Œâ”€nameâ”€â”¬â”€typeâ”€â”€â”€â”¬â”€default_typeâ”€â”¬â”€default_expressionâ”€â”¬â”€commentâ”€â”¬â”€codec_expressionâ”€â”¬â”€ttl_expressionâ”€â”\r\nâ”‚ x    â”‚ String â”‚ DEFAULT      â”‚ 'xxx'              â”‚         â”‚                  â”‚                â”‚\r\nâ”‚ y    â”‚ String â”‚              â”‚                    â”‚         â”‚                  â”‚                â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5985/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5985/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5952","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5952/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5952/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5952/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5952","id":465827391,"node_id":"MDU6SXNzdWU0NjU4MjczOTE=","number":5952,"title":"Lack of short-circuiting with enable_optimize_predicate_expression","user":{"login":"zlobober","id":1856442,"node_id":"MDQ6VXNlcjE4NTY0NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1856442?v=4","gravatar_id":"","url":"https://api.github.com/users/zlobober","html_url":"https://github.com/zlobober","followers_url":"https://api.github.com/users/zlobober/followers","following_url":"https://api.github.com/users/zlobober/following{/other_user}","gists_url":"https://api.github.com/users/zlobober/gists{/gist_id}","starred_url":"https://api.github.com/users/zlobober/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zlobober/subscriptions","organizations_url":"https://api.github.com/users/zlobober/orgs","repos_url":"https://api.github.com/users/zlobober/repos","events_url":"https://api.github.com/users/zlobober/events{/privacy}","received_events_url":"https://api.github.com/users/zlobober/received_events","type":"User","site_admin":false},"labels":[{"id":1401777979,"node_id":"MDU6TGFiZWwxNDAxNzc3OTc5","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-optimizers","name":"comp-optimizers","color":"b5bcff","default":false,"description":"Query optimizations"},{"id":1575085465,"node_id":"MDU6TGFiZWwxNTc1MDg1NDY1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/unexpected%20behaviour","name":"unexpected behaviour","color":"e088ca","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-07-09T14:51:53Z","updated_at":"2021-10-26T09:18:51Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Consider a select query of form:\r\n\r\n```\r\nSELECT * FROM (SELECT * FROM someTable WHERE PredX) WHERE PredY\r\n```\r\n\r\nSuppose that PredX looks like isNotNull(smth) and PredY uses smth under assumption that smth is not null; for example, PredY may rely on toDateTime(smth). \r\n\r\nIn this situation enable_optimize_predicate_expression will push the outer predicate into the inner select query, which will result in error during query evaluation as there is no short-circuiting and PredX will not prevent PredY from failing.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5952/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5917","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5917/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5917/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5917/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5917","id":464952916,"node_id":"MDU6SXNzdWU0NjQ5NTI5MTY=","number":5917,"title":"DISTINCT should be optimized for LowCardinality fields.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1446368065,"node_id":"MDU6TGFiZWwxNDQ2MzY4MDY1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-lowcardinality","name":"comp-lowcardinality","color":"b5bcff","default":false,"description":"LowCardinality data type"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-07-07T13:29:38Z","updated_at":"2020-01-14T19:08:23Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"LowCardinality works two times slower:\r\n```\r\n  38.10%  clickhouse                         [.] _ZN2DB24DistinctBlockInputStream8readImplEv\r\n  28.17%  clickhouse                         [.] _ZNK2DB12ColumnString19updateHashWithValueEmR7SipHash\r\n   3.90%  clickhouse                         [.] _ZNK2DB20ColumnLowCardinality19updateHashWithValueEmR7SipHash\r\n```\r\n\r\nPlain String field:\r\n```\r\n  33.56%  clickhouse                     [.] _ZN2DB24DistinctBlockInputStream8readImplEv\r\n  24.61%  clickhouse                     [.] _ZN2DBL21deserializeBinarySSE2ILi1EEEvRNS_8PODArrayIhLm4096E17AllocatorWithHintILb0EN14AllocatorHints11DefaultHintELm67108864EELm15ELm16EEERNS1_ImLm4096ES5_Lm15ELm16EEERNS_10ReadBufferEm\r\n  18.91%  clickhouse                     [.] _Z16memequalSSE2WidePKcS0_m\r\n ```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5917/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5917/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5912","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5912/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5912/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5912/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5912","id":464899097,"node_id":"MDU6SXNzdWU0NjQ4OTkwOTc=","number":5912,"title":"INSERT AND SELECT query (RFC)","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":644208617,"node_id":"MDU6TGFiZWw2NDQyMDg2MTc=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/easy%20task","name":"easy task","color":"0e8a16","default":false,"description":"Good for first contributors"},{"id":1365579236,"node_id":"MDU6TGFiZWwxMzY1NTc5MjM2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/minor","name":"minor","color":"FFF8F8","default":false,"description":"Priority: minor"},{"id":1507886722,"node_id":"MDU6TGFiZWwxNTA3ODg2NzIy","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-discussion","name":"st-discussion","color":"e5b890","default":false,"description":"The story requires discussion /research / expert help / design & decomposition before will be taken"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-07-06T23:38:12Z","updated_at":"2020-06-26T20:34:46Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"Do INSERT SELECT and output results of SELECT to user (`tee`).","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5912/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5895","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5895/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5895/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5895/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5895","id":464678934,"node_id":"MDU6SXNzdWU0NjQ2Nzg5MzQ=","number":5895,"title":"Transform OR LIKE chain to multiSearchAny or multiMatchAny.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-07-05T15:01:38Z","updated_at":"2020-06-26T20:35:11Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"**Use case**\r\n`Params LIKE '%testid_145997%' OR Params LIKE '%testid_146118%' OR Params LIKE '%testid_146119%'`\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5895/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5888","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5888/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5888/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5888/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5888","id":464633534,"node_id":"MDU6SXNzdWU0NjQ2MzM1MzQ=","number":5888,"title":"Consistent error messages when validating function arguments","user":{"login":"alex-krash","id":5325438,"node_id":"MDQ6VXNlcjUzMjU0Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/5325438?v=4","gravatar_id":"","url":"https://api.github.com/users/alex-krash","html_url":"https://github.com/alex-krash","followers_url":"https://api.github.com/users/alex-krash/followers","following_url":"https://api.github.com/users/alex-krash/following{/other_user}","gists_url":"https://api.github.com/users/alex-krash/gists{/gist_id}","starred_url":"https://api.github.com/users/alex-krash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alex-krash/subscriptions","organizations_url":"https://api.github.com/users/alex-krash/orgs","repos_url":"https://api.github.com/users/alex-krash/repos","events_url":"https://api.github.com/users/alex-krash/events{/privacy}","received_events_url":"https://api.github.com/users/alex-krash/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"assignees":[{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-07-05T13:08:32Z","updated_at":"2019-07-08T13:55:00Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Current situation**\r\nCurrently, SQL functions performs validation of given arguments inside their body. During validation, there are common error situations (illegal types of arguments, number of arguments does not match, etc.). Currently, error messages for such cases are formed in each function separately, and it has following circumstances:\r\n\r\n1. In each function implementation file, we are adding section ErrorCodes with code constants\r\n2. Copy-pasted creation of exception messages (toString(xxx), etc)\r\n3. Messages sometimes drops useful context (position of argument, given type and expected type)\r\n\r\n**Proposal**\r\nI propose to unify messages for arguments validation, in following manner:\r\nWrong number of variadic arguments\r\n`Function {function_name} expects {start} - {end} arguments, {given_number_of_arguments} given`\r\nVariadic function called without arguments\r\n`Function {function_name} expects at least one argument, but none given`\r\nToo much arguments for variadic function\r\n`Function {function_name} expects at most {max_arguments}, but {given_count} given`\r\n\r\nValidating types of arguments:\r\n```\r\nIllegal type {given_type} of {position} argument for function {function_name}\r\nIllegal type {given_type} of {position} argument for function {function_name} - must be {expected_type}\r\nIllegal type {given_type} of {position} argument for function {function_name} - must be {expected_type1} or {expected_type2} or {expected_type3}\r\n```\r\n(within implementation, {position} can be human-friendly for first 9 positions:\r\n`Illegal type UInt16 of third argument for function multiIf`)\r\n\r\n**Describe the solution you'd like**\r\nFrom my point of view, it would be good to implement several DB::Exception sub-classes with appropriate constructors. Constructor will accept DB::IFunction instance as first argument, and rest arguments, needed to form error-message. On top of that, sub-class will always have it's error-code, so no need to import it explicitly in function implementation file. \r\n\r\n**Describe alternatives you've considered**\r\nIf solution with exception sub-classes is not suitable, than we may, at least move creation of error messages into specific static functions in some helper.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5888/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5843","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5843/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5843/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5843/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5843","id":463520933,"node_id":"MDU6SXNzdWU0NjM1MjA5MzM=","number":5843,"title":"Enum values not being validated when using binary protocol","user":{"login":"nvartolomei","id":543193,"node_id":"MDQ6VXNlcjU0MzE5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/543193?v=4","gravatar_id":"","url":"https://api.github.com/users/nvartolomei","html_url":"https://github.com/nvartolomei","followers_url":"https://api.github.com/users/nvartolomei/followers","following_url":"https://api.github.com/users/nvartolomei/following{/other_user}","gists_url":"https://api.github.com/users/nvartolomei/gists{/gist_id}","starred_url":"https://api.github.com/users/nvartolomei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nvartolomei/subscriptions","organizations_url":"https://api.github.com/users/nvartolomei/orgs","repos_url":"https://api.github.com/users/nvartolomei/repos","events_url":"https://api.github.com/users/nvartolomei/events{/privacy}","received_events_url":"https://api.github.com/users/nvartolomei/received_events","type":"User","site_admin":false},"labels":[{"id":386401508,"node_id":"MDU6TGFiZWwzODY0MDE1MDg=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/help%20wanted","name":"help wanted","color":"128A0C","default":true,"description":null},{"id":1575085465,"node_id":"MDU6TGFiZWwxNTc1MDg1NDY1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/unexpected%20behaviour","name":"unexpected behaviour","color":"e088ca","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-07-03T03:04:56Z","updated_at":"2020-06-27T20:26:57Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"```sql\r\nCREATE TABLE t\r\n(\r\n    `a` Enum8('a' = 1)\r\n)\r\nENGINE = Memory;\r\n\r\nINSERT INTO t SELECT 2;\r\n\r\nSELECT *\r\nFROM t; -- Code: 49. DB::Exception: Unexpected value 2 for type Enum8('a' = 1)\r\n```\r\n\r\nWhy is this even allowed?","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5843/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5799","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5799/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5799/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5799/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5799","id":462307540,"node_id":"MDU6SXNzdWU0NjIzMDc1NDA=","number":5799,"title":"toIPv6(x) doesn't work the same way as CAST(x AS IPv6)","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":1019683656,"node_id":"MDU6TGFiZWwxMDE5NjgzNjU2","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/altinity","name":"altinity","color":"c0f5f9","default":false,"description":""},{"id":1397894054,"node_id":"MDU6TGFiZWwxMzk3ODk0MDU0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/unfinished%20code","name":"unfinished code","color":"ff8800","default":false,"description":""}],"state":"open","locked":false,"assignee":{"login":"Enmk","id":1110183,"node_id":"MDQ6VXNlcjExMTAxODM=","avatar_url":"https://avatars.githubusercontent.com/u/1110183?v=4","gravatar_id":"","url":"https://api.github.com/users/Enmk","html_url":"https://github.com/Enmk","followers_url":"https://api.github.com/users/Enmk/followers","following_url":"https://api.github.com/users/Enmk/following{/other_user}","gists_url":"https://api.github.com/users/Enmk/gists{/gist_id}","starred_url":"https://api.github.com/users/Enmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Enmk/subscriptions","organizations_url":"https://api.github.com/users/Enmk/orgs","repos_url":"https://api.github.com/users/Enmk/repos","events_url":"https://api.github.com/users/Enmk/events{/privacy}","received_events_url":"https://api.github.com/users/Enmk/received_events","type":"User","site_admin":false},"assignees":[{"login":"Enmk","id":1110183,"node_id":"MDQ6VXNlcjExMTAxODM=","avatar_url":"https://avatars.githubusercontent.com/u/1110183?v=4","gravatar_id":"","url":"https://api.github.com/users/Enmk","html_url":"https://github.com/Enmk","followers_url":"https://api.github.com/users/Enmk/followers","following_url":"https://api.github.com/users/Enmk/following{/other_user}","gists_url":"https://api.github.com/users/Enmk/gists{/gist_id}","starred_url":"https://api.github.com/users/Enmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Enmk/subscriptions","organizations_url":"https://api.github.com/users/Enmk/orgs","repos_url":"https://api.github.com/users/Enmk/repos","events_url":"https://api.github.com/users/Enmk/events{/privacy}","received_events_url":"https://api.github.com/users/Enmk/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-06-29T14:26:49Z","updated_at":"2020-07-06T18:59:16Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"```\r\n:) select toIPv6(IPv6StringToNum('::1bc0')) format JSON\r\n\r\nSELECT toIPv6(IPv6StringToNum('::1bc0'))\r\nFORMAT JSON\r\n\r\nReceived exception from server (version 19.11.0):\r\nCode: 43. DB::Exception: Received from localhost:9000, ::1. DB::Exception: Illegal type FixedString(16) of argument of function toIPv6. \r\n\r\n0 rows in set. Elapsed: 0.088 sec. \r\n\r\n:) select toIPv6('::1bc0') format JSON                 \r\n\r\nSELECT toIPv6('::1bc0')\r\nFORMAT JSON\r\n\r\n{\r\n        \"meta\":\r\n        [\r\n                {\r\n                        \"name\": \"toIPv6('::1bc0')\",\r\n                        \"type\": \"IPv6\"\r\n                }\r\n        ],\r\n\r\n        \"data\":\r\n        [\r\n                {\r\n                        \"toIPv6('::1bc0')\": \"::1bc0\"\r\n                }\r\n        ],\r\n\r\n        \"rows\": 1,\r\n\r\n        \"statistics\":\r\n        {\r\n                \"elapsed\": 0.000128767,\r\n                \"rows_read\": 1,\r\n                \"bytes_read\": 1\r\n        }\r\n}\r\n\r\n1 rows in set. Elapsed: 0.001 sec. \r\n\r\n:) select CAST(IPv6StringToNum('::1bc0') AS IPv6) format JSON\r\n\r\nSELECT CAST(IPv6StringToNum('::1bc0'), 'IPv6')\r\nFORMAT JSON\r\n\r\n{\r\n        \"meta\":\r\n        [\r\n                {\r\n                        \"name\": \"CAST(IPv6StringToNum('::1bc0'), 'IPv6')\",\r\n                        \"type\": \"IPv6\"\r\n                }\r\n        ],\r\n\r\n        \"data\":\r\n        [\r\n                {\r\n                        \"CAST(IPv6StringToNum('::1bc0'), 'IPv6')\": \"::1bc0\"\r\n                }\r\n        ],\r\n\r\n        \"rows\": 1,\r\n\r\n        \"statistics\":\r\n        {\r\n                \"elapsed\": 0.000189836,\r\n                \"rows_read\": 1,\r\n                \"bytes_read\": 1\r\n        }\r\n}\r\n\r\n1 rows in set. Elapsed: 0.001 sec.\r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5799/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5747","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5747/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5747/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5747/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5747","id":460734485,"node_id":"MDU6SXNzdWU0NjA3MzQ0ODU=","number":5747,"title":"Kerberos support for ZK and HDFS","user":{"login":"kindred77","id":23120538,"node_id":"MDQ6VXNlcjIzMTIwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/23120538?v=4","gravatar_id":"","url":"https://api.github.com/users/kindred77","html_url":"https://github.com/kindred77","followers_url":"https://api.github.com/users/kindred77/followers","following_url":"https://api.github.com/users/kindred77/following{/other_user}","gists_url":"https://api.github.com/users/kindred77/gists{/gist_id}","starred_url":"https://api.github.com/users/kindred77/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kindred77/subscriptions","organizations_url":"https://api.github.com/users/kindred77/orgs","repos_url":"https://api.github.com/users/kindred77/repos","events_url":"https://api.github.com/users/kindred77/events{/privacy}","received_events_url":"https://api.github.com/users/kindred77/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1507871495,"node_id":"MDU6TGFiZWwxNTA3ODcxNDk1","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-community-taken","name":"st-community-taken","color":"e5b890","default":false,"description":"External developer is working on that"},{"id":2082312777,"node_id":"MDU6TGFiZWwyMDgyMzEyNzc3","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/st-almost-fixed","name":"st-almost-fixed","color":"e5b890","default":false,"description":"Some fixes were applied but some still considered"},{"id":2192299304,"node_id":"MDU6TGFiZWwyMTkyMjk5MzA0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-hdfs","name":"comp-hdfs","color":"b5bcff","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2019-06-26T02:55:23Z","updated_at":"2021-03-29T17:32:15Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Does CK support kerberos authorized for ZK and HDFS?\r\n\r\nSince we are using HDFS and ZK with kerberos.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5747/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5722","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5722/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5722/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5722/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5722","id":459565497,"node_id":"MDU6SXNzdWU0NTk1NjU0OTc=","number":5722,"title":"Group & Join bottlenecked by single thread performance, not allocating all cores","user":{"login":"Slind14","id":3914677,"node_id":"MDQ6VXNlcjM5MTQ2Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/3914677?v=4","gravatar_id":"","url":"https://api.github.com/users/Slind14","html_url":"https://github.com/Slind14","followers_url":"https://api.github.com/users/Slind14/followers","following_url":"https://api.github.com/users/Slind14/following{/other_user}","gists_url":"https://api.github.com/users/Slind14/gists{/gist_id}","starred_url":"https://api.github.com/users/Slind14/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Slind14/subscriptions","organizations_url":"https://api.github.com/users/Slind14/orgs","repos_url":"https://api.github.com/users/Slind14/repos","events_url":"https://api.github.com/users/Slind14/events{/privacy}","received_events_url":"https://api.github.com/users/Slind14/received_events","type":"User","site_admin":false},"labels":[{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1357578153,"node_id":"MDU6TGFiZWwxMzU3NTc4MTUz","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-joins","name":"comp-joins","color":"b5bcff","default":false,"description":"JOINs"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-06-23T11:31:17Z","updated_at":"2020-10-16T18:10:45Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"### Test setup:\r\n - clean Debian 9.9 installation\r\n - clean clickhouse installation\r\n - the only configuration change is adding a 0 to the max_memory setting\r\n - data is stored in mem-disk\r\n - 64 core system\r\n\r\n### Other things\r\n\r\n- Available memory is far exceeding non-compressed data from required columns\r\n- Hashing seems to work fine and not be the cause\r\n\r\n\r\n## For simplicity let us focus on the joins first:\r\n\r\n### Join across two merge tree engines (total time 11 seconds)\r\n (join uses a subselect `[..] ANY LEFT JOIN (SELECT uuid, sum(someValue) FROM rightTable GROUP BY uuid) r ON r.uuid = uuid [..]`, the join is high granular 1 to 1)\r\n\r\n1. full allocation of CPU (probably initial streaming and aggregation)\r\n2. around midterm the allocation drops close to 0 and the CLI progress bar freezes for a few seconds (probably the join)\r\n3. full allocation of CPU (probably final aggregation)\r\n\r\nFlame graph: https://gist.github.com/Slind14/4e3657379833a7ea4b2817a80686bd3b\r\n\r\n### Join across merge tree and join engine (total time 25 seconds)\r\nsame query just rightTableJoin instead of rightTable\r\n\r\n1. only one core allocated for 15 seconds, no CLI progress bar\r\n2. full CPU allocation and completion within 5 seconds\r\n\r\nFlame graph: https://gist.github.com/Slind14/3a778bd0bd7f1c8e97dc229d6c74aaae\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5722/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5709","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5709/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5709/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5709/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5709","id":459152313,"node_id":"MDU6SXNzdWU0NTkxNTIzMTM=","number":5709,"title":"CREATE OR REPLACE materialized view","user":{"login":"simPod","id":327717,"node_id":"MDQ6VXNlcjMyNzcxNw==","avatar_url":"https://avatars.githubusercontent.com/u/327717?v=4","gravatar_id":"","url":"https://api.github.com/users/simPod","html_url":"https://github.com/simPod","followers_url":"https://api.github.com/users/simPod/followers","following_url":"https://api.github.com/users/simPod/following{/other_user}","gists_url":"https://api.github.com/users/simPod/gists{/gist_id}","starred_url":"https://api.github.com/users/simPod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simPod/subscriptions","organizations_url":"https://api.github.com/users/simPod/orgs","repos_url":"https://api.github.com/users/simPod/repos","events_url":"https://api.github.com/users/simPod/events{/privacy}","received_events_url":"https://api.github.com/users/simPod/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-06-21T11:31:20Z","updated_at":"2019-06-21T14:23:45Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Use case**\r\nI'd like to be able to replace the view definition instead of dropping and creating. The whole point is for it to be \"transactional\". That there is no point in time where the view does not exist.\r\n\r\n**Describe the solution you'd like**\r\nSupport for standard `CREATE OR REPLACE MATERIALIZED VIEW` would do just fine.\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5709/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5709/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5703","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5703/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5703/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5703/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5703","id":458990200,"node_id":"MDU6SXNzdWU0NTg5OTAyMDA=","number":5703,"title":"IPv4CIDRToRange not found","user":{"login":"clarsen","id":48277,"node_id":"MDQ6VXNlcjQ4Mjc3","avatar_url":"https://avatars.githubusercontent.com/u/48277?v=4","gravatar_id":"","url":"https://api.github.com/users/clarsen","html_url":"https://github.com/clarsen","followers_url":"https://api.github.com/users/clarsen/followers","following_url":"https://api.github.com/users/clarsen/following{/other_user}","gists_url":"https://api.github.com/users/clarsen/gists{/gist_id}","starred_url":"https://api.github.com/users/clarsen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clarsen/subscriptions","organizations_url":"https://api.github.com/users/clarsen/orgs","repos_url":"https://api.github.com/users/clarsen/repos","events_url":"https://api.github.com/users/clarsen/events{/privacy}","received_events_url":"https://api.github.com/users/clarsen/received_events","type":"User","site_admin":false},"labels":[{"id":785082162,"node_id":"MDU6TGFiZWw3ODUwODIxNjI=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-documentation","name":"comp-documentation","color":"b5bcff","default":false,"description":"Used to run automatic builds of the documentation"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-06-21T03:29:46Z","updated_at":"2021-02-05T09:31:06Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n\r\nMaybe some functionality is disabled in the config -- I didn't make changes from default other than to enforce network ACLs, and bump up max_memory_usage, but while the sources for 19.5.3.8 do show the function is registered, the server doesn't recognize the function.\r\n\r\n**How to reproduce**\r\n$ lsb_release -a\r\n```\r\nNo LSB modules are available.\r\nDistributor ID: Ubuntu\r\nDescription:    Ubuntu 18.04.2 LTS\r\nRelease:        18.04\r\nCodename:       bionic\r\n```\r\n\r\n$ sudo dpkg -l 'clickhouse-server*'\r\n```\r\nDesired=Unknown/Install/Remove/Purge/Hold\r\n| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend\r\n|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)\r\n||/ Name                                        Version                    Architecture               Description\r\n+++-===========================================-==========================-==========================-===========================================================================================\r\nii  clickhouse-server                           19.5.3.8                   all                        Server binary for ClickHouse\r\nun  clickhouse-server-base                      <none>                     <none>                     (no description available)\r\nun  clickhouse-server-common                    <none>                     <none>                     (no description available)\r\n```\r\n\r\n$ clickhouse-client -V\r\n```\r\nClickHouse client version 19.5.3.8 (official build).\r\n```\r\n\r\n`SELECT IPv4CIDRToRange(toIPv4('192.168.5.2'), 0)`  gives:\r\n```\r\nCode: 46. DB::Exception: Received from 127.0.0.1:9440. DB::Exception: Unknown function IPv4CIDRToRange.\r\n```\r\n\r\n**Expected behavior**\r\nWould expect it to not error and return a UInt32 tuple instead.\r\n\r\n**Error message and/or stacktrace**\r\n\r\n$ clickhouse-client -m -A --port 9440 -h 127.0.0.1 -s\r\n```\r\nClickHouse client version 19.5.3.8 (official build).\r\nConnecting to 127.0.0.1:9440 as user default.\r\nConnected to ClickHouse server version 19.5.3 revision 54417.\r\n\r\nSERVERHOST :) SELECT IPv4CIDRToRange(toIPv4('192.168.5.2'), 0);\r\n\r\nSELECT IPv4CIDRToRange(toIPv4('192.168.5.2'), 0)\r\n\r\nReceived exception from server (version 19.5.3):\r\nCode: 46. DB::Exception: Received from 127.0.0.1:9440. DB::Exception: Unknown function IPv4CIDRToRange.\r\n\r\n0 rows in set. Elapsed: 0.003 sec.\r\n```\r\n\r\n**Additional context**\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5703/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5690","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5690/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5690/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5690/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5690","id":458293870,"node_id":"MDU6SXNzdWU0NTgyOTM4NzA=","number":5690,"title":"Cannot compare Decimal and 'exact numeric literal' ","user":{"login":"fasoal","id":14243815,"node_id":"MDQ6VXNlcjE0MjQzODE1","avatar_url":"https://avatars.githubusercontent.com/u/14243815?v=4","gravatar_id":"","url":"https://api.github.com/users/fasoal","html_url":"https://github.com/fasoal","followers_url":"https://api.github.com/users/fasoal/followers","following_url":"https://api.github.com/users/fasoal/following{/other_user}","gists_url":"https://api.github.com/users/fasoal/gists{/gist_id}","starred_url":"https://api.github.com/users/fasoal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fasoal/subscriptions","organizations_url":"https://api.github.com/users/fasoal/orgs","repos_url":"https://api.github.com/users/fasoal/repos","events_url":"https://api.github.com/users/fasoal/events{/privacy}","received_events_url":"https://api.github.com/users/fasoal/received_events","type":"User","site_admin":false},"labels":[{"id":628291301,"node_id":"MDU6TGFiZWw2MjgyOTEzMDE=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/sql-compatibility","name":"sql-compatibility","color":"006b75","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-06-20T01:35:26Z","updated_at":"2021-11-26T11:49:21Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"version:ClickHouse 18.16.1\r\ncolumn a type is Decimal(18, 4)\r\n1 excute sql  a > '1000.0000' \r\n   exception: Illegal types of arguments (Decimal(18, 4), String) of function greater\r\n2  excute sql  a > 1000.0000\r\n   exception: No operation greater between Decimal(18, 4) and Float64","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5690/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5690/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5508","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5508/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5508/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5508/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5508","id":451048107,"node_id":"MDU6SXNzdWU0NTEwNDgxMDc=","number":5508,"title":"Connection pools for table functions: remote, mysql, url, odbc.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1401253328,"node_id":"MDU6TGFiZWwxNDAxMjUzMzI4","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-net","name":"comp-net","color":"b5bcff","default":false,"description":"Network related"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-06-01T05:33:23Z","updated_at":"2021-10-26T09:47:37Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"Do not re-establish connections all the time.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5508/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5426","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5426/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5426/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5426/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5426","id":448819950,"node_id":"MDU6SXNzdWU0NDg4MTk5NTA=","number":5426,"title":"How to group by nested columns in tabular format without using array joins","user":{"login":"nshah14285","id":34057870,"node_id":"MDQ6VXNlcjM0MDU3ODcw","avatar_url":"https://avatars.githubusercontent.com/u/34057870?v=4","gravatar_id":"","url":"https://api.github.com/users/nshah14285","html_url":"https://github.com/nshah14285","followers_url":"https://api.github.com/users/nshah14285/followers","following_url":"https://api.github.com/users/nshah14285/following{/other_user}","gists_url":"https://api.github.com/users/nshah14285/gists{/gist_id}","starred_url":"https://api.github.com/users/nshah14285/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nshah14285/subscriptions","organizations_url":"https://api.github.com/users/nshah14285/orgs","repos_url":"https://api.github.com/users/nshah14285/repos","events_url":"https://api.github.com/users/nshah14285/events{/privacy}","received_events_url":"https://api.github.com/users/nshah14285/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-05-27T12:01:03Z","updated_at":"2020-07-01T18:18:54Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"How do I perform a group by within nested columns?\r\n\r\nI have nested column items.productName and items.amount and I want to get sum of amounts grouped by each item of productName.\r\n\r\nForm the result:\r\n`SELECT items.productName AS name, items.amount AS amt FROM test WHERE transactionID IN ('abcxyz','abcxyzz') GROUP BY name`\r\n\r\nâ”Œâ”€nameâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€amtâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ ['product1','product2'] â”‚ [1895,1800]          â”‚\r\nâ”‚ ['product2','product1'] â”‚ [1800,1895]          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nto\r\n\r\nâ”Œâ”€nameâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€amtâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ product1                   â”‚  3790                      â”‚\r\nâ”‚ product2                   â”‚  3600                      â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nI am able to achieve this using array join\r\n`SELECT items.productName as name, sum(items.amount) as amt from test array join items\r\nwhere transactionID in ('abcxyz','abcxyzz') group by items.productName`\r\n\r\nBut array joins are slow so we cannot use them.\r\n\r\nSo I tried using sumForEach() but I am not sure how to group the result by individual productName.\r\n\r\n`SELECT items.productName as name, sumForEach(items.amount) as amt from test where transactionID in ('abcxyz','abcxyzz') group by name`\r\n\r\n\r\nThanks,\r\nNishit","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5426/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5365","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5365/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5365/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5365/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5365","id":446594645,"node_id":"MDU6SXNzdWU0NDY1OTQ2NDU=","number":5365,"title":"windowFunnel with group by function","user":{"login":"Chr1sxu","id":37131639,"node_id":"MDQ6VXNlcjM3MTMxNjM5","avatar_url":"https://avatars.githubusercontent.com/u/37131639?v=4","gravatar_id":"","url":"https://api.github.com/users/Chr1sxu","html_url":"https://github.com/Chr1sxu","followers_url":"https://api.github.com/users/Chr1sxu/followers","following_url":"https://api.github.com/users/Chr1sxu/following{/other_user}","gists_url":"https://api.github.com/users/Chr1sxu/gists{/gist_id}","starred_url":"https://api.github.com/users/Chr1sxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Chr1sxu/subscriptions","organizations_url":"https://api.github.com/users/Chr1sxu/orgs","repos_url":"https://api.github.com/users/Chr1sxu/repos","events_url":"https://api.github.com/users/Chr1sxu/events{/privacy}","received_events_url":"https://api.github.com/users/Chr1sxu/received_events","type":"User","site_admin":false},"labels":[{"id":386401510,"node_id":"MDU6TGFiZWwzODY0MDE1MTA=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/question","name":"question","color":"bfdadc","default":true,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-05-21T12:36:54Z","updated_at":"2021-01-09T06:12:08Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"id like to use windowFunnel to create funnels grouped by dimensions. how could I accomplish it? \r\nfor instance\r\nbelow is the sql that Id like to group by exp_version from step1, can anyone help me modify it?  \r\n```sql\r\nSELECT \r\n    sumIf(count, level >= 1) AS sum1, \r\n    sumIf(count, level >= 2) AS sum2\r\nFROM \r\n(\r\n    SELECT \r\n        level, \r\n        count() AS count\r\n    FROM \r\n    (\r\n        SELECT \r\n            uuid, \r\n            windowFunnel(86400)(timestamp, (operation = 'hawkeye') AND (biz = 'cf') AND (type = 'user_action') AND ((exp_id = '207') AND (exp_version = '8')), (element_code = 'f09aa09b1d34425dac317adbbf40f663') AND (biz = 'cf') AND (type = 'user_action')) AS level\r\n        FROM all_log_record_5_cluster \r\n        WHERE (date = '2019-05-20') AND (biz = 'cf') AND (type = 'user_action')\r\n        GROUP BY uuid\r\n    ) \r\n    GROUP BY level\r\n) \r\nORDER BY \r\n    sum1 DESC, \r\n    sum2 DESC\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5365/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5365/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5336","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5336/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5336/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5336/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5336","id":445767063,"node_id":"MDU6SXNzdWU0NDU3NjcwNjM=","number":5336,"title":"Excessive connections when using foreign tables.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":756395244,"node_id":"MDU6TGFiZWw3NTYzOTUyNDQ=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/performance","name":"performance","color":"c2e0c6","default":false,"description":null},{"id":1365689344,"node_id":"MDU6TGFiZWwxMzY1Njg5MzQ0","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-foreign-db","name":"comp-foreign-db","color":"b5bcff","default":false,"description":"Integrations with other databases"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-05-19T00:33:12Z","updated_at":"2019-05-19T00:33:34Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"When selecting from `mysql` table function, connection to remote server is performed three times.\r\nShould be one or zero (with connection pool).","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5336/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5329","repository_url":"https://api.github.com/repos/ClickHouse/ClickHouse","labels_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5329/labels{/name}","comments_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5329/comments","events_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5329/events","html_url":"https://github.com/ClickHouse/ClickHouse/issues/5329","id":445710334,"node_id":"MDU6SXNzdWU0NDU3MTAzMzQ=","number":5329,"title":"Query optimization for GROUP BY with ORDER BY keys and LIMIT.","user":{"login":"alexey-milovidov","id":18581488,"node_id":"MDQ6VXNlcjE4NTgxNDg4","avatar_url":"https://avatars.githubusercontent.com/u/18581488?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-milovidov","html_url":"https://github.com/alexey-milovidov","followers_url":"https://api.github.com/users/alexey-milovidov/followers","following_url":"https://api.github.com/users/alexey-milovidov/following{/other_user}","gists_url":"https://api.github.com/users/alexey-milovidov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-milovidov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-milovidov/subscriptions","organizations_url":"https://api.github.com/users/alexey-milovidov/orgs","repos_url":"https://api.github.com/users/alexey-milovidov/repos","events_url":"https://api.github.com/users/alexey-milovidov/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-milovidov/received_events","type":"User","site_admin":false},"labels":[{"id":520905553,"node_id":"MDU6TGFiZWw1MjA5MDU1NTM=","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/feature","name":"feature","color":"1d76db","default":false,"description":null},{"id":1401777979,"node_id":"MDU6TGFiZWwxNDAxNzc3OTc5","url":"https://api.github.com/repos/ClickHouse/ClickHouse/labels/comp-optimizers","name":"comp-optimizers","color":"b5bcff","default":false,"description":"Query optimizations"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-05-18T12:17:12Z","updated_at":"2022-01-10T00:09:51Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"In one internal part of Yandex Banner System, there is a practice to manually rewrite queries like:\r\n\r\n```\r\nSELECT \r\n    key1, ... keyN,\r\n    agg1(args), ..., aggM(args)\r\nFROM table\r\n...\r\nGROUP BY key1, ... keyN\r\nORDER BY key1, ... keyN\r\nLIMIT a, b\r\n```\r\n\r\n(note that there are multiple aggregate functions \r\nbut result is sorted and paginated only by aggregation keys)\r\n\r\ninto\r\n\r\n```\r\nSELECT \r\n    key1, ... keyN,\r\n    agg1(args), ..., aggM(args)\r\nFROM table\r\nWHERE (key1, ... keyN) IN\r\n(\r\n    SELECT key1, ... keyN\r\n    FROM table\r\n    GROUP BY key1, ... keyN\r\n    ORDER BY key1, ... keyN\r\n    LIMIT a, b\r\n)\r\n...\r\nGROUP BY key1, ... keyN\r\nORDER BY key1, ... keyN\r\n```\r\n\r\nto save memory usage by avoiding the calculation of `agg1(args), ..., aggM(args)` for the keys that are not within `LIMIT a, b`\r\n\r\nThe proposed feature is to avoid the need for manual optimization by either:\r\n- implementing this optimization by query (or pipeline) rewrite inside ClickHouse;\r\n- implementing incremental partial sorting inside Aggregator.","reactions":{"url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5329/reactions","total_count":7,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/ClickHouse/ClickHouse/issues/5329/timeline","performed_via_github_app":null}]
